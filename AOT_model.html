<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory AOT_model</title>
</head>


<body>
<div class="head">
<h1>Theory AOT_model</h1>
</div>

<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> AOT_model
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">declare</span></span><span class="main">[</span><span class="main">[</span><span class="operator">typedef_overloaded</span><span class="main">]</span><span class="main">]</span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">â€¹Model for the Logic of AOTâ€º</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">â€¹We introduce a primitive type for hyperintensional propositions.â€º</span></span>
<span class="keyword1"><span class="command">typedecl</span></span> ğ—ˆ

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">â€¹To be able to model modal operators following Kripke semantics, we introduce a primitive
     type for possible worlds and assert, by axiom, that there is a surjective function mapping
     propositions to the boolean-valued functions acting on possible worlds. We call the result
     of applying this function to a proposition the Kripke-extension of the proposition.â€º</span></span>
<span class="keyword1"><span class="command">typedecl</span></span> w <span class="comment1">â€•â€¹The primtive type of possible worlds.â€º</span>
<span class="keyword1"><span class="command">axiomatization</span></span> <span class="free">AOT_model_dğ—ˆ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹ğ—ˆ<span class="main">â‡’</span><span class="main">(</span>w<span class="main">â‡’</span>bool<span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">where</span></span> dğ—ˆ_surj<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹surj <span class="free">AOT_model_dğ—ˆ</span>â€º</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">â€¹Furthermore, the axioms of PLM require the existence of a non-actual world.â€º</span></span>
<span class="keyword1"><span class="command">consts</span></span> w<span class="hidden">â‡©</span><sub>0</sub> <span class="main">::</span> <span class="quoted">w</span> <span class="comment1">â€•â€¹The designated actual world.â€º</span>
<span class="keyword1"><span class="command">axiomatization</span></span> <span class="keyword2"><span class="keyword">where</span></span> AOT_model_nonactual_world<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">w</span> <span class="main">.</span> <span class="bound">w</span> <span class="main">â‰ </span> w<span class="hidden">â‡©</span><sub>0</sub>â€º</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">â€¹Validity of a proposition in a given world can now be modelled as the result
     of applying that world to the Kripke-extension of the proposition.â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_valid_in</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹w<span class="main">â‡’</span>ğ—ˆ<span class="main">â‡’</span>boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_valid_in</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="main">â‰¡</span> AOT_model_dğ—ˆ <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="free"><span class="bound"><span class="entity">w</span></span></span>â€º</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">â€¹By construction, we can choose a proposition for any given Kripke-extension, s.t.
     the proposition is valid in a possible world is its Kripke-extension evaluates to true
     at that world.â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_proposition_choice</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>w<span class="main">â‡’</span>bool<span class="main">)</span> <span class="main">â‡’</span> ğ—ˆâ€º</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">â€¹<span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> â€º</span> 8<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="keyword1"><span class="free">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span></span> <span class="bound">w</span><span class="main"><span class="free">.</span></span> <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="bound">w</span> <span class="main">â‰¡</span> <span class="main">(</span>inv AOT_model_dğ—ˆ<span class="main">)</span> <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span>â€º</span></span>
<span class="keyword1"><span class="command">lemma</span></span> AOT_model_proposition_choice_simp<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="free">w</span> <span class="main">(</span><span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="free">Ï†</span> <span class="bound">w</span><span class="main">)</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="free">w</span>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> surj_f_inv_f<span class="main"><span class="main">[</span></span><span class="operator">OF</span> dğ—ˆ_surj<span class="main"><span class="main">]</span></span> AOT_model_valid_in_def AOT_model_proposition_choice_def<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">â€¹Nitpick can trivially show that there are models for the axioms above.â€º</span></span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">â€¹Trueâ€º</span></span> <span class="keyword1"><span class="command">nitpick</span></span><span class="main">[</span>satisfy<span class="main">,</span> user_axioms<span class="main">,</span> expect <span class="main">=</span> genuine<span class="main">]</span> <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">typedecl</span></span> Ï‰

<span class="keyword1"><span class="command">typedecl</span></span> Ïƒ'
<span class="keyword1"><span class="command">consts</span></span> Ïƒ'<span class="hidden">â‡©</span><sub>V</sub> <span class="main">::</span> <span class="quoted">Ïƒ'</span>
<span class="keyword1"><span class="command">consts</span></span> Ïƒ'<span class="hidden">â‡©</span><sub>0</sub> <span class="main">::</span> <span class="quoted">Ïƒ'</span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Ïƒcond</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> Ïƒ' <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">Ïƒcond</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="main">(</span><span class="bound">ordext</span> <span class="main">::</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set<span class="main">,</span> <span class="bound">ordext'</span> <span class="main">::</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set<span class="main">,</span> <span class="bound">Ïƒ'</span> <span class="main">::</span> Ïƒ'<span class="main">)</span> <span class="main">.</span>
    <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="bound">ordext</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="bound">ordext'</span><span class="main">)</span> <span class="main">âˆ§</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">ordext'</span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> <span class="bound">Ïƒ'</span> <span class="main">=</span> Ïƒ'<span class="hidden">â‡©</span><sub>0</sub> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="main">âˆ€</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="bound">ordext'</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="bound">ordext</span> <span class="keyword1">then</span> <span class="bound">Ïƒ'</span> <span class="main">=</span> Ïƒ'<span class="hidden">â‡©</span><sub>V</sub> <span class="keyword1">else</span> True<span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Ïƒset</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="free">Ïƒset</span> <span class="main">â‰¡</span> Collect Ïƒcondâ€º</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">ordext_intersection</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> Ïƒ' <span class="main">â‡’</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> setâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">ordext_intersection</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">set</span> <span class="main">.</span> fst <span class="bound">set</span>â€º</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">ordext_union</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> Ïƒ' <span class="main">â‡’</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> setâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">ordext_union</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">set</span> <span class="main">.</span> fst <span class="main">(</span>snd <span class="bound">set</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">ÏƒÏƒ'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> set <span class="main">Ã—</span> Ïƒ' <span class="main">â‡’</span> Ïƒ'â€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">ÏƒÏƒ'</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">set</span> <span class="main">.</span> snd <span class="main">(</span>snd <span class="bound">set</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">lemma</span></span> ÏƒcondI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span> <span class="bound">x</span> <span class="main">âˆˆ</span> ordext_intersection <span class="free">Ïƒ</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">âˆˆ</span> ordext_union <span class="free">Ïƒ</span>â€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹ordext_union <span class="free">Ïƒ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">âŸ¹</span> ÏƒÏƒ' <span class="free">Ïƒ</span> <span class="main">=</span> Ïƒ'<span class="hidden">â‡©</span><sub>0</sub>â€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹ordext_union <span class="free">Ïƒ</span> <span class="main">â‰ </span> <span class="main">{}</span> <span class="main">âŸ¹</span> ordext_intersection <span class="free">Ïƒ</span> <span class="main">=</span> ordext_union <span class="free">Ïƒ</span> <span class="main">âŸ¹</span> ÏƒÏƒ' <span class="free">Ïƒ</span> <span class="main">=</span> Ïƒ'<span class="hidden">â‡©</span><sub>V</sub>â€º</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">â€¹Ïƒcond <span class="free">Ïƒ</span>â€º</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> Ïƒcond_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">typedef</span></span> Ïƒ <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹Ïƒsetâ€º</span></span> <span class="keyword1"><span class="command">unfolding</span></span> Ïƒset_def Ïƒcond_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">typedecl</span></span> null
<span class="keyword1"><span class="command">datatype</span></span> Ï… <span class="main">=</span> Ï‰Ï… <span class="quoted">Ï‰</span> <span class="main">|</span> ÏƒÏ… <span class="quoted">Ïƒ</span> <span class="main">|</span> <span class="entity">is_nullÏ…</span><span class="main">:</span> nullÏ… <span class="quoted">null</span>

<span class="keyword1"><span class="command">consts</span></span> AOT_model_concreteÏ‰ <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span>  boolâ€º</span></span>
<span class="keyword1"><span class="command">specification</span></span> <span class="main">(</span><span class="quoted">AOT_model_concreteÏ‰</span><span class="main">)</span>
  AOT_model_Ï‰_concrete_in_some_world<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_concreteÏ‰ <span class="free">x</span> <span class="bound">w</span>â€º</span></span>
  AOT_model_contingent_object<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_concreteÏ‰ <span class="bound">x</span> <span class="bound">w</span> <span class="main">âˆ§</span> <span class="main">Â¬</span>AOT_model_concreteÏ‰ <span class="bound">x</span> w<span class="hidden">â‡©</span><sub>0</sub>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">â€¹<span class="main"><span class="main"><span class="main">Î»</span></span></span><span class="main"><span class="bound"><span class="main"><span class="bound"><span class="main"><span class="bound">_</span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span><span class="main"><span class="main"><span class="main">.</span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span> <span class="main"><span class="main"><span class="main">â‰ </span></span></span> w<span class="hidden">â‡©</span><sub>0</sub>â€º</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_nonactual_world<span class="main">)</span>

<span class="keyword1"><span class="command">typedef</span></span> urrel <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹<span class="main">{</span> <span class="bound">Ï†</span> <span class="main">.</span> <span class="main">âˆ€</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">.</span> <span class="main">Â¬</span>AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">Ï†</span> <span class="main">(</span>nullÏ… <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">}</span>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">â€¹<span class="main"><span class="main"><span class="main">Î»</span></span></span> <span class="bound"><span class="bound"><span class="bound">x</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">(</span></span></span><span class="keyword1"><span class="keyword1"><span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">Â¬</span></span></span>is_nullÏ… <span class="bound"><span class="bound"><span class="bound">x</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span>â€º</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>

<span class="keyword1"><span class="command">datatype</span></span> Îº <span class="main">=</span> Ï‰Îº <span class="quoted">Ï‰</span> <span class="main">|</span> Î±Îº <span class="quoted"><span class="quoted">â€¹urrel setâ€º</span></span> <span class="main">|</span> <span class="entity">is_nullÎº</span><span class="main">:</span> nullÎº <span class="quoted">null</span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">â€¹Extended model versionâ€º</span></span>

<span class="keyword1"><span class="command">consts</span></span> Î±Ïƒ_ext <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel set <span class="main">â‡’</span> Ïƒâ€º</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">urrel_to_Ï‰rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel <span class="main">â‡’</span> <span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">urrel_to_Ï‰rel</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">r</span> <span class="bound">u</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>Ï‰Ï… <span class="bound">u</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">Ï‰rel_to_urrel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">)</span> <span class="main">â‡’</span> urrelâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">Ï‰rel_to_urrel</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">Ï†</span> <span class="main">.</span> Abs_urrel <span class="main">(</span><span class="main">Î»</span> <span class="bound">u</span> <span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> Ï‰Ï… <span class="bound">x</span> <span class="main">â‡’</span> <span class="bound">Ï†</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> <span class="main"><span class="bound">_</span></span> <span class="main">â‡’</span> False<span class="main">)</span>â€º</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_urrel_Ï‰equiv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel <span class="main">â‡’</span> urrel <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_urrel_Ï‰equiv</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">r</span> <span class="bound">s</span> <span class="main">.</span> <span class="main">âˆ€</span> <span class="bound">u</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>Ï‰Ï… <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="bound">s</span> <span class="main">(</span>Ï‰Ï… <span class="bound">u</span><span class="main">)</span><span class="main">)</span>â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_Ï‰rel_quot<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Quotient3 AOT_urrel_Ï‰equiv urrel_to_Ï‰rel Ï‰rel_to_urrelâ€º</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Quotient3I<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="main">(</span>Ï‰rel_to_urrel <span class="skolem">a</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">a</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">unfolding</span></span> Ï‰rel_to_urrel_def urrel_to_Ï‰rel_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="main">(</span>Ï‰rel_to_urrel <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span>Ï‰rel_to_urrel <span class="skolem">a</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">unfolding</span></span> Ï‰rel_to_urrel_def AOT_urrel_Ï‰equiv_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span>1 2<span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="skolem">r</span> <span class="skolem">s</span> <span class="main">=</span> <span class="main">(</span>AOT_urrel_Ï‰equiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">âˆ§</span> AOT_urrel_Ï‰equiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">s</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span> <span class="skolem">s</span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="skolem">r</span> <span class="skolem">s</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">s</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">u</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
      <span class="keyword1"><span class="command">using</span></span> AOT_urrel_Ï‰equiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">s</span>â€º</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> urrel_to_Ï‰rel_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">âˆ§</span> AOT_urrel_Ï‰equiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">s</span>â€º</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> AOT_urrel_Ï‰equiv_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">âˆ§</span> AOT_urrel_Ï‰equiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">s</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">s</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">u</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> urrel_to_Ï‰rel_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="skolem">r</span> <span class="skolem">s</span>â€º</span></span>
      <span class="keyword1"><span class="command">using</span></span> AOT_urrel_Ï‰equiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">specification</span></span> <span class="main">(</span><span class="quoted">Î±Ïƒ_ext</span><span class="main">)</span>
  Î±Ïƒ_ext_surj<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹surj Î±Ïƒ_extâ€º</span></span>
  Î±Ïƒ_eq_ord_exts_all<span class="main">:</span>
    <span class="quoted"><span class="quoted">â€¹Î±Ïƒ_ext <span class="free">a</span> <span class="main">=</span> Î±Ïƒ_ext <span class="free">b</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">â‹€</span><span class="bound">s</span> <span class="main">.</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="free">r</span> <span class="main">âŸ¹</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="free">a</span><span class="main">)</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">â‹€</span> <span class="bound">s</span> <span class="main">.</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="free">r</span> <span class="main">âŸ¹</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="free">b</span><span class="main">)</span>â€º</span></span>
  Î±Ïƒ_eq_ord_exts_ex<span class="main">:</span>
    <span class="quoted"><span class="quoted">â€¹Î±Ïƒ_ext <span class="free">a</span> <span class="main">=</span> Î±Ïƒ_ext <span class="free">b</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">s</span> <span class="main">.</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="free">a</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="free">r</span><span class="main">)</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">âˆƒ</span><span class="bound">s</span> <span class="main">.</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="free">b</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="free">r</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="comment1">(* TODO: find better proof/strategy or simplify *)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">Î±Ïƒ_wit_intersection</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_intersection</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">urrels</span> <span class="main">.</span> <span class="main">{</span><span class="bound">ordext</span> <span class="main">.</span> <span class="main">âˆ€</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">âŸ¶</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="bound">urrels</span><span class="main">}</span>â€º</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">Î±Ïƒ_wit_union</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_union</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">urrels</span> <span class="main">.</span> <span class="main">{</span><span class="bound">ordext</span> <span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">urrel</span><span class="main">âˆˆ</span><span class="bound">urrels</span> <span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>â€º</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">Î±Ïƒ_wit_Ïƒ'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_Ïƒ'</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">urrels</span> <span class="main">.</span> <span class="keyword1">THE</span> <span class="bound">Ïƒ'</span> <span class="main">.</span> <span class="main">âˆƒ</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="bound">urrels</span> <span class="main">.</span>
          urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆ‰</span> <span class="skolem">Î±Ïƒ_wit_intersection</span> <span class="bound">urrels</span> <span class="main">âˆ§</span>
          <span class="main">(</span> <span class="main">âˆ€</span> <span class="bound">w</span> <span class="bound">Ïƒ</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¶</span> ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ</span><span class="main">)</span> <span class="main">=</span> <span class="bound">Ïƒ'</span><span class="main">)</span>â€º</span></span>

  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Î±Ïƒ_wit</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Î»</span> <span class="bound">urrels</span> <span class="main">.</span> 
        <span class="keyword1">let</span> <span class="bound">ordexts</span> <span class="main">=</span> <span class="skolem">Î±Ïƒ_wit_intersection</span> <span class="bound">urrels</span> <span class="keyword1">in</span>
        <span class="keyword1">let</span> <span class="bound">ordexts'</span> <span class="main">=</span> <span class="skolem">Î±Ïƒ_wit_union</span> <span class="bound">urrels</span> <span class="keyword1">in</span>
      <span class="main">(</span><span class="bound">ordexts</span><span class="main">,</span> <span class="bound">ordexts'</span><span class="main">,</span> <span class="keyword1">if</span> <span class="bound">ordexts'</span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> Ïƒ'<span class="hidden">â‡©</span><sub>0</sub> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="main">âˆ€</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="bound">ordexts'</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">âˆˆ</span> <span class="bound">ordexts</span> <span class="keyword1">then</span> Ïƒ'<span class="hidden">â‡©</span><sub>V</sub> <span class="keyword1">else</span> <span class="skolem">Î±Ïƒ_wit_Ïƒ'</span> <span class="bound">urrels</span><span class="main">)</span>â€º</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">Î±Ïƒ_wit</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel set <span class="main">â‡’</span> Ïƒâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">urrels</span> <span class="main">.</span> Abs_Ïƒ <span class="main">(</span><span class="var">?Î±Ïƒ_wit</span> <span class="bound">urrels</span><span class="main">)</span>â€º</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">âŸ¶</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="skolem">x</span> <span class="main">âŸ¹</span> <span class="main">âˆƒ</span><span class="bound">urrel</span><span class="main">âˆˆ</span><span class="skolem">x</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="skolem">y</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Quotient3_abs_rep urrel_Ï‰rel_quot<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> wits_in_Ïƒset<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="var">?Î±Ïƒ_wit</span> <span class="skolem">x</span> <span class="main">âˆˆ</span> Ïƒsetâ€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">unfolding</span></span> Ïƒset_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ÏƒcondI<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def 1 Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span>

  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Ïƒ</span>
    <span class="keyword1"><span class="command">have</span></span> Ïƒcond<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Ïƒcond <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
      <span class="keyword1"><span class="command">using</span></span> Rep_Ïƒ Ïƒset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> Ïƒcond_empty<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">âŸ¹</span> <span class="main">(</span>fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Product_Type.Collect_case_prodD Rep_Ïƒ Ïƒcond_def Ïƒset_def curryI curry_case_prod eq_fst_iff ex_in_conv<span class="main">)</span> 
    <span class="keyword1"><span class="command">have</span></span> Ïƒcond_univ<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> UNIV <span class="main">âŸ¹</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> UNIVâ€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> UNIV_I UNIV_eq_I Ïƒcond Ïƒcond_def prod.case_eq_if<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>â€º</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Ïƒcond_empty calculation<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">=</span> Ïƒ'<span class="hidden">â‡©</span><sub>0</sub>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Ïƒcond Ïƒcond_def calculation prod.case_eq_if<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="main">{}</span> <span class="main">=</span> Abs_Ïƒ <span class="main">(</span><span class="main">{}</span><span class="main">,</span><span class="main">{}</span><span class="main">,</span>Ïƒ'<span class="hidden">â‡©</span><sub>0</sub><span class="main">)</span>â€º</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> Î±Ïƒ_wit_def
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_Ïƒ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> wits_in_Ïƒset <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> Ïƒcond Ïƒset_def calculation<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> mem_Collect_eq prod.exhaust_sel<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Quotient3_def urrel_Ï‰rel_quot<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="main">{}</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> Î±Ïƒ_wit_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rep_Ïƒ_inverse prod.collapse<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">Î±Ïƒ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">assume</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">â‰ </span> <span class="main">{}</span>â€º</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">=</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Ïƒ'<span class="hidden">â‡©</span><sub>V</sub>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Rep_Ïƒ Ïƒcond_def Ïƒset_def calculation<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> mem_Collect_eq prod.case_eq_if<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">{</span><span class="bound">ordext</span><span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">urrel</span><span class="main">âˆˆ</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span> <span class="main">â‰ </span> <span class="main">{}</span>â€º</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"0"</span> Quotient3_abs_rep calculation<span class="main">(</span>2<span class="main">)</span> urrel_Ï‰rel_quot <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> Abs_Ïƒ <span class="main">(</span>ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">,</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">,</span> Ïƒ'<span class="hidden">â‡©</span><sub>V</sub><span class="main">)</span>â€º</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> Î±Ïƒ_wit_def
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_Ïƒ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command">unfolding</span></span> Ïƒset_def
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ÏƒcondI<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> 1<span class="main">)</span>
           <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> CollectI Ïƒcond calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> surjective_pairing<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Let_def 2 Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹Ïƒcond <span class="main">(</span>ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">,</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">,</span> Ïƒ'<span class="hidden">â‡©</span><sub>V</sub><span class="main">)</span>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Ïƒcond calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> surjective_pairing<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rep_Ïƒ_inverse prod.exhaust_sel<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">Î±Ïƒ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">â‰ </span> UNIVâ€º</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">â‰ </span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">x</span> <span class="main">âˆˆ</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">âˆˆ</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Ïƒcond Ïƒcond_def case_prod_unfold<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> r_notin_intersection<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">r</span> <span class="main">âˆ‰</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> r_in_union<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">r</span> <span class="main">âˆˆ</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> Î±Ïƒwit_eqI<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span> <span class="keyword2"><span class="keyword">if</span></span>
        <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_intersection</span> <span class="skolem">x</span> <span class="main">=</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_union</span> <span class="skolem">x</span> <span class="main">=</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_Ïƒ'</span> <span class="skolem">x</span> <span class="main">=</span> ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
        <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">unfolding</span></span> Î±Ïƒ_wit_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> emptyE r_in_union r_notin_intersection surjective_pairing type_definition.Rep_inverse type_definition_Ïƒ<span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?intersection_part</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹<span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?union_part</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹<span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> <span class="main">(</span>urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
                             <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">Ïƒ'</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ·</span> ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span> <span class="main">=</span> ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">have</span></span> simp0<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel
           <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> Ï‰Ï… <span class="bound">x</span> <span class="main">â‡’</span> <span class="skolem">r</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> ÏƒÏ… <span class="bound">x</span> <span class="main">â‡’</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">|</span> nullÏ… <span class="bound">null</span> <span class="main">â‡’</span> False<span class="main">)</span><span class="main">)</span>
            <span class="main">=</span> <span class="skolem">r</span>â€º</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> urrel_to_Ï‰rel_def
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?Ïƒ_part</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Î»</span> <span class="bound">r</span> <span class="main">.</span> Abs_urrel <span class="main">(</span><span class="main">Î»</span><span class="bound">u</span> <span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> <span class="main">(</span>Ï‰Ï… <span class="bound">x</span><span class="main">)</span> <span class="main">â‡’</span> <span class="bound">r</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> ÏƒÏ… <span class="bound">x</span> <span class="main">â‡’</span> ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">|</span> <span class="main"><span class="bound">_</span></span> <span class="main">â‡’</span> False<span class="main">)</span>â€º</span></span>
      <span class="keyword1"><span class="command">have</span></span> Ïƒ_part_in_union<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="var">?Ïƒ_part</span> <span class="skolem">r</span> <span class="main">âˆˆ</span> <span class="var">?union_part</span>â€º</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> simp0 r_in_union<span class="main">)</span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> Ïƒ_part_not_in_intersection<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="var">?Ïƒ_part</span> <span class="skolem">r</span> <span class="main">âˆ‰</span> <span class="var">?intersection_part</span>â€º</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> urrel_to_Ï‰rel_def<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp r_notin_intersection<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">âˆª</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> Î±Ïƒwit_eqI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_intersection</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">âˆª</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Î±Ïƒ_wit_intersection_def<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> AOT_model_proposition_choice_simp Abs_urrel_inverse Quotient3_abs_rep Ï‰rel_to_urrel_def Ï….case<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Ï….simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> mem_Collect_eq urrel_Ï‰rel_quot<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword1"><span class="command">{</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ordext</span>
          <span class="keyword3"><span class="command">assume</span></span> ordext_in_union<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">ordext</span> <span class="main">âˆˆ</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">have</span></span> ordext_simp<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel
               <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> Ï‰Ï… <span class="bound">x</span> <span class="main">â‡’</span> <span class="skolem">ordext</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> ÏƒÏ… <span class="bound">x</span> <span class="main">â‡’</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">|</span> nullÏ… <span class="bound">null</span> <span class="main">â‡’</span> False<span class="main">)</span><span class="main">)</span>
              <span class="main">=</span> <span class="skolem">ordext</span>â€º</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> urrel_to_Ï‰rel_def
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">urrel</span> <span class="main">.</span> <span class="main">(</span><span class="bound">urrel</span>
          <span class="main">âˆˆ</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> ordext_intersection <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
            <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
             urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">âˆ§</span>
             <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">âˆ§</span>
            urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="skolem">ordext</span>â€º</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">â€¹<span class="var"><span class="var">?Ïƒ_part</span></span> <span class="skolem"><span class="skolem">ordext</span></span>â€º</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ordext_simp ordext_in_union<span class="main">)</span>
             <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
             <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
        <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 0 <span class="main">=</span> this
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_union</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">âˆª</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> ordext_union <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Î±Ïƒ_wit_union_def<span class="main">)</span>
           <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">x</span><span class="main">âˆˆ</span>fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span>â€º</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">urrel</span> <span class="main">.</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
       <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
        urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
        <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">âˆ§</span>
urrel_to_Ï‰rel <span class="bound">urrel</span>
       <span class="main">âˆ‰</span> <span class="skolem">Î±Ïƒ_wit_intersection</span>
           <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
            <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
             urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
             <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">âˆ§</span>
           <span class="main">(</span><span class="main">âˆ€</span><span class="bound">w</span> <span class="bound">Ïƒ'</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">â€¹<span class="var"><span class="var">?Ïƒ_part</span></span> <span class="skolem"><span class="skolem">r</span></span>â€º</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> Ïƒ_part_in_union Ïƒ_part_not_in_intersection
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> del_insts<span class="main"><span class="main">)</span></span> AOT_model_proposition_choice_simp Abs_urrel_inverse Quotient3_abs_rep UnE UnI2 Î±Ïƒ_wit_intersection_def Ï‰rel_to_urrel_def Ï….simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> Ï….simps<span class="main"><span class="main">(</span></span>12<span class="main"><span class="main">)</span></span> mem_Collect_eq r_notin_intersection simp0 urrel_Ï‰rel_quot<span class="main">)</span>
        <span class="keyword1"><span class="command">{</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Ïƒ'</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">urrel</span>
           <span class="main">âˆˆ</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
             <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
              urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
              <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">.</span>
             urrel_to_Ï‰rel <span class="bound">urrel</span>
             <span class="main">âˆ‰</span> <span class="skolem">Î±Ïƒ_wit_intersection</span>
                 <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
                  <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
                   urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
                   <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">âˆ§</span>
             <span class="main">(</span><span class="main">âˆ€</span><span class="bound">w</span> <span class="bound">Ïƒ</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Ïƒ'</span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">urrel</span></span> <span class="keyword2"><span class="keyword">where</span></span>
              A<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">urrel</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
             <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
              urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
              <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">urrel</span>
                           <span class="main">âˆ‰</span> <span class="skolem">Î±Ïƒ_wit_intersection</span>
                               <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
                                <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
                                 urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
                                 <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>â€º</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> C<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">w</span> <span class="bound">Ïƒ</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Ïƒ'</span>â€º</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">{</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">urrel</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">urrel</span>
                           <span class="main">âˆˆ</span> <span class="skolem">Î±Ïƒ_wit_intersection</span>
                               <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span> <span class="main">âˆª</span>
                                <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
                                 urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
                                 <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>â€º</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Î±Ïƒ_wit_intersection_def<span class="main">)</span>
          <span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">urrel</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
              urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">âˆˆ</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆ§</span>
              <span class="main">(</span><span class="main">âˆ€</span><span class="bound">Ïƒ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="bound">Ïƒ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
            <span class="keyword1"><span class="command">using</span></span> A B <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in w<span class="hidden">â‡©</span><sub>0</sub> <span class="main">(</span>Rep_urrel <span class="skolem">urrel</span> <span class="main">(</span>ÏƒÏ… <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Ïƒ'</span>â€º</span></span>
            <span class="keyword1"><span class="command">using</span></span> C calculation <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Ïƒ'</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 2 <span class="main">=</span> this
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit_Ïƒ'</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">âˆª</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> ÏƒÏƒ' <span class="main">(</span>Rep_Ïƒ <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Î±Ïƒ_wit_Ïƒ'_def<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> the_equality<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">Î±Ïƒ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">Î±Ïƒ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span>
      <span class="keyword1"><span class="command">using</span></span> Ïƒcond_univ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹surj <span class="skolem">Î±Ïƒ_wit</span>â€º</span></span>
    <span class="keyword1"><span class="command">using</span></span> surjI <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel setâ€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">r</span> <span class="skolem">s</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">Î±Ïƒ_wit</span> <span class="skolem">b</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆ€</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">âŸ¶</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆ€</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">âŸ¶</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> Î±Ïƒ_wit_def Let_def
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_Ïƒ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_Ïƒset<span class="main">)</span>
       <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_Ïƒset<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">âŸ¹</span> <span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="skolem">a</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">s</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆ€</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">âŸ¶</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆ€</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">âŸ¶</span> <span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">r</span>â€º</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="skolem">b</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel setâ€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">s</span> <span class="skolem">r</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Î±Ïƒ_wit</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">Î±Ïƒ_wit</span> <span class="skolem">b</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span> <span class="main">=</span>
              <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> Î±Ïƒ_wit_def
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_Ïƒ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_Ïƒset<span class="main">)</span>
       <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_Ïƒset<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def Î±Ïƒ_wit_intersection_def Î±Ïƒ_wit_union_def<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="skolem">a</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">r</span>â€º</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>Ï‰ <span class="main">â‡’</span> w <span class="main">â‡’</span> bool<span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">urrel</span> <span class="main">âˆˆ</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"0"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">argo</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="skolem">b</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">r</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem">Î±Ïƒ_wit</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">metis</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">â€¹Restricted model versionâ€º</span></span>

<span class="keyword1"><span class="command">consts</span></span> Î±Ïƒ_restr <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel set <span class="main">â‡’</span> Ïƒâ€º</span></span>

<span class="keyword1"><span class="command">specification</span></span> <span class="main">(</span><span class="quoted">Î±Ïƒ_restr</span><span class="main">)</span>
  Î±Ïƒ_restr_surj<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹surj Î±Ïƒ_restrâ€º</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Ï†</span></span> <span class="keyword2"><span class="keyword">where</span></span> Ï†_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Ï†</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span> <span class="bound">Ïƒ</span> <span class="bound">u</span><span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> ÏƒÏ… <span class="bound">Ïƒ</span><span class="main">)</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">â€¹<span class="main">Î»</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">THE</span> <span class="bound">Ïƒ</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">{</span> Abs_urrel <span class="main">(</span><span class="skolem">Ï†</span> <span class="bound">Ïƒ</span><span class="main">)</span> <span class="main">}</span>â€º</span></span><span class="main"><span class="main">]</span></span>
         surjI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">â€¹<span class="main">Î»</span> <span class="bound">Ïƒ</span> <span class="main">.</span> <span class="main">{</span> Abs_urrel <span class="main">(</span><span class="skolem">Ï†</span> <span class="bound">Ïƒ</span><span class="main">)</span> <span class="main">}</span>â€º</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> ÏƒÏ… <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> ÏƒÏ… <span class="skolem">Ïƒ</span><span class="main">)</span> <span class="main">âŸ¹</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">Ïƒ</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">Ïƒ</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">)</span></span> Ï….inject<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">Ï†</span> <span class="skolem">x</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">Ï†</span> <span class="skolem">Ïƒ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">=</span> <span class="skolem">Ïƒ</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">Ïƒ</span>
      <span class="keyword1"><span class="command">using</span></span> Abs_urrel_inject<span class="main">[</span><span class="operator">THEN</span> iffD1<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Ï†</span> <span class="skolem">x</span>â€º</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">Ï†</span> <span class="skolem">Ïƒ</span>â€º</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Ï†_def AOT_model_proposition_choice_simp<span class="main">)</span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">Ïƒ</span><span class="main">.</span> <span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">Ï†</span> <span class="skolem">x</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">Ï†</span> <span class="bound">Ïƒ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">â€¹Shared for both modelsâ€º</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">Î±Ïƒ</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="free">Î±Ïƒ</span> <span class="main">â‰¡</span> Î±Ïƒ_extâ€º</span></span> <span class="comment1">â€• â€¹Choose model kind.â€º</span>
<span class="keyword1"><span class="command">lemmas</span></span> Î±Ïƒ_surj <span class="main">=</span> Î±Ïƒ_ext_surj

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">ÎºÏ…</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹Îº<span class="main">â‡’</span>Ï…â€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">ÎºÏ…</span> <span class="main">(</span>Ï‰Îº <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> Ï‰Ï… <span class="free"><span class="bound"><span class="entity">x</span></span></span>â€º</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">â€¹<span class="free">ÎºÏ…</span> <span class="main">(</span>Î±Îº <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> ÏƒÏ… <span class="main">(</span>Î±Ïƒ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>â€º</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">â€¹<span class="free">ÎºÏ…</span> <span class="main">(</span>nullÎº <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> nullÏ… <span class="free"><span class="bound"><span class="entity">x</span></span></span>â€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> ÎºÏ…_surj<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹surj ÎºÏ…â€º</span></span>
  <span class="keyword1"><span class="command">using</span></span> Î±Ïƒ_surj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Ï….exhaust surj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_null_false<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="free">w</span> <span class="main">(</span>Rep_urrel <span class="free">f</span> <span class="main">(</span>ÎºÏ… <span class="free">x</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>is_nullÎº <span class="free">x</span>â€º</span></span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> assms Rep_urrel Îº.collapse<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> mem_Collect_eq<span class="main">)</span>


<span class="keyword1"><span class="command">class</span></span> AOT_Term <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_denotes</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span> <span class="main">â‡’</span> boolâ€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_denoting_ex<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">AOT_model_denotes</span> <span class="bound">x</span>â€º</span></span>
<span class="keyword1"><span class="command">class</span></span> AOT_IncompleteTerm <span class="main">=</span> AOT_Term <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_nondenoting_ex<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">Â¬</span>AOT_model_denotes <span class="bound">x</span>â€º</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> prod <span class="main">::</span> <span class="main">(</span><span class="quoted">AOT_Term</span><span class="main">,</span> <span class="quoted">AOT_Term</span><span class="main">)</span> <span class="quoted">AOT_Term</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_denotes_prod</span> <span class="main">â‰¡</span> <span class="main">Î»</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">âˆ§</span> AOT_model_denotes <span class="bound">y</span>â€º</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span><span class="main">.</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_prod_def AOT_model_denoting_ex<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">locale</span></span> AOT_model_irregular_spec <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">AOT_model_irregular</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="tfree">'a</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="tfree">'a</span> <span class="main">â‡’</span> ğ—ˆâ€º</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">AOT_model_regular</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span> <span class="main">â‡’</span> boolâ€º</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">AOT_model_term_equiv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span> <span class="main">â‡’</span> <span class="tfree">'a</span> <span class="main">â‡’</span> boolâ€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_irregular_false<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_valid_in <span class="free">w</span> <span class="main">(</span><span class="free">AOT_model_irregular</span> <span class="free">Ï†</span> <span class="free">x</span><span class="main">)</span>â€º</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> AOT_model_irregular_equiv<span class="main">:</span>
      <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_term_equiv</span> <span class="free">x</span> <span class="free">y</span> <span class="main">âŸ¹</span> <span class="free">AOT_model_irregular</span> <span class="free">Ï†</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_irregular</span> <span class="free">Ï†</span> <span class="free">y</span>â€º</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> AOT_model_irregular_eqI<span class="main">:</span>
      <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">â‹€</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">AOT_model_regular</span> <span class="bound">x</span> <span class="main">âŸ¹</span> <span class="free">Ï†</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Ïˆ</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¹</span> <span class="free">AOT_model_irregular</span> <span class="free">Ï†</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_irregular</span> <span class="free">Ïˆ</span> <span class="free">x</span>â€º</span></span>

<span class="keyword1"><span class="command">class</span></span> AOT_IndividualTerm <span class="main">=</span> AOT_IncompleteTerm <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_regular</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span> <span class="main">â‡’</span> boolâ€º</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_term_equiv</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span> <span class="main">â‡’</span> <span class="tfree">'a</span> <span class="main">â‡’</span> boolâ€º</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_irregular</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="tfree">'a</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="tfree">'a</span> <span class="main">â‡’</span> ğ—ˆâ€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_irregular_nondenoting<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span><span class="free">AOT_model_regular</span> <span class="free">x</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span>AOT_model_denotes <span class="free">x</span>â€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_term_equiv_part_equivp<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹equivp <span class="free">AOT_model_term_equiv</span>â€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_term_equiv_denotes<span class="main">:</span>
    <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_term_equiv</span> <span class="free">x</span> <span class="free">y</span> <span class="main">âŸ¹</span> <span class="main">(</span>AOT_model_denotes <span class="free">x</span> <span class="main">=</span> AOT_model_denotes <span class="free">y</span><span class="main">)</span>â€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_term_equiv_regular<span class="main">:</span>
    <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_term_equiv</span> <span class="free">x</span> <span class="free">y</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="free">AOT_model_regular</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_regular</span> <span class="free">y</span><span class="main">)</span>â€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_irregular<span class="main">:</span>
    <span class="quoted"><span class="quoted">â€¹AOT_model_irregular_spec <span class="free">AOT_model_irregular</span> <span class="free">AOT_model_regular</span> <span class="free">AOT_model_term_equiv</span>â€º</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> AOT_model_irregular_spec <span class="quoted">AOT_model_irregular</span> <span class="quoted">AOT_model_regular</span> <span class="quoted">AOT_model_term_equiv</span>
  <span class="keyword1"><span class="command">using</span></span> AOT_model_irregular <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_term_equiv_eps<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"AOT_model_term_equiv <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">Îº</span><span class="main">)</span><span class="main">)</span> <span class="free">Îº</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"AOT_model_term_equiv <span class="free">Îº</span> <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">Îº</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"AOT_model_term_equiv <span class="free">Îº</span> <span class="free">Îº'</span> <span class="main">âŸ¹</span> <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">Îº</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">Îº'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_part_equivp equivp_def someI_ex<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_part_equivp equivp_def someI_ex<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_part_equivp equivp_def<span class="main">)</span>


<span class="keyword1"><span class="command">typedef</span></span> <span class="tfree">'a</span> rel <span class="main">(</span><span class="quoted">â€¹<span class="keyword1">&lt;</span>_<span class="keyword1">&gt;</span>â€º</span><span class="main">)</span> <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹UNIV<span class="main">::</span><span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> setâ€º</span></span> <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">setup_lifting</span></span> type_definition_rel

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">fix_special</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">fix_special</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">Ï†</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">if</span> AOT_model_regular <span class="bound">x</span> <span class="keyword1">then</span> <span class="bound">Ï†</span> <span class="bound">x</span> <span class="keyword1">else</span> AOT_model_irregular <span class="bound">Ï†</span> <span class="bound">x</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fix_special_denoting<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="free">x</span> <span class="main">âŸ¹</span> fix_special <span class="free">Ï†</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="free">x</span>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_nondenoting fix_special_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> fix_special_non_special<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_regular <span class="free">x</span> <span class="main">âŸ¹</span> fix_special <span class="free">Ï†</span> <span class="free">x</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="free">x</span>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_nondenoting fix_special_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> fix_special_special<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_regular <span class="free">x</span> <span class="main">âŸ¹</span> fix_special <span class="free">Ï†</span> <span class="free">x</span> <span class="main">=</span> AOT_model_irregular <span class="free">Ï†</span> <span class="free">x</span>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fix_special_def<span class="main">)</span>

<span class="keyword1"><span class="command">instantiation</span></span> rel <span class="main">::</span> <span class="main">(</span><span class="quoted">AOT_IndividualTerm</span><span class="main">)</span> <span class="quoted">AOT_IncompleteTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">AOT_model_denotes_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">is</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="main">Î»</span> <span class="bound">Ï†</span> <span class="main">.</span> <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">âŸ¶</span> <span class="bound">Ï†</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">Ï†</span> <span class="bound">y</span><span class="main">)</span> <span class="main">âˆ§</span>
         <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">Ï†</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> AOT_model_denotes <span class="bound">x</span><span class="main">)</span> <span class="main">âˆ§</span>
         <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">Â¬</span>AOT_model_regular <span class="bound">x</span> <span class="main">âŸ¶</span> <span class="bound">Ï†</span> <span class="bound">x</span> <span class="main">=</span> AOT_model_irregular <span class="bound">Ï†</span> <span class="bound">x</span><span class="main">)</span>â€º</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_term_equiv_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">â‡’</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_term_equiv_rel</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">f</span> <span class="bound">g</span> <span class="main">.</span> AOT_model_denotes <span class="bound">f</span> <span class="main">âˆ§</span> AOT_model_denotes <span class="bound">g</span> <span class="main">âˆ§</span> <span class="bound">f</span> <span class="main">=</span> <span class="bound">g</span>â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_regular_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_regular_rel</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">r</span> <span class="main">.</span> Trueâ€º</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="main">(</span>fix_special <span class="skolem">Ï†</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Ï†</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AOT_model_irregular_eqI<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fix_special_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span> <span class="bound">x</span> <span class="main">::</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">â€¹Abs_rel <span class="main">(</span>fix_special <span class="main">(</span><span class="main">Î»</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> False<span class="main">)</span><span class="main">)</span>â€º</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">transfer</span><span class="main">)</span>
       <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp fix_special_def AOT_model_irregular_equiv
                    AOT_model_term_equiv_regular AOT_model_irregular_false<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span> <span class="main">::</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">.</span> <span class="main">Â¬</span>AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">â€¹Abs_rel <span class="main"><span class="main"><span class="main">(</span></span></span><span class="main"><span class="main"><span class="main">Î»</span></span></span><span class="bound"><span class="bound"><span class="bound">x</span></span></span><span class="main"><span class="main"><span class="main">.</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> True<span class="main"><span class="main"><span class="main">)</span></span></span>â€º</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">;</span></span>
        <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_rel.abs_eq AOT_model_nondenoting_ex AOT_model_proposition_choice_simp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_denotes_Abs_rel_fix_specialI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">â‹€</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">âŸ¹</span> <span class="free">Ï†</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="bound">y</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">â‹€</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="free">Ï†</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¹</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="main">(</span>Abs_rel <span class="main">(</span>fix_special <span class="free">Ï†</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span> AOT_model_regular <span class="skolem">x</span> <span class="main">âŸ¹</span>
         AOT_model_irregular <span class="free">Ï†</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> AOT_model_regular <span class="bound">x</span> <span class="keyword1">then</span> <span class="free">Ï†</span> <span class="bound">x</span> <span class="keyword1">else</span> AOT_model_irregular <span class="free">Ï†</span> <span class="bound">x</span><span class="main">)</span> <span class="skolem">x</span>â€º</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AOT_model_irregular_eqI<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_denotes_rel.rep_eq
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_false Abs_rel_inverse AOT_model_irregular_equiv fix_special_def AOT_model_term_equiv_regular<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_term_equiv_rel_equiv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="free">x</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="free">y</span>â€º</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">Î </span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î </span> <span class="main">âŸ¶</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Î </span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Î </span> <span class="free">y</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span>â€º</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span> <span class="bound">Î </span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î </span> <span class="main">âŸ¶</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Î </span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Î </span> <span class="free">y</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_rel.rep_eq<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x'</span> <span class="skolem">y'</span> <span class="main">âŸ¹</span> <span class="main">(</span>AOT_model_denotes <span class="skolem">x'</span> <span class="main">âˆ§</span> AOT_model_term_equiv <span class="skolem">x'</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>AOT_model_denotes <span class="skolem">y'</span> <span class="main">âˆ§</span> AOT_model_term_equiv <span class="skolem">y'</span> <span class="free">y</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x'</span> <span class="skolem">y'</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_denotes AOT_model_term_equiv_part_equivp equivp_def<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span> <span class="bound">Î </span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î </span> <span class="main">âŸ¶</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Î </span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Î </span> <span class="free">y</span><span class="main">)</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="main">(</span>Abs_rel <span class="main">(</span>fix_special <span class="main">(</span><span class="main">Î»</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">âˆ§</span> AOT_model_term_equiv <span class="bound">x</span> <span class="free">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="var">?r</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AOT_model_denotes_Abs_rel_fix_specialI<span class="main">)</span>
       <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> 0 AOT_model_denotes_rel.rep_eq Abs_rel_inverse fix_special_def
                   AOT_model_proposition_choice_simp AOT_model_irregular_false<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="var">?r</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="var">?r</span> <span class="free">y</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Abs_rel_inverse AOT_model_proposition_choice_simp fix_special_denoting<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main"><span class="main">(</span></span></span>1<span class="main"><span class="main"><span class="main">)</span></span></span><span class="main"><span class="main">]</span></span> fix_special_denoting<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main"><span class="main">(</span></span></span>2<span class="main"><span class="main"><span class="main">)</span></span></span><span class="main"><span class="main">]</span></span> assms AOT_model_term_equiv_part_equivp equivp_reflp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">class</span></span> AOT_UnaryIndividualTerm <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_enc</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span> <span class="main">â‡’</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm<span class="main">&gt;</span> <span class="main">â‡’</span> boolâ€º</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free"><span class="free"><span class="free">AOT_model_concrete</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹w <span class="main">â‡’</span> <span class="tfree">'a</span> <span class="main">â‡’</span> boolâ€º</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_no_special_nondenoting<span class="main">:</span>
      <span class="quoted"><span class="quoted">â€¹AOT_model_regular <span class="free">x</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_enc_relid<span class="main">:</span>
        <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="free">F</span> <span class="main">âŸ¹</span>
         AOT_model_denotes <span class="free">G</span> <span class="main">âŸ¹</span>
         <span class="main">(</span><span class="main">â‹€</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">AOT_model_enc</span> <span class="bound">x</span> <span class="free">F</span> <span class="main">âŸ·</span> <span class="free">AOT_model_enc</span> <span class="bound">x</span> <span class="free">G</span><span class="main">)</span>
         <span class="main">âŸ¹</span> <span class="free">F</span> <span class="main">=</span> <span class="free">G</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_A_objects<span class="main">:</span>
        <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">âˆ§</span>
              <span class="main">(</span><span class="main">âˆ€</span><span class="bound">w</span><span class="main">.</span> <span class="main">Â¬</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âˆ§</span>
              <span class="main">(</span><span class="main">âˆ€</span><span class="bound">F</span><span class="main">.</span> AOT_model_denotes <span class="bound">F</span> <span class="main">âŸ¶</span> <span class="free">AOT_model_enc</span> <span class="bound">x</span> <span class="bound">F</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="bound">F</span><span class="main">)</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_contingent<span class="main">:</span>
        <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span> <span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">âˆ§</span> <span class="main">Â¬</span> <span class="free">AOT_model_concrete</span> w<span class="hidden">â‡©</span><sub>0</sub> <span class="bound">x</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_nocoder<span class="main">:</span>
        <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">x</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span><span class="free">AOT_model_enc</span> <span class="free">x</span> <span class="free">F</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_concrete_equiv<span class="main">:</span>
        <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span> <span class="main">âŸ¹</span> <span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">y</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_concrete_denotes<span class="main">:</span>
        <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">x</span> <span class="main">âŸ¹</span> AOT_model_denotes <span class="free">x</span>â€º</span></span>
<span class="comment1">(* only extended models *)</span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_enc_indistinguishable_all<span class="main">:</span>
       <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="free">a</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span><span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">a</span><span class="main">)</span> <span class="main">âŸ¹</span>
        AOT_model_denotes <span class="free">b</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span><span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">b</span><span class="main">)</span> <span class="main">âŸ¹</span>
        AOT_model_denotes <span class="free">Î </span> <span class="main">âŸ¹</span>
        <span class="main">(</span><span class="main">â‹€</span> <span class="bound">Î '</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">â‹€</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span>
        <span class="main">(</span><span class="main">â‹€</span> <span class="bound">Î '</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">â‹€</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Î </span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span> <span class="free">AOT_model_enc</span> <span class="free">a</span> <span class="bound">Î '</span><span class="main">)</span> <span class="main">âŸ¹</span>
        <span class="main">(</span><span class="main">â‹€</span> <span class="bound">Î '</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">â‹€</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Î </span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span> <span class="free">AOT_model_enc</span> <span class="free">b</span> <span class="bound">Î '</span><span class="main">)</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_enc_indistinguishable_ex<span class="main">:</span>
       <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="free">a</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span><span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">a</span><span class="main">)</span> <span class="main">âŸ¹</span>
        AOT_model_denotes <span class="free">b</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span><span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">b</span><span class="main">)</span> <span class="main">âŸ¹</span>
        AOT_model_denotes <span class="free">Î </span> <span class="main">âŸ¹</span>
        <span class="main">(</span><span class="main">â‹€</span> <span class="bound">Î '</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âŸ¹</span> <span class="main">(</span><span class="main">â‹€</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span>
        <span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">Î '</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âˆ§</span> <span class="free">AOT_model_enc</span> <span class="free">a</span> <span class="bound">Î '</span> <span class="main">âˆ§</span> <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Î </span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span>
        <span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">Î '</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âˆ§</span> <span class="free">AOT_model_enc</span> <span class="free">b</span> <span class="bound">Î '</span> <span class="main">âˆ§</span> <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">(</span><span class="main">âˆƒ</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Î </span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">instantiation</span></span> Îº <span class="main">::</span> <span class="quoted">AOT_IndividualTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_term_equiv_Îº</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹Îº <span class="main">â‡’</span> Îº <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_term_equiv_Îº</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> ÎºÏ… <span class="bound">y</span>â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_Îº</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹Îº <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_denotes_Îº</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">Â¬</span>is_nullÎº <span class="bound">x</span>â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_regular_Îº</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹Îº <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_regular_Îº</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">x</span> <span class="main">.</span> Trueâ€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_irregular_Îº</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>Îº <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> Îº <span class="main">â‡’</span> ğ—ˆâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_irregular_Îº</span> <span class="main">â‰¡</span> <span class="keyword1">SOME</span> <span class="bound">Ï†</span> <span class="main">.</span> AOT_model_irregular_spec <span class="bound">Ï†</span> AOT_model_regular AOT_model_term_equivâ€º</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span> <span class="main">::</span> Îº<span class="main">.</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">â€¹Ï‰Îº undefinedâ€º</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
       <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_Îº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span> <span class="main">::</span> Îº<span class="main">.</span> <span class="main">Â¬</span>AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">â€¹nullÎº undefinedâ€º</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
       <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_Îº_def AOT_model_regular_Îº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span>AOT_model_regular <span class="skolem">x</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span> AOT_model_denotes <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">Îº</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_Îº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹equivp <span class="main">(</span>AOT_model_term_equiv <span class="main">::</span> Îº <span class="main">â‡’</span> Îº <span class="main">â‡’</span> bool<span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equivpI<span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span> reflpI exI sympI transpI<span class="main">)</span>
       <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_Îº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">âŸ¹</span> AOT_model_denotes <span class="skolem">x</span> <span class="main">=</span> AOT_model_denotes <span class="skolem">y</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted">Îº</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_denotes_Îº_def AOT_model_term_equiv_Îº_def Îº.exhaust_disc ÎºÏ….simps
              Ï….disc<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Ï….disc<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Ï….disc<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> Ï….disc<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span> is_Î±Îº_def is_Ï‰Îº_def is_nullÎº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">âŸ¹</span> AOT_model_regular <span class="skolem">x</span> <span class="main">=</span> AOT_model_regular <span class="skolem">y</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted">Îº</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_Îº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AOT_model_irregular_spec <span class="main">(</span><span class="main">Î»</span> <span class="bound">Ï†</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span> Îº<span class="main">)</span> <span class="main">.</span>  <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> False<span class="main">)</span> AOT_model_regular AOT_model_term_equiv"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular_spec <span class="main">(</span>AOT_model_irregular<span class="main">::</span><span class="main">(</span>Îº<span class="main">â‡’</span>ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> Îº <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> AOT_model_regular AOT_model_term_equivâ€º</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_irregular_Îº_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> someI_ex<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rel_to_urrel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span>Îº<span class="main">&gt;</span> <span class="main">â‡’</span> urrelâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">rel_to_urrel</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">Î </span> <span class="main">.</span> Abs_urrel <span class="main">(</span><span class="main">Î»</span> <span class="bound">u</span> <span class="main">.</span> Rep_rel <span class="bound">Î </span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span> <span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">urrel_to_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹urrel <span class="main">â‡’</span> <span class="main">&lt;</span>Îº<span class="main">&gt;</span>â€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">urrel_to_rel</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">Ï†</span> <span class="main">.</span> Abs_rel <span class="main">(</span><span class="main">Î»</span> <span class="bound">x</span> <span class="main">.</span> Rep_urrel <span class="bound">Ï†</span> <span class="main">(</span>ÎºÏ… <span class="bound">x</span><span class="main">)</span><span class="main">)</span>â€º</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_rel_equiv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm<span class="main">&gt;</span> <span class="main">â‡’</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">AOT_rel_equiv</span> <span class="main">â‰¡</span> <span class="main">(</span><span class="main">Î»</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">âˆ§</span> AOT_model_denotes <span class="bound">y</span> <span class="main">âˆ§</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_quotient3<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Quotient3 AOT_rel_equiv rel_to_urrel urrel_to_relâ€º</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> Quotient3I<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> Rep_urrel <span class="skolem">a</span> <span class="main">(</span>ÎºÏ… <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> Rep_urrel <span class="skolem">a</span> <span class="bound">u</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> ÎºÏ…_surj surj_f_inv_f verit_sko_ex'<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹rel_to_urrel <span class="main">(</span>urrel_to_rel <span class="skolem">a</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">a</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Abs_rel_inverse rel_to_urrel_def urrel_to_rel_def Rep_urrel_inverse<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_rel_equiv <span class="main">(</span>urrel_to_rel <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span>urrel_to_rel <span class="skolem">a</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_rel_equiv_def urrel_to_rel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_Îº_def AOT_model_denotes_Îº_def
                           AOT_model_term_equiv_Îº_def urrel_null_false<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">w</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="skolem">a</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> <span class="main">Â¬</span> is_nullÎº <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">Ï†</span><span class="main">.</span> <span class="main">âˆ€</span><span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="main">Â¬</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">Ï†</span> <span class="main">(</span>nullÏ… <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Îº.exhaust_disc ÎºÏ….simps Ï….disc<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Ï….disc<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Ï….disc<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span>
                                           Ï….disc<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span> is_Î±Îº_def is_Ï‰Îº_def someI_ex<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 1 <span class="main">=</span> this
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="skolem">s</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹Îº <span class="main">â‡’</span> ğ—ˆâ€º</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">âŸ¶</span> <span class="skolem">r</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">r</span> <span class="bound">y</span>â€º</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">w</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="skolem">r</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">r</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">Ï†</span><span class="main">.</span> <span class="main">âˆ€</span><span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="main">Â¬</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">Ï†</span> <span class="main">(</span>nullÏ… <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 AOT_model_denotes_Îº_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>
    <span class="keyword3"><span class="command">assume</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">âŸ¶</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">s</span> <span class="bound">y</span>â€º</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">w</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="skolem">s</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">s</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">âˆˆ</span> <span class="main">{</span><span class="bound">Ï†</span><span class="main">.</span> <span class="main">âˆ€</span><span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="main">Â¬</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">Ï†</span> <span class="main">(</span>nullÏ… <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>â€º</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 AOT_model_denotes_Îº_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹Abs_urrel <span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">r</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Abs_urrel <span class="main">(</span><span class="main">Î»</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">s</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">r</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">s</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">::</span>Îº<span class="main">.</span> ÎºÏ… <span class="bound">x</span> <span class="main">=</span> <span class="skolem">u</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span>
      <span class="keyword1"><span class="command">unfolding</span></span> Abs_urrel_inject<span class="main">[</span><span class="operator">OF</span> 2 3<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">r</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">s</span> <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
      <span class="keyword1"><span class="command">using</span></span> 4<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">â€¹ÎºÏ… <span class="skolem">x</span>â€º</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> A B AOT_model_term_equiv_Îº_def someI_ex<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">r</span> <span class="main">=</span> <span class="skolem">s</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹AOT_rel_equiv <span class="skolem">r</span> <span class="skolem">s</span> <span class="main">=</span> <span class="main">(</span>AOT_rel_equiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">âˆ§</span> AOT_rel_equiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">âˆ§</span> rel_to_urrel <span class="skolem">r</span> <span class="main">=</span> rel_to_urrel <span class="skolem">s</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span> <span class="skolem">s</span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_rel_equiv_def rel_to_urrel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_quotient<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Quotient AOT_rel_equiv rel_to_urrel urrel_to_rel <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> AOT_rel_equiv <span class="bound">x</span> <span class="bound">x</span> <span class="main">âˆ§</span> rel_to_urrel <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>â€º</span></span>
  <span class="keyword1"><span class="command">using</span></span> Quotient3_to_Quotient<span class="main">[</span><span class="operator">OF</span> urrel_quotient3<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">instantiation</span></span> Îº <span class="main">::</span> <span class="quoted">AOT_UnaryIndividualTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>                          

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_enc_Îº</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹Îº <span class="main">â‡’</span> <span class="main">&lt;</span>Îº<span class="main">&gt;</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_enc_Îº</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">x</span> <span class="bound">F</span> <span class="main">.</span> <span class="keyword1">case</span> <span class="bound">x</span> <span class="keyword1">of</span> Î±Îº <span class="bound">a</span> <span class="main">â‡’</span> AOT_model_denotes <span class="bound">F</span> <span class="main">âˆ§</span> rel_to_urrel <span class="bound">F</span> <span class="main">âˆˆ</span> <span class="bound">a</span> <span class="main">|</span> <span class="main"><span class="bound">_</span></span> <span class="main">â‡’</span> Falseâ€º</span></span>
<span class="keyword1"><span class="command">primrec</span></span> <span class="entity"><span class="class_parameter">AOT_model_concrete_Îº</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹w <span class="main">â‡’</span> Îº <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_concrete_Îº</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="main">(</span>Ï‰Îº <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> AOT_model_concreteÏ‰ <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">w</span></span></span>â€º</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_concrete_Îº</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="main">(</span>Î±Îº <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> Falseâ€º</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_concrete_Îº</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="main">(</span>nullÎº <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> Falseâ€º</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_meta_A_objects_Îº<span class="main">:</span>
  <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span> <span class="main">::</span> Îº<span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">âˆ§</span>
            <span class="main">(</span><span class="main">âˆ€</span><span class="bound">w</span><span class="main">.</span> <span class="main">Â¬</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âˆ§</span>
            <span class="main">(</span><span class="main">âˆ€</span><span class="bound">F</span><span class="main">.</span> AOT_model_denotes <span class="bound">F</span> <span class="main">âŸ¶</span> AOT_model_enc <span class="bound">x</span> <span class="bound">F</span> <span class="main">=</span> <span class="free">Ï†</span> <span class="bound">F</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">Ï†</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">â€¹Î±Îº <span class="main"><span class="main">{</span></span><span class="bound"><span class="bound">f</span></span> <span class="main"><span class="main">.</span></span> <span class="free"><span class="free">Ï†</span></span> <span class="main"><span class="main">(</span></span>urrel_to_rel <span class="bound"><span class="bound">f</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">}</span></span>â€º</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_enc_Îº_def AOT_model_denotes_Îº_def<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Quotient_rep_abs_fold_unmap urrel_quotient<span class="main">)</span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_regular <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">Îº</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_Îº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">F</span> <span class="skolem">G</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span>Îº<span class="main">&gt;</span>â€º</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">F</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">G</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">â‹€</span><span class="bound">x</span><span class="main">.</span> AOT_model_enc <span class="bound">x</span> <span class="skolem">F</span> <span class="main">=</span> AOT_model_enc <span class="bound">x</span> <span class="skolem">G</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ€</span><span class="bound">G</span><span class="main">.</span> AOT_model_denotes <span class="bound">G</span> <span class="main">âŸ¶</span> AOT_model_enc <span class="skolem">x</span> <span class="bound">G</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">F</span> <span class="main">=</span> <span class="bound">G</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">using</span></span> AOT_meta_A_objects_Îº <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">F</span> <span class="main">=</span> <span class="skolem">G</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span> <span class="main">::</span> Îº<span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">âˆ§</span>
                 <span class="main">(</span><span class="main">âˆ€</span><span class="bound">w</span><span class="main">.</span> <span class="main">Â¬</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âˆ§</span>
                 <span class="main">(</span><span class="main">âˆ€</span><span class="bound">F</span><span class="main">.</span> AOT_model_denotes <span class="bound">F</span> <span class="main">âŸ¶</span> AOT_model_enc <span class="bound">x</span> <span class="bound">F</span> <span class="main">=</span> <span class="skolem">Ï†</span> <span class="bound">F</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Ï†</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_meta_A_objects_Îº <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>Îº<span class="main">)</span> <span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span> <span class="main">âˆ§</span> <span class="main">Â¬</span> AOT_model_concrete w<span class="hidden">â‡©</span><sub>0</sub> <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_concrete_Îº.simps<span class="main">(</span>1<span class="main">)</span> AOT_model_contingent_object <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_concrete <span class="skolem">w</span> <span class="skolem">x</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span> AOT_model_enc <span class="skolem">x</span> <span class="skolem">F</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">Îº</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">F</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_enc_Îº_def Îº.case_eq_if Îº.collapse<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">âŸ¹</span> AOT_model_concrete <span class="skolem">w</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_concrete <span class="skolem">w</span> <span class="skolem">y</span>â€º</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted">Îº</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">w</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">induct</span> <span class="quoted"><span class="skolem">y</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_Îº_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_concrete <span class="skolem">w</span> <span class="skolem">x</span> <span class="main">âŸ¹</span> AOT_model_denotes <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">Îº</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> AOT_model_denotes_Îº_def Îº.collapse<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="comment1">(* Extended models only *)</span>
<span class="comment1">(* TODO: brush up proof *)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Îº</span> <span class="skolem">Îº'</span> <span class="main">::</span> <span class="quoted">Îº</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">Î </span> <span class="skolem">Î '</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span>Îº<span class="main">&gt;</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">w</span> <span class="main">::</span> <span class="quoted">w</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Îº</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ„</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">Îº</span>â€º</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Î±Îº <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">Îº</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_Ï‰_concrete_in_some_world AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_Îº_def Îº.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Îº.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Îº'</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ„</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">Îº'</span>â€º</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> b_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Î±Îº <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">Îº'</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_Ï‰_concrete_in_some_world AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_Îº_def Îº.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Îº.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î '</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="skolem">Îº</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="skolem">Îº'</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Î '</span> <span class="skolem">w</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº'</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_rel_rep iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="keyword1">let</span> <span class="bound">r</span> <span class="main">=</span> <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">Î»</span> <span class="bound">u</span> <span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> ÎºÏ… <span class="skolem">Îº</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">in</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº'</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">hence</span></span> Î±Ïƒ_eq<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Î±Ïƒ <span class="skolem">a</span> <span class="main">=</span> Î±Ïƒ <span class="skolem">b</span>â€º</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Let_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">(</span></span>1 2<span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_proposition_choice_simp a_def b_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">assume</span></span> Î _den<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î </span>â€º</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">r</span> <span class="main">.</span> <span class="main">âˆ€</span> <span class="bound">x</span> <span class="main">.</span> Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="bound">r</span> <span class="main">(</span>Ï‰Ï… <span class="bound">x</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">â€¹rel_to_urrel <span class="skolem"><span class="skolem">Î </span></span>â€º</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">unfolding</span></span> rel_to_urrel_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_Îº_def AOT_model_denotes_rel.rep_eq Îº.exhaust_disc ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î </span>â€º</span></span> Ï….disc<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span> Ï….disc<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span> Ï….distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> is_Î±Îº_def is_Ï‰Îº_def verit_sko_ex'<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_rel.rep_eq AOT_model_term_equiv_Îº_def ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Î _den verit_sko_ex'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> r_prop<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="skolem">r</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">x</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î '</span> <span class="main">âŸ¹</span>
              <span class="main">(</span><span class="main">â‹€</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> <span class="main">âˆƒ</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span>
              AOT_model_enc <span class="skolem">Îº</span> <span class="skolem">Î '</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Î '</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î '</span> <span class="main">âŸ¹</span>
              <span class="main">(</span><span class="main">â‹€</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="main">(</span>Ï‰Îº <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span>
              AOT_model_enc <span class="skolem">Îº</span> <span class="skolem">Î '</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Î '</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Îº.exhaust_disc is_Î±Îº_def is_Ï‰Îº_def is_nullÎº_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">â‹€</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>Ï‰Ï… <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span>
              <span class="skolem">r</span> <span class="main">âˆˆ</span> <span class="skolem">a</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span>
    <span class="keyword1"><span class="command">unfolding</span></span> a_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> AOT_model_enc_Îº_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> best<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">â‹€</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r'</span> <span class="main">(</span>Ï‰Ï… <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>Ï‰Ï… <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">âŸ¹</span>
              <span class="skolem">r'</span> <span class="main">âˆˆ</span> <span class="skolem">a</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r'</span>
    <span class="keyword1"><span class="command">unfolding</span></span> r_prop<span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">â‹€</span><span class="bound">s</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">âŸ¹</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="skolem">a</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> urrel_to_Ï‰rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">â‹€</span><span class="bound">s</span><span class="main">.</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">r</span> <span class="main">âŸ¹</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="skolem">b</span>â€º</span></span>
    <span class="keyword1"><span class="command">using</span></span> Î±Ïƒ_eq_ord_exts_all<span class="main">[</span><span class="operator">OF</span> Î±Ïƒ_eq<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword3"><span class="command">assume</span></span> Î '_den<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î '</span>â€º</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="skolem">x</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="main">(</span>Ï‰Îº <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_Ï‰_concrete_in_some_world AOT_model_concrete_Îº.simps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="main">(</span>rel_to_urrel <span class="skolem">Î '</span><span class="main">)</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> best<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def Î '_den ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I r_prop urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="main">(</span>rel_to_urrel <span class="skolem">Î '</span><span class="main">)</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="skolem">r</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> AOT_urrel_Ï‰equiv_def Quotient3_def urrel_Ï‰rel_quot<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹rel_to_urrel <span class="skolem">Î '</span> <span class="main">âˆˆ</span> <span class="skolem">b</span>â€º</span></span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_enc <span class="skolem">Îº'</span> <span class="skolem">Î '</span>â€º</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> b_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> AOT_model_enc_Îº_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Î '_den<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Îº</span> <span class="skolem">Îº'</span> <span class="main">::</span> <span class="quoted">Îº</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">Î </span> <span class="skolem">Î '</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">&lt;</span>Îº<span class="main">&gt;</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">w</span> <span class="main">::</span> <span class="quoted">w</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Îº</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ„</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">Îº</span>â€º</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Î±Îº <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">Îº</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_Ï‰_concrete_in_some_world AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_Îº_def Îº.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Îº.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Îº'</span>â€º</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆ„</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">Îº'</span>â€º</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> b_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Î±Îº <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">Îº'</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_Ï‰_concrete_in_some_world AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_Îº_def Îº.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Îº.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î '</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="skolem">Îº</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="skolem">Îº'</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Î '</span> <span class="skolem">w</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº'</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_rel_rep iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="keyword1">let</span> <span class="bound">r</span> <span class="main">=</span> <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">Î»</span> <span class="bound">u</span> <span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> ÎºÏ… <span class="skolem">Îº</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">in</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>ÎºÏ… <span class="skolem">Îº'</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">hence</span></span> Î±Ïƒ_eq<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Î±Ïƒ <span class="skolem">a</span> <span class="main">=</span> Î±Ïƒ <span class="skolem">b</span>â€º</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Let_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">(</span></span>1 2<span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_proposition_choice_simp a_def b_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">assume</span></span> Î _den<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î </span>â€º</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">r</span> <span class="main">.</span> <span class="main">âˆ€</span> <span class="bound">x</span> <span class="main">.</span> Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="bound">r</span> <span class="main">(</span>Ï‰Ï… <span class="bound">x</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">â€¹rel_to_urrel <span class="skolem"><span class="skolem">Î </span></span>â€º</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">unfolding</span></span> rel_to_urrel_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_Îº_def AOT_model_denotes_rel.rep_eq Îº.exhaust_disc ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> ÎºÏ….simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î </span>â€º</span></span> Ï….disc<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span> Ï….disc<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span> Ï….distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> is_Î±Îº_def is_Ï‰Îº_def verit_sko_ex'<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_rel.rep_eq AOT_model_term_equiv_Îº_def ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Î _den verit_sko_ex'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> r_prop<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="skolem">r</span> <span class="main">(</span>Ï‰Ï… <span class="skolem">x</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">Î '</span><span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âˆ§</span>
             AOT_model_enc <span class="skolem">Îº</span> <span class="bound">Î '</span> <span class="main">âˆ§</span>
             <span class="main">(</span><span class="main">âˆ€</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">âˆƒ</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Î '</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      Î '_den<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î '</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      Îº_enc_Î '<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_enc <span class="skolem">Îº</span> <span class="skolem">Î '</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      Î '_prop<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="skolem">x</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î '</span> <span class="main">(</span>Ï‰Îº <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="main">(</span>Ï‰Îº <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">v</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_Ï‰_concrete_in_some_world Î '_prop<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="main">(</span>rel_to_urrel <span class="skolem">Î '</span><span class="main">)</span> <span class="main">(</span>rel_to_urrel <span class="skolem">Î </span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_urrel_Ï‰equiv_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def Î '_den Î _den ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹rel_to_urrel <span class="skolem">Î '</span> <span class="main">âˆˆ</span> <span class="skolem">a</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">â€¹urrel_to_Ï‰rel <span class="main">(</span>rel_to_urrel <span class="skolem">Î '</span><span class="main">)</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="main">(</span>rel_to_urrel <span class="skolem">Î </span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_enc_Îº_def Îº.simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> Îº_enc_Î ' a_def<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Quotient3_rel <span class="quoted"><span class="quoted">â€¹AOT_urrel_Ï‰equiv <span class="main">(</span>rel_to_urrel <span class="skolem">Î '</span><span class="main">)</span> <span class="main">(</span>rel_to_urrel <span class="skolem">Î </span><span class="main">)</span>â€º</span></span> urrel_Ï‰rel_quot<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span> <span class="main">âˆˆ</span> <span class="skolem">b</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="bound">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="main">(</span>rel_to_urrel <span class="skolem">Î </span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">using</span></span> Î±Ïƒ_eq_ord_exts_ex<span class="main">[</span><span class="operator">OF</span> Î±Ïƒ_eq<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> s_prop<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">s</span> <span class="main">âˆˆ</span> <span class="skolem">b</span> <span class="main">âˆ§</span> urrel_to_Ï‰rel <span class="skolem">s</span> <span class="main">=</span> urrel_to_Ï‰rel <span class="main">(</span>rel_to_urrel <span class="skolem">Î </span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Î ''</span></span> <span class="keyword2"><span class="keyword">where</span></span> Î ''_prop<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹rel_to_urrel <span class="skolem">Î ''</span> <span class="main">=</span> <span class="skolem">s</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> Î ''_den<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">Î ''</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_rel_equiv_def Quotient3_def urrel_quotient3<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_enc <span class="skolem">Îº'</span> <span class="skolem">Î ''</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_enc_Îº_def Î ''_den Î ''_prop Îº.simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> b_def s_prop<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="main">âˆƒ</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">âŸ¹</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î ''</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="skolem">x</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> x_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="skolem">x</span> <span class="main">=</span> Ï‰Îº <span class="skolem">u</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_concrete_Îº.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> Îº.exhaust<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î ''</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="skolem">x</span><span class="main">)</span>â€º</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> x_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> best<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def Î ''_den Î ''_prop Î _den ÎºÏ….simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I s_prop urrel_quotient3 urrel_to_Ï‰rel_def urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">Î '</span><span class="main">.</span> AOT_model_denotes <span class="bound">Î '</span> <span class="main">âˆ§</span>
             AOT_model_enc <span class="skolem">Îº'</span> <span class="bound">Î '</span> <span class="main">âˆ§</span>
             <span class="main">(</span><span class="main">âˆ€</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">âˆƒ</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">âŸ¶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Î '</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Î </span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem">Î ''</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> prod <span class="main">::</span> <span class="main">(</span><span class="quoted">AOT_UnaryIndividualTerm</span><span class="main">,</span> <span class="quoted">AOT_IndividualTerm</span><span class="main">)</span> <span class="quoted">AOT_IndividualTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_regular_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_regular_prod</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">.</span> <span class="main">(</span>AOT_model_regular <span class="bound">x</span> <span class="main">âˆ§</span> AOT_model_regular <span class="bound">y</span> <span class="main">âˆ§</span> <span class="main">(</span>AOT_model_denotes <span class="bound">x</span> <span class="main">âˆ¨</span> AOT_model_denotes <span class="bound">y</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_term_equiv_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_term_equiv_prod</span> <span class="main">â‰¡</span>  <span class="main">Î»</span> <span class="main">(</span><span class="bound">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="bound">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">)</span> <span class="main">(</span><span class="bound">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">,</span><span class="bound">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">.</span> <span class="main">(</span>AOT_model_term_equiv <span class="bound">x<span class="hidden">â‡©</span><sub>1</sub></span> <span class="bound">x<span class="hidden">â‡©</span><sub>2</sub></span> <span class="main">âˆ§</span> AOT_model_term_equiv <span class="bound">y<span class="hidden">â‡©</span><sub>1</sub></span> <span class="bound">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span>
<span class="keyword1"><span class="command">function</span></span> <span class="entity"><span class="class_parameter">AOT_model_irregular_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  AOT_model_irregular_proj2<span class="main">:</span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">âˆ§</span> <span class="main">Â¬</span>AOT_model_denotes <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">âŸ¹</span>
    AOT_model_irregular <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="main">(</span><span class="main">Î»</span><span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x'</span> <span class="main">.</span> AOT_model_term_equiv <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">x'</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="main">|</span> AOT_model_irregular_proj1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span>AOT_model_denotes <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">âˆ§</span> AOT_model_denotes <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">âŸ¹</span>
    AOT_model_irregular <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="main">(</span><span class="main">Î»</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span> <span class="keyword1">SOME</span> <span class="bound">y'</span> <span class="main">.</span> AOT_model_term_equiv <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="bound">y'</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> AOT_model_irregular_prod_generic<span class="main">:</span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> AOT_model_denotes <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">âŸ¹</span>
    AOT_model_irregular <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">Î¦</span> <span class="main">.</span> AOT_model_irregular_spec <span class="bound">Î¦</span> AOT_model_regular AOT_model_term_equiv<span class="main">)</span> <span class="free"><span class="bound"><span class="entity">Ï†</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">termination</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"termination"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_denotes <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_denotes <span class="skolem">y</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_nondenoting_ex AOT_model_denoting_ex<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span><span class="main">.</span> <span class="main">Â¬</span>AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_prod_def AOT_model_regular_prod_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹equivp <span class="main">(</span>AOT_model_term_equiv <span class="main">::</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> bool<span class="main">)</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equivpI<span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span> reflpI sympI transpI<span class="main"><span class="keyword3">;</span></span>
        <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def AOT_model_term_equiv_part_equivp
                  equivp_reflp prod.case_eq_if case_prod_unfold equivp_symp<span class="main">)</span>
       <span class="main">(</span><span class="operator">metis</span> equivp_transp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> AOT_model_term_equiv_part_equivp<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_regular <span class="skolem">x</span> <span class="main">âŸ¹</span> <span class="main">Â¬</span> AOT_model_denotes <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_prod_def AOT_model_irregular_nondenoting
                                   AOT_model_regular_prod_def case_prod_unfold<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">âŸ¹</span> AOT_model_denotes <span class="skolem">x</span> <span class="main">=</span> AOT_model_denotes <span class="skolem">y</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_prod_def AOT_model_term_equiv_denotes
                                   AOT_model_term_equiv_prod_def case_prod_beta<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">âŸ¹</span> AOT_model_regular <span class="skolem">x</span> <span class="main">=</span> AOT_model_regular <span class="skolem">y</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">induct</span> <span class="quoted"><span class="skolem">y</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def AOT_model_regular_prod_def<span class="main">)</span>
       <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes AOT_model_term_equiv_regular<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> sp<span class="main">:</span> AOT_model_irregular_spec <span class="quoted"><span class="quoted">â€¹<span class="main">Î»</span><span class="bound">Ï†</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span><span class="main">)</span> <span class="main">.</span> <span class="keyword1">Îµ<span class="hidden">â‡©</span><sub>ğ—ˆ</sub></span> <span class="bound">w</span> <span class="main">.</span> Falseâ€º</span></span> <span class="quoted">AOT_model_regular</span> <span class="quoted">AOT_model_term_equiv</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_spec_def AOT_model_proposition_choice_simp<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> ex_spec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">âˆƒ</span> <span class="bound">Ï†</span> <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ <span class="main">.</span> AOT_model_irregular_spec <span class="bound">Ï†</span> AOT_model_regular AOT_model_term_equiv"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sp.AOT_model_irregular_spec_axioms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> some_spec<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular_spec
    <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">Ï†</span> <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ <span class="main">.</span> AOT_model_irregular_spec <span class="bound">Ï†</span> AOT_model_regular AOT_model_term_equiv<span class="main">)</span>
    AOT_model_regular AOT_model_term_equivâ€º</span></span>
    <span class="keyword1"><span class="command">using</span></span> someI_ex<span class="main">[</span><span class="operator">OF</span> ex_spec<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">argo</span>
  <span class="keyword1"><span class="command">interpret</span></span> sp_some<span class="main">:</span> AOT_model_irregular_spec
    <span class="quoted"><span class="quoted">â€¹<span class="keyword1">SOME</span> <span class="bound">Ï†</span> <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ <span class="main">.</span> AOT_model_irregular_spec <span class="bound">Ï†</span> AOT_model_regular AOT_model_term_equivâ€º</span></span>
    <span class="quoted">AOT_model_regular</span> <span class="quoted">AOT_model_term_equiv</span>
    <span class="keyword1"><span class="command">using</span></span> some_spec <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular_spec <span class="main">(</span>AOT_model_irregular <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆ<span class="main">)</span> AOT_model_regular AOT_model_term_equivâ€º</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">a</span><span class="main">,</span> <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="skolem">Ï†</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">a</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">b</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="skolem">Ï†</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_prod.induct<span class="main">)</span>
         <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_false sp_some.AOT_model_irregular_false<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">Â¬</span>AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>AOT_model_irregular <span class="skolem">Ï†</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="skolem">Ï†</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span> <span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span> <span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">Ï†</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span><span class="main">â‡’</span>ğ—ˆâ€º</span></span>
      <span class="keyword3"><span class="command">assume</span></span> x<span class="hidden">â‡©</span><sub>1</sub>y<span class="hidden">â‡©</span><sub>1</sub>_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span> <span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span>â€º</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> x<span class="hidden">â‡©</span><sub>2</sub>y<span class="hidden">â‡©</span><sub>2</sub>_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span> <span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> xy_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="main">(</span><span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">(</span><span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">â‡©</span><sub>1</sub>y<span class="hidden">â‡©</span><sub>1</sub>_equiv x<span class="hidden">â‡©</span><sub>2</sub>y<span class="hidden">â‡©</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sp_some.AOT_model_irregular_equiv xy_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">~</span>AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> <span class="main">~</span>AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">~</span>AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> <span class="main">~</span>AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">â‡©</span><sub>1</sub>y<span class="hidden">â‡©</span><sub>1</sub>_equiv x<span class="hidden">â‡©</span><sub>2</sub>y<span class="hidden">â‡©</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sp_some.AOT_model_irregular_equiv xy_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> denotes_x<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> <span class="main">Â¬</span>AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
        <span class="keyword1"><span class="command">hence</span></span> denotes_y<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> <span class="main">Â¬</span>AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">â‡©</span><sub>1</sub>y<span class="hidden">â‡©</span><sub>1</sub>_equiv x<span class="hidden">â‡©</span><sub>2</sub>y<span class="hidden">â‡©</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> eps_eq<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">)</span> <span class="main">=</span> Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> x<span class="hidden">â‡©</span><sub>1</sub>y<span class="hidden">â‡©</span><sub>1</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">using</span></span> denotes_x denotes_y <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> x<span class="hidden">â‡©</span><sub>2</sub>y<span class="hidden">â‡©</span><sub>2</sub>_equiv eps_eq AOT_model_irregular_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> denotes_x<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> AOT_model_denotes <span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
        <span class="keyword1"><span class="command">hence</span></span> denotes_y<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span> <span class="main">âˆ§</span> AOT_model_denotes <span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">â‡©</span><sub>1</sub>y<span class="hidden">â‡©</span><sub>1</sub>_equiv x<span class="hidden">â‡©</span><sub>2</sub>y<span class="hidden">â‡©</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> eps_eq<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> x<span class="hidden">â‡©</span><sub>2</sub>y<span class="hidden">â‡©</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span>
          <span class="keyword1"><span class="command">using</span></span> denotes_x denotes_y
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> x<span class="hidden">â‡©</span><sub>1</sub>y<span class="hidden">â‡©</span><sub>1</sub>_equiv eps_eq AOT_model_irregular_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">x<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">y<span class="hidden">â‡©</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">â‡©</span><sub>2</sub></span><span class="main">)</span>â€º</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 0 <span class="main">=</span> this
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">âŸ¹</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ï†</span> <span class="skolem">y</span>â€º</span></span>
      <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span>â€º</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">Ï†</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">induct</span> <span class="quoted"><span class="skolem">y</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def 0<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Ï†</span> <span class="skolem">Ïˆ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span> <span class="main">â‡’</span> ğ—ˆâ€º</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_regular <span class="skolem">x</span> <span class="main">âŸ¹</span> <span class="skolem">Ï†</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">Ïˆ</span> <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_regular <span class="skolem">x</span> <span class="main">âˆ§</span> AOT_model_regular <span class="skolem">y</span> <span class="main">âˆ§</span> <span class="main">(</span>AOT_model_denotes <span class="skolem">x</span> <span class="main">âˆ¨</span> AOT_model_denotes <span class="skolem">y</span><span class="main">)</span> <span class="main">âŸ¹</span> <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">Ïˆ</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
      <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_regular_prod_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="skolem">Ï†</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ïˆ</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">y</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="skolem">Ïˆ</span></span> <span class="quoted"><span class="skolem">Ï†</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_prod.induct<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>1 <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">Ï†</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_eqI AOT_model_irregular_nondenoting AOT_model_term_equiv_denotes AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>2 <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">Ï†</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_nondenoting AOT_model_no_special_nondenoting AOT_model_term_equiv_denotes AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>3 <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">Ï†</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_regular_prod_def case_prod_conv sp_some.AOT_model_irregular_eqI surj_pair<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_irregular <span class="skolem">Ï†</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">Ïˆ</span> <span class="skolem">x</span>â€º</span></span> <span class="keyword2"><span class="keyword">for</span></span>  <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">Ã—</span><span class="tfree">'b</span>â€º</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> surjective_pairing<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_meta_prod_equivI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹€</span> <span class="main">(</span><span class="bound">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>AOT_UnaryIndividualTerm<span class="main">)</span> <span class="bound">x</span> <span class="main">(</span><span class="bound">y</span> <span class="main">::</span> <span class="tfree">'b</span><span class="main">::</span>AOT_IndividualTerm<span class="main">)</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">âŸ¹</span> AOT_model_term_equiv <span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">â‹€</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>AOT_UnaryIndividualTerm<span class="main">)</span> <span class="bound">y</span> <span class="main">(</span><span class="bound">b</span> <span class="main">::</span> <span class="tfree">'b</span><span class="main">::</span>AOT_IndividualTerm<span class="main">)</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">âŸ¹</span> AOT_model_term_equiv <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_term_equiv_prod_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_part_equivp equivp_reflp<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>


<span class="keyword1"><span class="command">instantiation</span></span> unit <span class="main">::</span> <span class="quoted">AOT_Term</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_unit</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹unit <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_denotes_unit</span> <span class="main">â‰¡</span> <span class="main">Î»</span><span class="main"><span class="bound">_</span></span><span class="main">.</span> Trueâ€º</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span><span class="main">::</span>unit<span class="main">.</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_unit_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> ğ—ˆ <span class="main">::</span> <span class="quoted">AOT_Term</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_ğ—ˆ</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹ğ—ˆ <span class="main">â‡’</span> boolâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_denotes_ğ—ˆ</span> <span class="main">â‰¡</span> <span class="main">Î»</span><span class="main"><span class="bound">_</span></span><span class="main">.</span> Trueâ€º</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">âˆƒ</span><span class="bound">x</span><span class="main">::</span>ğ—ˆ<span class="main">.</span> AOT_model_denotes <span class="bound">x</span>â€º</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_ğ—ˆ_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">typedef</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">overloaded</span></span><span class="main">)</span> <span class="tfree">'a</span> AOT_var <span class="main">=</span> <span class="quoted"><span class="quoted">â€¹<span class="main">{</span> <span class="bound">x</span> <span class="main">::</span> <span class="tfree">'a</span><span class="main">::</span>AOT_Term <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">}</span>â€º</span></span>
  <span class="keyword2"><span class="keyword">morphisms</span></span> AOT_term_of_var AOT_var_of_term
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denoting_ex<span class="main">)</span>

<span class="keyword1"><span class="command">declare</span></span> AOT_var_of_term_induct<span class="main">[</span><span class="operator">induct</span> <span class="quasi_keyword">del</span><span class="main">]</span>
        AOT_var_of_term_cases<span class="main">[</span><span class="operator">cases</span> <span class="quasi_keyword">del</span><span class="main">]</span>
        AOT_term_of_var_induct<span class="main">[</span><span class="operator">induct</span> <span class="quasi_keyword">del</span><span class="main">]</span>
        AOT_term_of_var_cases<span class="main">[</span><span class="operator">cases</span> <span class="quasi_keyword">del</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemmas</span></span> AOT_var_of_term_inverse <span class="main">=</span> AOT_var_of_term_inverse<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_var_of_term_inject <span class="main">=</span> AOT_var_of_term_inject<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_var_of_term_induct <span class="main">=</span> AOT_var_of_term_induct<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">induct</span> <span class="quasi_keyword">type</span><span class="main"><span class="main">:</span></span> AOT_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_var_of_term_cases <span class="main">=</span> AOT_var_of_term_cases<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">cases</span> <span class="quasi_keyword">type</span><span class="main"><span class="main">:</span></span> AOT_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var <span class="main">=</span> AOT_term_of_var<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_cases <span class="main">=</span> AOT_term_of_var_cases<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">induct</span> <span class="quasi_keyword">pred</span><span class="main"><span class="main">:</span></span> AOT_term_of_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_induct <span class="main">=</span> AOT_term_of_var_induct<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">induct</span> <span class="quasi_keyword">pred</span><span class="main"><span class="main">:</span></span> AOT_term_of_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_inverse <span class="main">=</span> AOT_term_of_var_inverse<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_inject <span class="main">=</span> AOT_term_of_var_inject<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>

<span class="keyword1"><span class="command">consts</span></span> AOT_model_equiv_def <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹ğ—ˆ <span class="main">â‡’</span> ğ—ˆ <span class="main">â‡’</span> boolâ€º</span></span>
<span class="keyword1"><span class="command">specification</span></span><span class="main">(</span><span class="quoted">AOT_model_equiv_def</span><span class="main">)</span>
  AOT_model_equiv_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹AOT_model_equiv_def <span class="free">Ï†</span> <span class="free">Ïˆ</span> <span class="main">=</span> <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="free">Ï†</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="free">Ïˆ</span><span class="main">)</span>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">â€¹<span class="main"><span class="main"><span class="main">Î»</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ï†</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ïˆ</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">âˆ€</span></span></span> <span class="bound"><span class="bound"><span class="bound">v</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> AOT_model_valid_in <span class="bound"><span class="bound"><span class="bound">v</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ï†</span></span></span> <span class="main"><span class="main"><span class="main">=</span></span></span> AOT_model_valid_in <span class="bound"><span class="bound"><span class="bound">v</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ïˆ</span></span></span>â€º</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">consts</span></span> AOT_model_id_def <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span><span class="tfree">'b</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">::</span>AOT_Term<span class="main">)</span> <span class="main">â‡’</span> <span class="main">(</span><span class="tfree">'b</span> <span class="main">â‡’</span> <span class="tfree">'a</span><span class="main">)</span> <span class="main">â‡’</span> boolâ€º</span></span>
<span class="keyword1"><span class="command">specification</span></span><span class="main">(</span><span class="quoted">AOT_model_id_def</span><span class="main">)</span>
  AOT_model_id_def<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">(</span>AOT_model_id_def <span class="free">Ï„</span> <span class="free">Ïƒ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">âˆ€</span> <span class="bound">Î±</span> <span class="main">.</span> <span class="keyword1">if</span> AOT_model_denotes <span class="main">(</span><span class="free">Ïƒ</span> <span class="bound">Î±</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">Ï„</span> <span class="bound">Î±</span> <span class="main">=</span> <span class="free">Ïƒ</span> <span class="bound">Î±</span> <span class="keyword1">else</span> <span class="main">Â¬</span>AOT_model_denotes <span class="main">(</span><span class="free">Ï„</span> <span class="bound">Î±</span><span class="main">)</span><span class="main">)</span>â€º</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">Î»</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ï„</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ïƒ</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">âˆ€</span></span></span> <span class="bound"><span class="bound"><span class="bound">Î±</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">if</span></span></span> AOT_model_denotes <span class="main"><span class="main"><span class="main">(</span></span></span><span class="bound"><span class="bound"><span class="bound">Ïƒ</span></span></span> <span class="bound"><span class="bound"><span class="bound">Î±</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">then</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ï„</span></span></span> <span class="bound"><span class="bound"><span class="bound">Î±</span></span></span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="bound"><span class="bound"><span class="bound">Ïƒ</span></span></span> <span class="bound"><span class="bound"><span class="bound">Î±</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">else</span></span></span> <span class="main"><span class="main"><span class="main">Â¬</span></span></span>AOT_model_denotes <span class="main"><span class="main"><span class="main">(</span></span></span><span class="bound"><span class="bound"><span class="bound">Ï„</span></span></span> <span class="bound"><span class="bound"><span class="bound">Î±</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="operator">blast</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_nondenoting</span> <span class="main">::</span> <span class="quoted"><span class="quoted">â€¹<span class="tfree">'a</span><span class="main">::</span>AOT_IncompleteTermâ€º</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">â€¹<span class="free">AOT_model_nondenoting</span> <span class="main">â‰¡</span> <span class="keyword1">SOME</span> <span class="bound">Ï„</span> <span class="main">.</span> <span class="main">Â¬</span>AOT_model_denotes <span class="bound">Ï„</span>â€º</span></span>
<span class="keyword1"><span class="command">lemma</span></span> AOT_model_nondenoing<span class="main">:</span> <span class="quoted"><span class="quoted">â€¹<span class="main">Â¬</span>AOT_model_denotes <span class="main">(</span>AOT_model_nondenoting<span class="main">)</span>â€º</span></span>
  <span class="keyword1"><span class="command">using</span></span> someI_ex<span class="main">[</span><span class="operator">OF</span> AOT_model_nondenoting_ex<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_nondenoting_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_axiom</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">AOT_model_axiom</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">Ï†</span> <span class="main">.</span> <span class="main">âˆ€</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="bound">Ï†</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_act_axiom</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">AOT_model_act_axiom</span> <span class="main">â‰¡</span> <span class="main">Î»</span> <span class="bound">Ï†</span> <span class="main">.</span> AOT_model_valid_in w<span class="hidden">â‡©</span><sub>0</sub> <span class="bound">Ï†</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_axiomI<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹<span class="main">â‹€</span><span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="free">Ï†</span>â€º</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_axiom <span class="free">Ï†</span>â€º</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_axiom_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_act_axiomI<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_valid_in w<span class="hidden">â‡©</span><sub>0</sub> <span class="free">Ï†</span>â€º</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">â€¹AOT_model_act_axiom <span class="free">Ï†</span>â€º</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_act_axiom_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">.</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span></pre>
</body>

</html>