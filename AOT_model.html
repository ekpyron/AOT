<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory AOT_model</title>
</head>


<body>
<div class="head">
<h1>Theory AOT_model</h1>
</div>

<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> AOT_model
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="../../HOL/HOL/Main.html">Main</a>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">declare</span></span><span class="main">[</span><span class="main">[</span><span class="operator">typedef_overloaded</span><span class="main">]</span><span class="main">]</span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Model for the Logic of AOT›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹We introduce a primitive type for hyperintensional propositions.›</span></span>
<span class="keyword1"><span class="command">typedecl</span></span> 𝗈

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹To be able to model modal operators following Kripke semantics, we introduce a primitive
     type for possible worlds and assert, by axiom, that there is a surjective function mapping
     propositions to the boolean-valued functions acting on possible worlds. We call the result
     of applying this function to a proposition the Kripke-extension of the proposition.›</span></span>
<span class="keyword1"><span class="command">typedecl</span></span> w <span class="comment1">―‹The primtive type of possible worlds.›</span>
<span class="keyword1"><span class="command">axiomatization</span></span> <span class="free">AOT_model_d𝗈</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹𝗈<span class="main">⇒</span><span class="main">(</span>w<span class="main">⇒</span>bool<span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">where</span></span> d𝗈_surj<span class="main">:</span> <span class="quoted"><span class="quoted">‹surj <span class="free">AOT_model_d𝗈</span>›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Furthermore, the axioms of PLM require the existence of a non-actual world.›</span></span>
<span class="keyword1"><span class="command">consts</span></span> w<span class="hidden">⇩</span><sub>0</sub> <span class="main">::</span> <span class="quoted">w</span> <span class="comment1">―‹The designated actual world.›</span>
<span class="keyword1"><span class="command">axiomatization</span></span> <span class="keyword2"><span class="keyword">where</span></span> AOT_model_nonactual_world<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">w</span> <span class="main">.</span> <span class="bound">w</span> <span class="main">≠</span> w<span class="hidden">⇩</span><sub>0</sub>›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Validity of a proposition in a given world can now be modelled as the result
     of applying that world to the Kripke-extension of the proposition.›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_valid_in</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹w<span class="main">⇒</span>𝗈<span class="main">⇒</span>bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_valid_in</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">≡</span> AOT_model_d𝗈 <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="free"><span class="bound"><span class="entity">w</span></span></span>›</span></span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹By construction, we can choose a proposition for any given Kripke-extension, s.t.
     the proposition is valid in a possible world is its Kripke-extension evaluates to true
     at that world.›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_proposition_choice</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>w<span class="main">⇒</span>bool<span class="main">)</span> <span class="main">⇒</span> 𝗈›</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">binder</span></span> <span class="quoted">‹<span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> ›</span> 8<span class="main">)</span>
  <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1"><span class="free">ε<span class="hidden">⇩</span><sub>𝗈</sub></span></span> <span class="bound">w</span><span class="main"><span class="free">.</span></span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="bound">w</span> <span class="main">≡</span> <span class="main">(</span>inv AOT_model_d𝗈<span class="main">)</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span>›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> AOT_model_proposition_choice_simp<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="free">w</span> <span class="main">(</span><span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="free">φ</span> <span class="bound">w</span><span class="main">)</span> <span class="main">=</span> <span class="free">φ</span> <span class="free">w</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> surj_f_inv_f<span class="main"><span class="main">[</span></span><span class="operator">OF</span> d𝗈_surj<span class="main"><span class="main">]</span></span> AOT_model_valid_in_def AOT_model_proposition_choice_def<span class="main">)</span>

<span class="keyword1"><span class="command">text</span></span><span class="quoted"><span class="plain_text">‹Nitpick can trivially show that there are models for the axioms above.›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> <span class="quoted"><span class="quoted">‹True›</span></span> <span class="keyword1"><span class="command">nitpick</span></span><span class="main">[</span>satisfy<span class="main">,</span> user_axioms<span class="main">,</span> expect <span class="main">=</span> genuine<span class="main">]</span> <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">typedecl</span></span> ω

<span class="keyword1"><span class="command">typedecl</span></span> σ'
<span class="keyword1"><span class="command">consts</span></span> σ'<span class="hidden">⇩</span><sub>V</sub> <span class="main">::</span> <span class="quoted">σ'</span>
<span class="keyword1"><span class="command">consts</span></span> σ'<span class="hidden">⇩</span><sub>0</sub> <span class="main">::</span> <span class="quoted">σ'</span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">σcond</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> σ' <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">σcond</span> <span class="main">≡</span> <span class="main">λ</span> <span class="main">(</span><span class="bound">ordext</span> <span class="main">::</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set<span class="main">,</span> <span class="bound">ordext'</span> <span class="main">::</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set<span class="main">,</span> <span class="bound">σ'</span> <span class="main">::</span> σ'<span class="main">)</span> <span class="main">.</span>
    <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">ordext</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">ordext'</span><span class="main">)</span> <span class="main">∧</span> <span class="main">(</span><span class="keyword1">if</span> <span class="bound">ordext'</span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> <span class="bound">σ'</span> <span class="main">=</span> σ'<span class="hidden">⇩</span><sub>0</sub> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">ordext'</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">ordext</span> <span class="keyword1">then</span> <span class="bound">σ'</span> <span class="main">=</span> σ'<span class="hidden">⇩</span><sub>V</sub> <span class="keyword1">else</span> True<span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">σset</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">σset</span> <span class="main">≡</span> Collect σcond›</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">ordext_intersection</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> σ' <span class="main">⇒</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">ordext_intersection</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">set</span> <span class="main">.</span> fst <span class="bound">set</span>›</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">ordext_union</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> σ' <span class="main">⇒</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">ordext_union</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">set</span> <span class="main">.</span> fst <span class="main">(</span>snd <span class="bound">set</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">σσ'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> set <span class="main">×</span> σ' <span class="main">⇒</span> σ'›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">σσ'</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">set</span> <span class="main">.</span> snd <span class="main">(</span>snd <span class="bound">set</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> σcondI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> ordext_intersection <span class="free">σ</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> ordext_union <span class="free">σ</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹ordext_union <span class="free">σ</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> σσ' <span class="free">σ</span> <span class="main">=</span> σ'<span class="hidden">⇩</span><sub>0</sub>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹ordext_union <span class="free">σ</span> <span class="main">≠</span> <span class="main">{}</span> <span class="main">⟹</span> ordext_intersection <span class="free">σ</span> <span class="main">=</span> ordext_union <span class="free">σ</span> <span class="main">⟹</span> σσ' <span class="free">σ</span> <span class="main">=</span> σ'<span class="hidden">⇩</span><sub>V</sub>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹σcond <span class="free">σ</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> σcond_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
<span class="keyword1"><span class="command">typedef</span></span> σ <span class="main">=</span> <span class="quoted"><span class="quoted">‹σset›</span></span> <span class="keyword1"><span class="command">unfolding</span></span> σset_def σcond_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">typedecl</span></span> null
<span class="keyword1"><span class="command">datatype</span></span> υ <span class="main">=</span> ωυ <span class="quoted">ω</span> <span class="main">|</span> συ <span class="quoted">σ</span> <span class="main">|</span> <span class="entity">is_nullυ</span><span class="main">:</span> nullυ <span class="quoted">null</span>

<span class="keyword1"><span class="command">consts</span></span> AOT_model_concreteω <span class="main">::</span> <span class="quoted"><span class="quoted">‹ω <span class="main">⇒</span> w <span class="main">⇒</span>  bool›</span></span>
<span class="keyword1"><span class="command">specification</span></span> <span class="main">(</span><span class="quoted">AOT_model_concreteω</span><span class="main">)</span>
  AOT_model_ω_concrete_in_some_world<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_concreteω <span class="free">x</span> <span class="bound">w</span>›</span></span>
  AOT_model_contingent_object<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_concreteω <span class="bound">x</span> <span class="bound">w</span> <span class="main">∧</span> <span class="main">¬</span>AOT_model_concreteω <span class="bound">x</span> w<span class="hidden">⇩</span><sub>0</sub>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">‹<span class="main"><span class="main"><span class="main">λ</span></span></span><span class="main"><span class="bound"><span class="main"><span class="bound"><span class="main"><span class="bound">_</span></span></span></span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span><span class="main"><span class="main"><span class="main">.</span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span> <span class="main"><span class="main"><span class="main">≠</span></span></span> w<span class="hidden">⇩</span><sub>0</sub>›</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_nonactual_world<span class="main">)</span>

<span class="keyword1"><span class="command">typedef</span></span> urrel <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span> <span class="bound">φ</span> <span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">.</span> <span class="main">¬</span>AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">φ</span> <span class="main">(</span>nullυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">}</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">‹<span class="main"><span class="main"><span class="main">λ</span></span></span> <span class="bound"><span class="bound"><span class="bound">x</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">(</span></span></span><span class="keyword1"><span class="keyword1"><span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">¬</span></span></span>is_nullυ <span class="bound"><span class="bound"><span class="bound">x</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span>›</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>

<span class="keyword1"><span class="command">datatype</span></span> κ <span class="main">=</span> ωκ <span class="quoted">ω</span> <span class="main">|</span> ακ <span class="quoted"><span class="quoted">‹urrel set›</span></span> <span class="main">|</span> <span class="entity">is_nullκ</span><span class="main">:</span> nullκ <span class="quoted">null</span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Extended model version›</span></span>

<span class="keyword1"><span class="command">consts</span></span> ασ_ext <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel set <span class="main">⇒</span> σ›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">urrel_to_ωrel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel <span class="main">⇒</span> <span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">urrel_to_ωrel</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">r</span> <span class="bound">u</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>ωυ <span class="bound">u</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">ωrel_to_urrel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">)</span> <span class="main">⇒</span> urrel›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">ωrel_to_urrel</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">φ</span> <span class="main">.</span> Abs_urrel <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> ωυ <span class="bound">x</span> <span class="main">⇒</span> <span class="bound">φ</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> <span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> False<span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_urrel_ωequiv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel <span class="main">⇒</span> urrel <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_urrel_ωequiv</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">r</span> <span class="bound">s</span> <span class="main">.</span> <span class="main">∀</span> <span class="bound">u</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>ωυ <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="bound">s</span> <span class="main">(</span>ωυ <span class="bound">u</span><span class="main">)</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_ωrel_quot<span class="main">:</span> <span class="quoted"><span class="quoted">‹Quotient3 AOT_urrel_ωequiv urrel_to_ωrel ωrel_to_urrel›</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> Quotient3I<span class="main">)</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="main">(</span>ωrel_to_urrel <span class="skolem">a</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">unfolding</span></span> ωrel_to_urrel_def urrel_to_ωrel_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="main">(</span>ωrel_to_urrel <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span>ωrel_to_urrel <span class="skolem">a</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">unfolding</span></span> ωrel_to_urrel_def AOT_urrel_ωequiv_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span>1 2<span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="skolem">r</span> <span class="skolem">s</span> <span class="main">=</span> <span class="main">(</span>AOT_urrel_ωequiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">∧</span> AOT_urrel_ωequiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">∧</span> urrel_to_ωrel <span class="skolem">r</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">s</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span> <span class="skolem">s</span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="skolem">r</span> <span class="skolem">s</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ωυ <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">s</span> <span class="main">(</span>ωυ <span class="skolem">u</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
      <span class="keyword1"><span class="command">using</span></span> AOT_urrel_ωequiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">r</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">s</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> urrel_to_ωrel_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">∧</span> AOT_urrel_ωequiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">∧</span> urrel_to_ωrel <span class="skolem">r</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">s</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> AOT_urrel_ωequiv_def
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">∧</span> AOT_urrel_ωequiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">∧</span> urrel_to_ωrel <span class="skolem">r</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">s</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ωυ <span class="skolem">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">s</span> <span class="main">(</span>ωυ <span class="skolem">u</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span> <span class="skolem">v</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> urrel_to_ωrel_def<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="skolem">r</span> <span class="skolem">s</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> AOT_urrel_ωequiv_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">specification</span></span> <span class="main">(</span><span class="quoted">ασ_ext</span><span class="main">)</span>
  ασ_ext_surj<span class="main">:</span> <span class="quoted"><span class="quoted">‹surj ασ_ext›</span></span>
  ασ_eq_ord_exts_all<span class="main">:</span>
    <span class="quoted"><span class="quoted">‹ασ_ext <span class="free">a</span> <span class="main">=</span> ασ_ext <span class="free">b</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span><span class="bound">s</span> <span class="main">.</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="free">r</span> <span class="main">⟹</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">a</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span> <span class="bound">s</span> <span class="main">.</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="free">r</span> <span class="main">⟹</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">b</span><span class="main">)</span>›</span></span>
  ασ_eq_ord_exts_ex<span class="main">:</span>
    <span class="quoted"><span class="quoted">‹ασ_ext <span class="free">a</span> <span class="main">=</span> ασ_ext <span class="free">b</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">s</span> <span class="main">.</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">a</span> <span class="main">∧</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="free">r</span><span class="main">)</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">∃</span><span class="bound">s</span> <span class="main">.</span> <span class="bound">s</span> <span class="main">∈</span> <span class="free">b</span> <span class="main">∧</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="free">r</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="comment1">(* TODO: find better proof/strategy or simplify *)</span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ασ_wit_intersection</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_intersection</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">urrels</span> <span class="main">.</span> <span class="main">{</span><span class="bound">ordext</span> <span class="main">.</span> <span class="main">∀</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">⟶</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="bound">urrels</span><span class="main">}</span>›</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ασ_wit_union</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_union</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">urrels</span> <span class="main">.</span> <span class="main">{</span><span class="bound">ordext</span> <span class="main">.</span> <span class="main">∃</span><span class="bound">urrel</span><span class="main">∈</span><span class="bound">urrels</span> <span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>›</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ασ_wit_σ'</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_σ'</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">urrels</span> <span class="main">.</span> <span class="keyword1">THE</span> <span class="bound">σ'</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="bound">urrels</span> <span class="main">.</span>
          urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∉</span> <span class="skolem">ασ_wit_intersection</span> <span class="bound">urrels</span> <span class="main">∧</span>
          <span class="main">(</span> <span class="main">∀</span> <span class="bound">w</span> <span class="bound">σ</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> σσ' <span class="main">(</span>Rep_σ <span class="bound">σ</span><span class="main">)</span> <span class="main">=</span> <span class="bound">σ'</span><span class="main">)</span>›</span></span>

  <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?ασ_wit</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span> <span class="bound">urrels</span> <span class="main">.</span> 
        <span class="keyword1">let</span> <span class="bound">ordexts</span> <span class="main">=</span> <span class="skolem">ασ_wit_intersection</span> <span class="bound">urrels</span> <span class="keyword1">in</span>
        <span class="keyword1">let</span> <span class="bound">ordexts'</span> <span class="main">=</span> <span class="skolem">ασ_wit_union</span> <span class="bound">urrels</span> <span class="keyword1">in</span>
      <span class="main">(</span><span class="bound">ordexts</span><span class="main">,</span> <span class="bound">ordexts'</span><span class="main">,</span> <span class="keyword1">if</span> <span class="bound">ordexts'</span> <span class="main">=</span> <span class="main">{}</span> <span class="keyword1">then</span> σ'<span class="hidden">⇩</span><sub>0</sub> <span class="keyword1">else</span> <span class="keyword1">if</span> <span class="main">∀</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">ordexts'</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> <span class="bound">ordexts</span> <span class="keyword1">then</span> σ'<span class="hidden">⇩</span><sub>V</sub> <span class="keyword1">else</span> <span class="skolem">ασ_wit_σ'</span> <span class="bound">urrels</span><span class="main">)</span>›</span></span>
  <span class="keyword3"><span class="command">define</span></span> <span class="skolem"><span class="skolem">ασ_wit</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel set <span class="main">⇒</span> σ›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
    <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">urrels</span> <span class="main">.</span> Abs_σ <span class="main">(</span><span class="var">?ασ_wit</span> <span class="bound">urrels</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="skolem">y</span> <span class="main">⟶</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="skolem">x</span> <span class="main">⟹</span> <span class="main">∃</span><span class="bound">urrel</span><span class="main">∈</span><span class="skolem">x</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">y</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> Quotient3_abs_rep urrel_ωrel_quot<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> wits_in_σset<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="var">?ασ_wit</span> <span class="skolem">x</span> <span class="main">∈</span> σset›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">unfolding</span></span> σset_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> σcondI<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def 1 ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span>

  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">σ</span>
    <span class="keyword1"><span class="command">have</span></span> σcond<span class="main">:</span> <span class="quoted"><span class="quoted">‹σcond <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> Rep_σ σset_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">have</span></span> σcond_empty<span class="main">:</span> <span class="quoted"><span class="quoted">‹fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span> <span class="main">⟹</span> <span class="main">(</span>fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Product_Type.Collect_case_prodD Rep_σ σcond_def σset_def curryI curry_case_prod eq_fst_iff ex_in_conv<span class="main">)</span> 
    <span class="keyword1"><span class="command">have</span></span> σcond_univ<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> UNIV <span class="main">⟹</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> UNIV›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> UNIV_I UNIV_eq_I σcond σcond_def prod.case_eq_if<span class="main">)</span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">=</span> <span class="main">{}</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> σcond_empty calculation<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹σσ' <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">=</span> σ'<span class="hidden">⇩</span><sub>0</sub>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> σcond σcond_def calculation prod.case_eq_if<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="main">{}</span> <span class="main">=</span> Abs_σ <span class="main">(</span><span class="main">{}</span><span class="main">,</span><span class="main">{}</span><span class="main">,</span>σ'<span class="hidden">⇩</span><sub>0</sub><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> ασ_wit_def
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_σ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command">using</span></span> wits_in_σset <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> σcond σset_def calculation<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> mem_Collect_eq prod.exhaust_sel<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Quotient3_def urrel_ωrel_quot<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="main">{}</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> ασ_wit_def
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rep_σ_inverse prod.collapse<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">ασ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">assume</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">‹ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">=</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> σ'<span class="hidden">⇩</span><sub>V</sub>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> Rep_σ σcond_def σset_def calculation<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> mem_Collect_eq prod.case_eq_if<span class="main">)</span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword1"><span class="command">have</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">ordext</span><span class="main">.</span> <span class="main">∃</span><span class="bound">urrel</span><span class="main">∈</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span> <span class="main">≠</span> <span class="main">{}</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"0"</span> Quotient3_abs_rep calculation<span class="main">(</span>2<span class="main">)</span> urrel_ωrel_quot <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> Abs_σ <span class="main">(</span>ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">,</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">,</span> σ'<span class="hidden">⇩</span><sub>V</sub><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> ασ_wit_def
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_σ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command">unfolding</span></span> σset_def
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> σcondI<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> 1<span class="main">)</span>
           <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Let_def ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> CollectI σcond calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> surjective_pairing<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">only</span><span class="main"><span class="main">:</span></span> Let_def 2 ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span> <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹σcond <span class="main">(</span>ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">,</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">,</span> σ'<span class="hidden">⇩</span><sub>V</sub><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> σcond calculation<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> calculation<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> surjective_pairing<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Rep_σ_inverse prod.exhaust_sel<span class="main">)</span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">ασ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">≠</span> UNIV›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">≠</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span> <span class="main">∈</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> σcond σcond_def case_prod_unfold<span class="main">)</span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> r_notin_intersection<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="main">∉</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> r_in_union<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="main">∈</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">have</span></span> ασwit_eqI<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span> <span class="keyword2"><span class="keyword">if</span></span>
        <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_intersection</span> <span class="skolem">x</span> <span class="main">=</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_union</span> <span class="skolem">x</span> <span class="main">=</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_σ'</span> <span class="skolem">x</span> <span class="main">=</span> σσ' <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
        <span class="keyword1"><span class="command">using</span></span> that <span class="keyword1"><span class="command">unfolding</span></span> ασ_wit_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> emptyE r_in_union r_notin_intersection surjective_pairing type_definition.Rep_inverse type_definition_σ<span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?intersection_part</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?union_part</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">urrel</span> <span class="main">.</span> <span class="main">(</span>urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
                             <span class="main">(</span><span class="main">∀</span> <span class="bound">σ'</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">⟷</span> σσ' <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span> <span class="main">=</span> σσ' <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> simp0<span class="main">:</span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel
           <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> ωυ <span class="bound">x</span> <span class="main">⇒</span> <span class="skolem">r</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> συ <span class="bound">x</span> <span class="main">⇒</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">|</span> nullυ <span class="bound">null</span> <span class="main">⇒</span> False<span class="main">)</span><span class="main">)</span>
            <span class="main">=</span> <span class="skolem">r</span>›</span></span>
        <span class="keyword1"><span class="command">unfolding</span></span> urrel_to_ωrel_def
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
      <span class="keyword1"><span class="command">let</span></span> <span class="var"><span class="quoted"><span class="var">?σ_part</span></span></span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">λ</span> <span class="bound">r</span> <span class="main">.</span> Abs_urrel <span class="main">(</span><span class="main">λ</span><span class="bound">u</span> <span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> <span class="main">(</span>ωυ <span class="bound">x</span><span class="main">)</span> <span class="main">⇒</span> <span class="bound">r</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> συ <span class="bound">x</span> <span class="main">⇒</span> σσ' <span class="main">(</span>Rep_σ <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> σσ' <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">|</span> <span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> False<span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">have</span></span> σ_part_in_union<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="var">?σ_part</span> <span class="skolem">r</span> <span class="main">∈</span> <span class="var">?union_part</span>›</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> simp0 r_in_union<span class="main">)</span>
         <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> σ_part_not_in_intersection<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="var">?σ_part</span> <span class="skolem">r</span> <span class="main">∉</span> <span class="var">?intersection_part</span>›</span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> urrel_to_ωrel_def<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp r_notin_intersection<span class="main">)</span>
      <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">∪</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span> 
      <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> ασwit_eqI<span class="main">)</span>
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_intersection</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">∪</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ασ_wit_intersection_def<span class="main">)</span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>z3<span class="main"><span class="main">)</span></span> AOT_model_proposition_choice_simp Abs_urrel_inverse Quotient3_abs_rep ωrel_to_urrel_def υ.case<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> υ.simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> mem_Collect_eq urrel_ωrel_quot<span class="main">)</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword1"><span class="command">{</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">ordext</span>
          <span class="keyword3"><span class="command">assume</span></span> ordext_in_union<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">ordext</span> <span class="main">∈</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">have</span></span> ordext_simp<span class="main">:</span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel
               <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="keyword1">case</span> <span class="bound">u</span> <span class="keyword1">of</span> ωυ <span class="bound">x</span> <span class="main">⇒</span> <span class="skolem">ordext</span> <span class="bound">x</span> <span class="bound">w</span> <span class="main">|</span> συ <span class="bound">x</span> <span class="main">⇒</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">|</span> nullυ <span class="bound">null</span> <span class="main">⇒</span> False<span class="main">)</span><span class="main">)</span>
              <span class="main">=</span> <span class="skolem">ordext</span>›</span></span>
            <span class="keyword1"><span class="command">unfolding</span></span> urrel_to_ωrel_def
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
          <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">urrel</span> <span class="main">.</span> <span class="main">(</span><span class="bound">urrel</span>
          <span class="main">∈</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> ordext_intersection <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
            <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
             urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span> <span class="main">∧</span>
             <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">∧</span>
            urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="skolem">ordext</span>›</span></span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">‹<span class="var"><span class="var">?σ_part</span></span> <span class="skolem"><span class="skolem">ordext</span></span>›</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ordext_simp ordext_in_union<span class="main">)</span>
             <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
            <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
             <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
            <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
        <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 0 <span class="main">=</span> this
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_union</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">∪</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> ordext_union <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ασ_wit_union_def<span class="main">)</span>
           <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span><span class="main">∈</span>fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">.</span> <span class="bound">x</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span>›</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">next</span></span>
        <span class="keyword1"><span class="command">have</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">urrel</span> <span class="main">.</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
       <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
        urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
        <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">∧</span>
urrel_to_ωrel <span class="bound">urrel</span>
       <span class="main">∉</span> <span class="skolem">ασ_wit_intersection</span>
           <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
            <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
             urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
             <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">∧</span>
           <span class="main">(</span><span class="main">∀</span><span class="bound">w</span> <span class="bound">σ'</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">‹<span class="var"><span class="var">?σ_part</span></span> <span class="skolem"><span class="skolem">r</span></span>›</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> σ_part_in_union σ_part_not_in_intersection
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> del_insts<span class="main"><span class="main">)</span></span> AOT_model_proposition_choice_simp Abs_urrel_inverse Quotient3_abs_rep UnE UnI2 ασ_wit_intersection_def ωrel_to_urrel_def υ.simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> υ.simps<span class="main"><span class="main">(</span></span>12<span class="main"><span class="main">)</span></span> mem_Collect_eq r_notin_intersection simp0 urrel_ωrel_quot<span class="main">)</span>
        <span class="keyword1"><span class="command">{</span></span>
          <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">σ'</span>
          <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">urrel</span>
           <span class="main">∈</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
             <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
              urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
              <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">.</span>
             urrel_to_ωrel <span class="bound">urrel</span>
             <span class="main">∉</span> <span class="skolem">ασ_wit_intersection</span>
                 <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
                  <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
                   urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
                   <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">∧</span>
             <span class="main">(</span><span class="main">∀</span><span class="bound">w</span> <span class="bound">σ</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">σ'</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">urrel</span></span> <span class="keyword2"><span class="keyword">where</span></span>
              A<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">urrel</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
             <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
              urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
              <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>›</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">urrel</span>
                           <span class="main">∉</span> <span class="skolem">ασ_wit_intersection</span>
                               <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
                                <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
                                 urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
                                 <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>›</span></span>
              <span class="keyword2"><span class="keyword">and</span></span> C<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">w</span> <span class="bound">σ</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">urrel</span> <span class="main">(</span>συ <span class="bound">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">σ'</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">{</span></span>
            <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">urrel</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">urrel</span>
                           <span class="main">∈</span> <span class="skolem">ασ_wit_intersection</span>
                               <span class="main">(</span><span class="main">{</span><span class="bound">urrel</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span> <span class="main">∪</span>
                                <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
                                 urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
                                 <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span><span class="main">)</span>›</span></span>
              <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> ασ_wit_intersection_def<span class="main">)</span>
          <span class="keyword1"><span class="command">}</span></span>
          <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">urrel</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">urrel</span><span class="main">.</span>
              urrel_to_ωrel <span class="bound">urrel</span> <span class="main">∈</span> fst <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">∧</span>
              <span class="main">(</span><span class="main">∀</span><span class="bound">σ'</span> <span class="bound">w</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_urrel <span class="bound">urrel</span> <span class="main">(</span>συ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="bound">σ'</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> A B <span class="keyword1"><span class="command">by</span></span> <span class="operator">fastforce</span>
          <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in w<span class="hidden">⇩</span><sub>0</sub> <span class="main">(</span>Rep_urrel <span class="skolem">urrel</span> <span class="main">(</span>συ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">⟶</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">σ'</span>›</span></span>
            <span class="keyword1"><span class="command">using</span></span> C calculation <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">σ'</span> <span class="main">=</span> snd <span class="main">(</span>snd <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span><span class="main">)</span>›</span></span>
            <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
        <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 2 <span class="main">=</span> this
        <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit_σ'</span> <span class="main">(</span><span class="var">?intersection_part</span> <span class="main">∪</span> <span class="var">?union_part</span><span class="main">)</span> <span class="main">=</span> σσ' <span class="main">(</span>Rep_σ <span class="skolem">σ</span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ασ_wit_σ'_def<span class="main">)</span>
          <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> the_equality<span class="main">)</span>
          <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">blast</span>
          <span class="keyword1"><span class="command">using</span></span> 2 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
      <span class="keyword1"><span class="command">qed</span></span>
      <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">ασ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">}</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">urrels</span> <span class="main">.</span> <span class="skolem">ασ_wit</span> <span class="bound">urrels</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> σcond_univ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹surj <span class="skolem">ασ_wit</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> surjI <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel set›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">r</span> <span class="skolem">s</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">ασ_wit</span> <span class="skolem">b</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∀</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">⟶</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∀</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">⟶</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> ασ_wit_def Let_def
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_σ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_σset<span class="main">)</span>
       <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_σset<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">s</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">r</span> <span class="main">⟹</span> <span class="skolem">s</span> <span class="main">∈</span> <span class="skolem">a</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">s</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">r</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∀</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">⟶</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">r</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∀</span><span class="bound">urrel</span><span class="main">::</span>urrel<span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span> <span class="main">⟶</span> <span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">s</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">r</span>›</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="main">∈</span> <span class="skolem">b</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span> <span class="skolem">b</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel set›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">s</span> <span class="skolem">r</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">ασ_wit</span> <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">ασ_wit</span> <span class="skolem">b</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∃</span><span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span> <span class="main">=</span>
              <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∃</span><span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> ασ_wit_def
      <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> Abs_σ_inject<span class="main">)</span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_σset<span class="main">)</span>
       <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> wits_in_σset<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Let_def ασ_wit_intersection_def ασ_wit_union_def<span class="main">)</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="main">∈</span> <span class="skolem">a</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">s</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∃</span><span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">a</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">s</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">r</span>›</span></span>
    <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="skolem">r</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">ordext</span><span class="main">::</span>ω <span class="main">⇒</span> w <span class="main">⇒</span> bool<span class="main">.</span> <span class="main">∃</span><span class="bound">urrel</span> <span class="main">∈</span> <span class="main">(</span><span class="skolem">b</span><span class="main">::</span>urrel set<span class="main">)</span><span class="main">.</span> urrel_to_ωrel <span class="bound">urrel</span> <span class="main">=</span> <span class="bound">ordext</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"0"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">argo</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span> <span class="main">∈</span> <span class="skolem">b</span> <span class="main">∧</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">r</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem">ασ_wit</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">metis</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Restricted model version›</span></span>

<span class="keyword1"><span class="command">consts</span></span> ασ_restr <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel set <span class="main">⇒</span> σ›</span></span>

<span class="keyword1"><span class="command">specification</span></span> <span class="main">(</span><span class="quoted">ασ_restr</span><span class="main">)</span>
  ασ_restr_surj<span class="main">:</span> <span class="quoted"><span class="quoted">‹surj ασ_restr›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">φ</span></span> <span class="keyword2"><span class="keyword">where</span></span> φ_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">σ</span> <span class="bound">u</span><span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> συ <span class="bound">σ</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">‹<span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">THE</span> <span class="bound">σ</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">=</span> <span class="main">{</span> Abs_urrel <span class="main">(</span><span class="skolem">φ</span> <span class="bound">σ</span><span class="main">)</span> <span class="main">}</span>›</span></span><span class="main"><span class="main">]</span></span>
         surjI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> f<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">‹<span class="main">λ</span> <span class="bound">σ</span> <span class="main">.</span> <span class="main">{</span> Abs_urrel <span class="main">(</span><span class="skolem">φ</span> <span class="bound">σ</span><span class="main">)</span> <span class="main">}</span>›</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> συ <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span><span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> συ <span class="skolem">σ</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">σ</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">σ</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">)</span></span> υ.inject<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">φ</span> <span class="skolem">x</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">φ</span> <span class="skolem">σ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">x</span> <span class="main">=</span> <span class="skolem">σ</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">σ</span>
      <span class="keyword1"><span class="command">using</span></span> Abs_urrel_inject<span class="main">[</span><span class="operator">THEN</span> iffD1<span class="main">,</span> <span class="operator">of</span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="skolem">x</span>›</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">φ</span> <span class="skolem">σ</span>›</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> φ_def AOT_model_proposition_choice_simp<span class="main">)</span> <span class="operator">blast</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="keyword1">THE</span> <span class="bound">σ</span><span class="main">.</span> <span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">φ</span> <span class="skolem">x</span><span class="main">)</span><span class="main">}</span> <span class="main">=</span> <span class="main">{</span>Abs_urrel <span class="main">(</span><span class="skolem">φ</span> <span class="bound">σ</span><span class="main">)</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‹Shared for both models›</span></span>

<span class="keyword1"><span class="command">abbreviation</span></span> <span class="main">(</span>input<span class="main">)</span> <span class="entity">ασ</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">ασ</span> <span class="main">≡</span> ασ_ext›</span></span> <span class="comment1">― ‹Choose model kind.›</span>
<span class="keyword1"><span class="command">lemmas</span></span> ασ_surj <span class="main">=</span> ασ_ext_surj

<span class="keyword1"><span class="command">primrec</span></span> <span class="entity">κυ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹κ<span class="main">⇒</span>υ›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">κυ</span> <span class="main">(</span>ωκ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> ωυ <span class="free"><span class="bound"><span class="entity">x</span></span></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">κυ</span> <span class="main">(</span>ακ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> συ <span class="main">(</span>ασ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">κυ</span> <span class="main">(</span>nullκ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> nullυ <span class="free"><span class="bound"><span class="entity">x</span></span></span>›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> κυ_surj<span class="main">:</span> <span class="quoted"><span class="quoted">‹surj κυ›</span></span>
  <span class="keyword1"><span class="command">using</span></span> ασ_surj <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> κυ.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> κυ.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> υ.exhaust surj_def<span class="main">)</span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_null_false<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="free">w</span> <span class="main">(</span>Rep_urrel <span class="free">f</span> <span class="main">(</span>κυ <span class="free">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>is_nullκ <span class="free">x</span>›</span></span>
   <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> assms Rep_urrel κ.collapse<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> κυ.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> mem_Collect_eq<span class="main">)</span>


<span class="keyword1"><span class="command">class</span></span> AOT_Term <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_denotes</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_denoting_ex<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">AOT_model_denotes</span> <span class="bound">x</span>›</span></span>
<span class="keyword1"><span class="command">class</span></span> AOT_IncompleteTerm <span class="main">=</span> AOT_Term <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_nondenoting_ex<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">¬</span>AOT_model_denotes <span class="bound">x</span>›</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> prod <span class="main">::</span> <span class="main">(</span><span class="quoted">AOT_Term</span><span class="main">,</span> <span class="quoted">AOT_Term</span><span class="main">)</span> <span class="quoted">AOT_Term</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_denotes_prod</span> <span class="main">≡</span> <span class="main">λ</span><span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">∧</span> AOT_model_denotes <span class="bound">y</span>›</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span><span class="main">.</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_prod_def AOT_model_denoting_ex<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">locale</span></span> AOT_model_irregular_spec <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">AOT_model_irregular</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> 𝗈›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">AOT_model_regular</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free">AOT_model_term_equiv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_irregular_false<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_valid_in <span class="free">w</span> <span class="main">(</span><span class="free">AOT_model_irregular</span> <span class="free">φ</span> <span class="free">x</span><span class="main">)</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> AOT_model_irregular_equiv<span class="main">:</span>
      <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_term_equiv</span> <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">AOT_model_irregular</span> <span class="free">φ</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_irregular</span> <span class="free">φ</span> <span class="free">y</span>›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> AOT_model_irregular_eqI<span class="main">:</span>
      <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋀</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">AOT_model_regular</span> <span class="bound">x</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">ψ</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">AOT_model_irregular</span> <span class="free">φ</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_irregular</span> <span class="free">ψ</span> <span class="free">x</span>›</span></span>

<span class="keyword1"><span class="command">class</span></span> AOT_IndividualTerm <span class="main">=</span> AOT_IncompleteTerm <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_regular</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_term_equiv</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_irregular</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> 𝗈›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_irregular_nondenoting<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span><span class="free">AOT_model_regular</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">¬</span>AOT_model_denotes <span class="free">x</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_term_equiv_part_equivp<span class="main">:</span> <span class="quoted"><span class="quoted">‹equivp <span class="free">AOT_model_term_equiv</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_term_equiv_denotes<span class="main">:</span>
    <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_term_equiv</span> <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="main">(</span>AOT_model_denotes <span class="free">x</span> <span class="main">=</span> AOT_model_denotes <span class="free">y</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_term_equiv_regular<span class="main">:</span>
    <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_term_equiv</span> <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="main">(</span><span class="free">AOT_model_regular</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_regular</span> <span class="free">y</span><span class="main">)</span>›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_irregular<span class="main">:</span>
    <span class="quoted"><span class="quoted">‹AOT_model_irregular_spec <span class="free">AOT_model_irregular</span> <span class="free">AOT_model_regular</span> <span class="free">AOT_model_term_equiv</span>›</span></span>

<span class="keyword1"><span class="command">interpretation</span></span> AOT_model_irregular_spec <span class="quoted">AOT_model_irregular</span> <span class="quoted">AOT_model_regular</span> <span class="quoted">AOT_model_term_equiv</span>
  <span class="keyword1"><span class="command">using</span></span> AOT_model_irregular <span class="keyword1"><span class="command">.</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_term_equiv_eps<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"AOT_model_term_equiv <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">κ</span><span class="main">)</span><span class="main">)</span> <span class="free">κ</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"AOT_model_term_equiv <span class="free">κ</span> <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">κ</span><span class="main">)</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"AOT_model_term_equiv <span class="free">κ</span> <span class="free">κ'</span> <span class="main">⟹</span> <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">κ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>Eps <span class="main">(</span>AOT_model_term_equiv <span class="free">κ'</span><span class="main">)</span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_part_equivp equivp_def someI_ex<span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_part_equivp equivp_def someI_ex<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_part_equivp equivp_def<span class="main">)</span>


<span class="keyword1"><span class="command">typedef</span></span> <span class="tfree">'a</span> rel <span class="main">(</span><span class="quoted">‹<span class="keyword1">&lt;</span>_<span class="keyword1">&gt;</span>›</span><span class="main">)</span> <span class="main">=</span> <span class="quoted"><span class="quoted">‹UNIV<span class="main">::</span><span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm <span class="main">⇒</span> 𝗈<span class="main">)</span> set›</span></span> <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">setup_lifting</span></span> type_definition_rel

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">fix_special</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'a</span> <span class="main">⇒</span> 𝗈<span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">fix_special</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">φ</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">if</span> AOT_model_regular <span class="bound">x</span> <span class="keyword1">then</span> <span class="bound">φ</span> <span class="bound">x</span> <span class="keyword1">else</span> AOT_model_irregular <span class="bound">φ</span> <span class="bound">x</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> fix_special_denoting<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="free">x</span> <span class="main">⟹</span> fix_special <span class="free">φ</span> <span class="free">x</span> <span class="main">=</span> <span class="free">φ</span> <span class="free">x</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_nondenoting fix_special_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> fix_special_non_special<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_regular <span class="free">x</span> <span class="main">⟹</span> fix_special <span class="free">φ</span> <span class="free">x</span> <span class="main">=</span> <span class="free">φ</span> <span class="free">x</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_nondenoting fix_special_def<span class="main">)</span>
<span class="keyword1"><span class="command">lemma</span></span> fix_special_special<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_regular <span class="free">x</span> <span class="main">⟹</span> fix_special <span class="free">φ</span> <span class="free">x</span> <span class="main">=</span> AOT_model_irregular <span class="free">φ</span> <span class="free">x</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fix_special_def<span class="main">)</span>

<span class="keyword1"><span class="command">instantiation</span></span> rel <span class="main">::</span> <span class="main">(</span><span class="quoted">AOT_IndividualTerm</span><span class="main">)</span> <span class="quoted">AOT_IncompleteTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">lift_definition</span></span> <span class="class_parameter">AOT_model_denotes_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">is</span></span>
  <span class="quoted"><span class="quoted">‹<span class="main">λ</span> <span class="bound">φ</span> <span class="main">.</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="bound">φ</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">φ</span> <span class="bound">y</span><span class="main">)</span> <span class="main">∧</span>
         <span class="main">(</span><span class="main">∀</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">φ</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> AOT_model_denotes <span class="bound">x</span><span class="main">)</span> <span class="main">∧</span>
         <span class="main">(</span><span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">¬</span>AOT_model_regular <span class="bound">x</span> <span class="main">⟶</span> <span class="bound">φ</span> <span class="bound">x</span> <span class="main">=</span> AOT_model_irregular <span class="bound">φ</span> <span class="bound">x</span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_term_equiv_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">⇒</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_term_equiv_rel</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">f</span> <span class="bound">g</span> <span class="main">.</span> AOT_model_denotes <span class="bound">f</span> <span class="main">∧</span> AOT_model_denotes <span class="bound">g</span> <span class="main">∧</span> <span class="bound">f</span> <span class="main">=</span> <span class="bound">g</span>›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_regular_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_regular_rel</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">r</span> <span class="main">.</span> True›</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="main">(</span>fix_special <span class="skolem">φ</span><span class="main">)</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">φ</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">φ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AOT_model_irregular_eqI<span class="main">)</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> fix_special_def<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span> <span class="main">::</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted">‹Abs_rel <span class="main">(</span>fix_special <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> False<span class="main">)</span><span class="main">)</span>›</span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">transfer</span><span class="main">)</span>
       <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp fix_special_def AOT_model_irregular_equiv
                    AOT_model_term_equiv_regular AOT_model_irregular_false<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span> <span class="main">::</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">.</span> <span class="main">¬</span>AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">‹Abs_rel <span class="main"><span class="main"><span class="main">(</span></span></span><span class="main"><span class="main"><span class="main">λ</span></span></span><span class="bound"><span class="bound"><span class="bound">x</span></span></span><span class="main"><span class="main"><span class="main">.</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span></span></span> <span class="bound"><span class="bound"><span class="bound">w</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> True<span class="main"><span class="main"><span class="main">)</span></span></span>›</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main"><span class="keyword3">;</span></span>
        <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_rel.abs_eq AOT_model_nondenoting_ex AOT_model_proposition_choice_simp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_denotes_Abs_rel_fix_specialI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟹</span> <span class="free">φ</span> <span class="bound">x</span> <span class="main">=</span> <span class="free">φ</span> <span class="bound">y</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="free">φ</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟹</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="main">(</span>Abs_rel <span class="main">(</span>fix_special <span class="free">φ</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span> AOT_model_regular <span class="skolem">x</span> <span class="main">⟹</span>
         AOT_model_irregular <span class="free">φ</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="keyword1">if</span> AOT_model_regular <span class="bound">x</span> <span class="keyword1">then</span> <span class="free">φ</span> <span class="bound">x</span> <span class="keyword1">else</span> AOT_model_irregular <span class="free">φ</span> <span class="bound">x</span><span class="main">)</span> <span class="skolem">x</span>›</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AOT_model_irregular_eqI<span class="main">)</span> <span class="operator">auto</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_denotes_rel.rep_eq
  <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_false Abs_rel_inverse AOT_model_irregular_equiv fix_special_def AOT_model_term_equiv_regular<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_term_equiv_rel_equiv<span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="free">x</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="free">y</span>›</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">Π</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π</span> <span class="main">⟶</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Π</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Π</span> <span class="free">y</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span>›</span></span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">Π</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π</span> <span class="main">⟶</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Π</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Π</span> <span class="free">y</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_rel.rep_eq<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x'</span> <span class="skolem">y'</span> <span class="main">⟹</span> <span class="main">(</span>AOT_model_denotes <span class="skolem">x'</span> <span class="main">∧</span> AOT_model_term_equiv <span class="skolem">x'</span> <span class="free">y</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span>AOT_model_denotes <span class="skolem">y'</span> <span class="main">∧</span> AOT_model_term_equiv <span class="skolem">y'</span> <span class="free">y</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x'</span> <span class="skolem">y'</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_term_equiv_denotes AOT_model_term_equiv_part_equivp equivp_def<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span> <span class="bound">Π</span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π</span> <span class="main">⟶</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Π</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span>Rep_rel <span class="bound">Π</span> <span class="free">y</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="main">(</span>Abs_rel <span class="main">(</span>fix_special <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">∧</span> AOT_model_term_equiv <span class="bound">x</span> <span class="free">y</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>"</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">is</span></span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="var">?r</span>"</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> AOT_model_denotes_Abs_rel_fix_specialI<span class="main">)</span>
       <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> 0 AOT_model_denotes_rel.rep_eq Abs_rel_inverse fix_special_def
                   AOT_model_proposition_choice_simp AOT_model_irregular_false<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="var">?r</span> <span class="free">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="var">?r</span> <span class="free">y</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Abs_rel_inverse AOT_model_proposition_choice_simp fix_special_denoting<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main"><span class="main">(</span></span></span>1<span class="main"><span class="main"><span class="main">)</span></span></span><span class="main"><span class="main">]</span></span> fix_special_denoting<span class="main"><span class="main">[</span></span><span class="operator">OF</span> assms<span class="main"><span class="main"><span class="main">(</span></span></span>2<span class="main"><span class="main"><span class="main">)</span></span></span><span class="main"><span class="main">]</span></span> assms AOT_model_term_equiv_part_equivp equivp_reflp<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">class</span></span> AOT_UnaryIndividualTerm <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free"><span class="free"><span class="free">AOT_model_enc</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span> <span class="main">⇒</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm<span class="main">&gt;</span> <span class="main">⇒</span> bool›</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="free"><span class="free"><span class="free">AOT_model_concrete</span></span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹w <span class="main">⇒</span> <span class="tfree">'a</span> <span class="main">⇒</span> bool›</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> AOT_model_no_special_nondenoting<span class="main">:</span>
      <span class="quoted"><span class="quoted">‹AOT_model_regular <span class="free">x</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_enc_relid<span class="main">:</span>
        <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="free">F</span> <span class="main">⟹</span>
         AOT_model_denotes <span class="free">G</span> <span class="main">⟹</span>
         <span class="main">(</span><span class="main">⋀</span> <span class="bound">x</span> <span class="main">.</span> <span class="free">AOT_model_enc</span> <span class="bound">x</span> <span class="free">F</span> <span class="main">⟷</span> <span class="free">AOT_model_enc</span> <span class="bound">x</span> <span class="free">G</span><span class="main">)</span>
         <span class="main">⟹</span> <span class="free">F</span> <span class="main">=</span> <span class="free">G</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_A_objects<span class="main">:</span>
        <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">∧</span>
              <span class="main">(</span><span class="main">∀</span><span class="bound">w</span><span class="main">.</span> <span class="main">¬</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∧</span>
              <span class="main">(</span><span class="main">∀</span><span class="bound">F</span><span class="main">.</span> AOT_model_denotes <span class="bound">F</span> <span class="main">⟶</span> <span class="free">AOT_model_enc</span> <span class="bound">x</span> <span class="bound">F</span> <span class="main">=</span> <span class="free">φ</span> <span class="bound">F</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_contingent<span class="main">:</span>
        <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">∧</span> <span class="main">¬</span> <span class="free">AOT_model_concrete</span> w<span class="hidden">⇩</span><sub>0</sub> <span class="bound">x</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_nocoder<span class="main">:</span>
        <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">x</span> <span class="main">⟹</span> <span class="main">¬</span><span class="free">AOT_model_enc</span> <span class="free">x</span> <span class="free">F</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_concrete_equiv<span class="main">:</span>
        <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="free">x</span> <span class="free">y</span> <span class="main">⟹</span> <span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">x</span> <span class="main">=</span> <span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">y</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_concrete_denotes<span class="main">:</span>
        <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_concrete</span> <span class="free">w</span> <span class="free">x</span> <span class="main">⟹</span> AOT_model_denotes <span class="free">x</span>›</span></span>
<span class="comment1">(* only extended models *)</span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_enc_indistinguishable_all<span class="main">:</span>
       <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="free">a</span> <span class="main">⟹</span> <span class="main">¬</span><span class="main">(</span><span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">a</span><span class="main">)</span> <span class="main">⟹</span>
        AOT_model_denotes <span class="free">b</span> <span class="main">⟹</span> <span class="main">¬</span><span class="main">(</span><span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">b</span><span class="main">)</span> <span class="main">⟹</span>
        AOT_model_denotes <span class="free">Π</span> <span class="main">⟹</span>
        <span class="main">(</span><span class="main">⋀</span> <span class="bound">Π'</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
        <span class="main">(</span><span class="main">⋀</span> <span class="bound">Π'</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">⟹</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Π</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">AOT_model_enc</span> <span class="free">a</span> <span class="bound">Π'</span><span class="main">)</span> <span class="main">⟹</span>
        <span class="main">(</span><span class="main">⋀</span> <span class="bound">Π'</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span> <span class="main">⟹</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Π</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span> <span class="free">AOT_model_enc</span> <span class="free">b</span> <span class="bound">Π'</span><span class="main">)</span>›</span></span>
      <span class="keyword2"><span class="keyword">and</span></span> AOT_model_enc_indistinguishable_ex<span class="main">:</span>
       <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="free">a</span> <span class="main">⟹</span> <span class="main">¬</span><span class="main">(</span><span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">a</span><span class="main">)</span> <span class="main">⟹</span>
        AOT_model_denotes <span class="free">b</span> <span class="main">⟹</span> <span class="main">¬</span><span class="main">(</span><span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="free">b</span><span class="main">)</span> <span class="main">⟹</span>
        AOT_model_denotes <span class="free">Π</span> <span class="main">⟹</span>
        <span class="main">(</span><span class="main">⋀</span> <span class="bound">Π'</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">⟹</span> <span class="main">(</span><span class="main">⋀</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="free">a</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="free">b</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
        <span class="main">(</span><span class="main">∃</span> <span class="bound">Π'</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">∧</span> <span class="free">AOT_model_enc</span> <span class="free">a</span> <span class="bound">Π'</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Π</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
        <span class="main">(</span><span class="main">∃</span> <span class="bound">Π'</span> <span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">∧</span> <span class="free">AOT_model_enc</span> <span class="free">b</span> <span class="bound">Π'</span> <span class="main">∧</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">v</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">(</span><span class="main">∃</span> <span class="bound">w</span> <span class="main">.</span> <span class="free">AOT_model_concrete</span> <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="free">Π</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">instantiation</span></span> κ <span class="main">::</span> <span class="quoted">AOT_IndividualTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_term_equiv_κ</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹κ <span class="main">⇒</span> κ <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_term_equiv_κ</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> κυ <span class="bound">y</span>›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_κ</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹κ <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_denotes_κ</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> <span class="main">¬</span>is_nullκ <span class="bound">x</span>›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_regular_κ</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹κ <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_regular_κ</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> True›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_irregular_κ</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>κ <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> κ <span class="main">⇒</span> 𝗈›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_irregular_κ</span> <span class="main">≡</span> <span class="keyword1">SOME</span> <span class="bound">φ</span> <span class="main">.</span> AOT_model_irregular_spec <span class="bound">φ</span> AOT_model_regular AOT_model_term_equiv›</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span> <span class="main">::</span> κ<span class="main">.</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">‹ωκ undefined›</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
       <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_κ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span> <span class="main">::</span> κ<span class="main">.</span> <span class="main">¬</span>AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">‹nullκ undefined›</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
       <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_κ_def AOT_model_regular_κ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>AOT_model_regular <span class="skolem">x</span> <span class="main">⟹</span> <span class="main">¬</span> AOT_model_denotes <span class="skolem">x</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">κ</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_κ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹equivp <span class="main">(</span>AOT_model_term_equiv <span class="main">::</span> κ <span class="main">⇒</span> κ <span class="main">⇒</span> bool<span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equivpI<span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span> reflpI exI sympI transpI<span class="main">)</span>
       <span class="main">(</span><span class="operator">simp_all</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_κ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">⟹</span> AOT_model_denotes <span class="skolem">x</span> <span class="main">=</span> AOT_model_denotes <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted">κ</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_denotes_κ_def AOT_model_term_equiv_κ_def κ.exhaust_disc κυ.simps
              υ.disc<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> υ.disc<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> υ.disc<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span> υ.disc<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span> is_ακ_def is_ωκ_def is_nullκ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">⟹</span> AOT_model_regular <span class="skolem">x</span> <span class="main">=</span> AOT_model_regular <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted">κ</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_κ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">"AOT_model_irregular_spec <span class="main">(</span><span class="main">λ</span> <span class="bound">φ</span> <span class="main">(</span><span class="bound">x</span> <span class="main">::</span> κ<span class="main">)</span> <span class="main">.</span>  <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> False<span class="main">)</span> AOT_model_regular AOT_model_term_equiv"</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">standard</span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_proposition_choice_simp<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular_spec <span class="main">(</span>AOT_model_irregular<span class="main">::</span><span class="main">(</span>κ<span class="main">⇒</span>𝗈<span class="main">)</span> <span class="main">⇒</span> κ <span class="main">⇒</span> 𝗈<span class="main">)</span> AOT_model_regular AOT_model_term_equiv›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_irregular_κ_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> someI_ex<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">definition</span></span> <span class="entity">rel_to_urrel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span>κ<span class="main">&gt;</span> <span class="main">⇒</span> urrel›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">rel_to_urrel</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">Π</span> <span class="main">.</span> Abs_urrel <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="main">.</span> Rep_rel <span class="bound">Π</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span> <span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">urrel_to_rel</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹urrel <span class="main">⇒</span> <span class="main">&lt;</span>κ<span class="main">&gt;</span>›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">urrel_to_rel</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">φ</span> <span class="main">.</span> Abs_rel <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="main">.</span> Rep_urrel <span class="bound">φ</span> <span class="main">(</span>κυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_rel_equiv</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span><span class="tfree">'a</span><span class="main">::</span>AOT_IndividualTerm<span class="main">&gt;</span> <span class="main">⇒</span> <span class="main">&lt;</span><span class="tfree">'a</span><span class="main">&gt;</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">"<span class="free">AOT_rel_equiv</span> <span class="main">≡</span> <span class="main">(</span><span class="main">λ</span> <span class="bound">x</span> <span class="bound">y</span> <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">∧</span> AOT_model_denotes <span class="bound">y</span> <span class="main">∧</span> <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_quotient3<span class="main">:</span> <span class="quoted"><span class="quoted">‹Quotient3 AOT_rel_equiv rel_to_urrel urrel_to_rel›</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> Quotient3I<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> Rep_urrel <span class="skolem">a</span> <span class="main">(</span>κυ <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> Rep_urrel <span class="skolem">a</span> <span class="bound">u</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> ext<span class="main">)</span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> κυ_surj surj_f_inv_f verit_sko_ex'<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹rel_to_urrel <span class="main">(</span>urrel_to_rel <span class="skolem">a</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">a</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> Abs_rel_inverse rel_to_urrel_def urrel_to_rel_def Rep_urrel_inverse<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_rel_equiv <span class="main">(</span>urrel_to_rel <span class="skolem">a</span><span class="main">)</span> <span class="main">(</span>urrel_to_rel <span class="skolem">a</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">a</span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_rel_equiv_def urrel_to_rel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_κ_def AOT_model_denotes_κ_def
                           AOT_model_term_equiv_κ_def urrel_null_false<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">a</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">w</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="skolem">a</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> <span class="main">¬</span> is_nullκ <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">a</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">φ</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="main">¬</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">φ</span> <span class="main">(</span>nullυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span><span class="main"><span class="keyword3">;</span></span> <span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> κ.exhaust_disc κυ.simps υ.disc<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> υ.disc<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> υ.disc<span class="main"><span class="main">(</span></span>5<span class="main"><span class="main">)</span></span>
                                           υ.disc<span class="main"><span class="main">(</span></span>6<span class="main"><span class="main">)</span></span> is_ακ_def is_ωκ_def someI_ex<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 1 <span class="main">=</span> this
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">r</span> <span class="skolem">s</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹κ <span class="main">⇒</span> 𝗈›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> A<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">r</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">r</span> <span class="bound">y</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">w</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="skolem">r</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 2<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">r</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">φ</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="main">¬</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">φ</span> <span class="main">(</span>nullυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 AOT_model_denotes_κ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>
    <span class="keyword3"><span class="command">assume</span></span> B<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟶</span> <span class="skolem">s</span> <span class="bound">x</span> <span class="main">=</span> <span class="skolem">s</span> <span class="bound">y</span>›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">w</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="skolem">s</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 3<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">s</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">∈</span> <span class="main">{</span><span class="bound">φ</span><span class="main">.</span> <span class="main">∀</span><span class="bound">x</span> <span class="bound">w</span><span class="main">.</span> <span class="main">¬</span> AOT_model_valid_in <span class="bound">w</span> <span class="main">(</span><span class="bound">φ</span> <span class="main">(</span>nullυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">}</span>›</span></span>
      <span class="keyword1"><span class="command">using</span></span> 1 AOT_model_denotes_κ_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">meson</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹Abs_urrel <span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">r</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> Abs_urrel <span class="main">(</span><span class="main">λ</span><span class="bound">u</span><span class="main">.</span> <span class="skolem">s</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="bound">u</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">hence</span></span> 4<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="skolem">u</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">s</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x</span><span class="main">::</span>κ<span class="main">.</span> κυ <span class="bound">x</span> <span class="main">=</span> <span class="skolem">u</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">u</span>
      <span class="keyword1"><span class="command">unfolding</span></span> Abs_urrel_inject<span class="main">[</span><span class="operator">OF</span> 2 3<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">metis</span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">s</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
      <span class="keyword1"><span class="command">using</span></span> 4<span class="main">[</span><span class="operator">of</span> <span class="quoted"><span class="quoted">‹κυ <span class="skolem">x</span>›</span></span><span class="main">]</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> A B AOT_model_term_equiv_κ_def someI_ex<span class="main">)</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">r</span> <span class="main">=</span> <span class="skolem">s</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span> 
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹AOT_rel_equiv <span class="skolem">r</span> <span class="skolem">s</span> <span class="main">=</span> <span class="main">(</span>AOT_rel_equiv <span class="skolem">r</span> <span class="skolem">r</span> <span class="main">∧</span> AOT_rel_equiv <span class="skolem">s</span> <span class="skolem">s</span> <span class="main">∧</span> rel_to_urrel <span class="skolem">r</span> <span class="main">=</span> rel_to_urrel <span class="skolem">s</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span> <span class="skolem">s</span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_rel_equiv_def rel_to_urrel_def
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">transfer</span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">lemma</span></span> urrel_quotient<span class="main">:</span> <span class="quoted"><span class="quoted">‹Quotient AOT_rel_equiv rel_to_urrel urrel_to_rel <span class="main">(</span><span class="main">λ</span><span class="bound">x</span> <span class="bound">y</span><span class="main">.</span> AOT_rel_equiv <span class="bound">x</span> <span class="bound">x</span> <span class="main">∧</span> rel_to_urrel <span class="bound">x</span> <span class="main">=</span> <span class="bound">y</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> Quotient3_to_Quotient<span class="main">[</span><span class="operator">OF</span> urrel_quotient3<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>

<span class="keyword1"><span class="command">instantiation</span></span> κ <span class="main">::</span> <span class="quoted">AOT_UnaryIndividualTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>                          

<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_enc_κ</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹κ <span class="main">⇒</span> <span class="main">&lt;</span>κ<span class="main">&gt;</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_enc_κ</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">x</span> <span class="bound">F</span> <span class="main">.</span> <span class="keyword1">case</span> <span class="bound">x</span> <span class="keyword1">of</span> ακ <span class="bound">a</span> <span class="main">⇒</span> AOT_model_denotes <span class="bound">F</span> <span class="main">∧</span> rel_to_urrel <span class="bound">F</span> <span class="main">∈</span> <span class="bound">a</span> <span class="main">|</span> <span class="main"><span class="bound">_</span></span> <span class="main">⇒</span> False›</span></span>
<span class="keyword1"><span class="command">primrec</span></span> <span class="entity"><span class="class_parameter">AOT_model_concrete_κ</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹w <span class="main">⇒</span> κ <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_concrete_κ</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="main">(</span>ωκ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> AOT_model_concreteω <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="free"><span class="bound"><span class="entity">w</span></span></span>›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_concrete_κ</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="main">(</span>ακ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> False›</span></span>
<span class="main">|</span> <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_concrete_κ</span> <span class="free"><span class="bound"><span class="entity">w</span></span></span> <span class="main">(</span>nullκ <span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">)</span> <span class="main">=</span> False›</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_meta_A_objects_κ<span class="main">:</span>
  <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span> <span class="main">::</span> κ<span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">∧</span>
            <span class="main">(</span><span class="main">∀</span><span class="bound">w</span><span class="main">.</span> <span class="main">¬</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∧</span>
            <span class="main">(</span><span class="main">∀</span><span class="bound">F</span><span class="main">.</span> AOT_model_denotes <span class="bound">F</span> <span class="main">⟶</span> AOT_model_enc <span class="bound">x</span> <span class="bound">F</span> <span class="main">=</span> <span class="free">φ</span> <span class="bound">F</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="free">φ</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">‹ακ <span class="main"><span class="main">{</span></span><span class="bound"><span class="bound">f</span></span> <span class="main"><span class="main">.</span></span> <span class="free"><span class="free">φ</span></span> <span class="main"><span class="main">(</span></span>urrel_to_rel <span class="bound"><span class="bound">f</span></span><span class="main"><span class="main">)</span></span><span class="main"><span class="main">}</span></span>›</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_enc_κ_def AOT_model_denotes_κ_def<span class="main">)</span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>no_types<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Quotient_rep_abs_fold_unmap urrel_quotient<span class="main">)</span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_regular <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">κ</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_regular_κ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">F</span> <span class="skolem">G</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span>κ<span class="main">&gt;</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">F</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">G</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">x</span><span class="main">.</span> AOT_model_enc <span class="bound">x</span> <span class="skolem">F</span> <span class="main">=</span> AOT_model_enc <span class="bound">x</span> <span class="skolem">G</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∀</span><span class="bound">G</span><span class="main">.</span> AOT_model_denotes <span class="bound">G</span> <span class="main">⟶</span> AOT_model_enc <span class="skolem">x</span> <span class="bound">G</span> <span class="main">=</span> <span class="main">(</span><span class="skolem">F</span> <span class="main">=</span> <span class="bound">G</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> AOT_meta_A_objects_κ <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="skolem">F</span> <span class="main">=</span> <span class="skolem">G</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span> <span class="main">::</span> κ<span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">∧</span>
                 <span class="main">(</span><span class="main">∀</span><span class="bound">w</span><span class="main">.</span> <span class="main">¬</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">∧</span>
                 <span class="main">(</span><span class="main">∀</span><span class="bound">F</span><span class="main">.</span> AOT_model_denotes <span class="bound">F</span> <span class="main">⟶</span> AOT_model_enc <span class="bound">x</span> <span class="bound">F</span> <span class="main">=</span> <span class="skolem">φ</span> <span class="bound">F</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">φ</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_meta_A_objects_κ <span class="keyword1"><span class="command">.</span></span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span>κ<span class="main">)</span> <span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span> <span class="main">∧</span> <span class="main">¬</span> AOT_model_concrete w<span class="hidden">⇩</span><sub>0</sub> <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_concrete_κ.simps<span class="main">(</span>1<span class="main">)</span> AOT_model_contingent_object <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_concrete <span class="skolem">w</span> <span class="skolem">x</span> <span class="main">⟹</span> <span class="main">¬</span> AOT_model_enc <span class="skolem">x</span> <span class="skolem">F</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">κ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">F</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_enc_κ_def κ.case_eq_if κ.collapse<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">⟹</span> AOT_model_concrete <span class="skolem">w</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_concrete <span class="skolem">w</span> <span class="skolem">y</span>›</span></span>
    <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted">κ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">w</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">induct</span> <span class="quoted"><span class="skolem">y</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_κ_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_concrete <span class="skolem">w</span> <span class="skolem">x</span> <span class="main">⟹</span> AOT_model_denotes <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted">κ</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> AOT_model_denotes_κ_def κ.collapse<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span><span class="main">)</span>
<span class="comment1">(* Extended models only *)</span>
<span class="comment1">(* TODO: brush up proof *)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">κ</span> <span class="skolem">κ'</span> <span class="main">::</span> <span class="quoted">κ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">Π</span> <span class="skolem">Π'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span>κ<span class="main">&gt;</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">w</span> <span class="main">::</span> <span class="quoted">w</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">κ</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">κ</span>›</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹ακ <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">κ</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_ω_concrete_in_some_world AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_κ_def κ.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> κ.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">κ'</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">κ'</span>›</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> b_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹ακ <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">κ'</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_ω_concrete_in_some_world AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_κ_def κ.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> κ.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π'</span> <span class="main">⟹</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="skolem">κ</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="skolem">κ'</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Π'</span> <span class="skolem">w</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>κυ <span class="skolem">κ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>κυ <span class="skolem">κ'</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_rel_rep iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1">let</span> <span class="bound">r</span> <span class="main">=</span> <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> κυ <span class="skolem">κ</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">in</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>κυ <span class="skolem">κ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>κυ <span class="skolem">κ'</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">hence</span></span> ασ_eq<span class="main">:</span> <span class="quoted"><span class="quoted">‹ασ <span class="skolem">a</span> <span class="main">=</span> ασ <span class="skolem">b</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Let_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">(</span></span>1 2<span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_proposition_choice_simp a_def b_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">assume</span></span> Π_den<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">r</span> <span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="bound">r</span> <span class="main">(</span>ωυ <span class="bound">x</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">‹rel_to_urrel <span class="skolem"><span class="skolem">Π</span></span>›</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">unfolding</span></span> rel_to_urrel_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_κ_def AOT_model_denotes_rel.rep_eq κ.exhaust_disc κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> κυ.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> κυ.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π</span>›</span></span> υ.disc<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span> υ.disc<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span> υ.distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> is_ακ_def is_ωκ_def verit_sko_ex'<span class="main">)</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_rel.rep_eq AOT_model_term_equiv_κ_def κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Π_den verit_sko_ex'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> r_prop<span class="main">:</span> <span class="quoted"><span class="quoted">‹Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ωυ <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π'</span> <span class="main">⟹</span>
              <span class="main">(</span><span class="main">⋀</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> <span class="main">∃</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span> <span class="main">⟹</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
              AOT_model_enc <span class="skolem">κ</span> <span class="skolem">Π'</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Π'</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π'</span> <span class="main">⟹</span>
              <span class="main">(</span><span class="main">⋀</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="main">(</span>ωκ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
              AOT_model_enc <span class="skolem">κ</span> <span class="skolem">Π'</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Π'</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> κ.exhaust_disc is_ακ_def is_ωκ_def is_nullκ_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋀</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ωυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
              <span class="skolem">r</span> <span class="main">∈</span> <span class="skolem">a</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span>
    <span class="keyword1"><span class="command">unfolding</span></span> a_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> AOT_model_enc_κ_def <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> best<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">⋀</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r'</span> <span class="main">(</span>ωυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ωυ <span class="bound">x</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="main">⟹</span>
              <span class="skolem">r'</span> <span class="main">∈</span> <span class="skolem">a</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r'</span>
    <span class="keyword1"><span class="command">unfolding</span></span> r_prop<span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">s</span><span class="main">.</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">r</span> <span class="main">⟹</span> <span class="bound">s</span> <span class="main">∈</span> <span class="skolem">a</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> urrel_to_ωrel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">s</span><span class="main">.</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">r</span> <span class="main">⟹</span> <span class="bound">s</span> <span class="main">∈</span> <span class="skolem">b</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> ασ_eq_ord_exts_all<span class="main">[</span><span class="operator">OF</span> ασ_eq<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword3"><span class="command">assume</span></span> Π'_den<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π'</span>›</span></span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span> <span class="main">⟹</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="main">(</span>ωκ <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_ω_concrete_in_some_world AOT_model_concrete_κ.simps<span class="main">(</span>1<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="main">(</span>rel_to_urrel <span class="skolem">Π'</span><span class="main">)</span> <span class="main">(</span>ωυ <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ωυ <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> best<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def Π'_den κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I r_prop urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="main">(</span>rel_to_urrel <span class="skolem">Π'</span><span class="main">)</span> <span class="main">=</span> urrel_to_ωrel <span class="skolem">r</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>full_types<span class="main"><span class="main">)</span></span> AOT_urrel_ωequiv_def Quotient3_def urrel_ωrel_quot<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹rel_to_urrel <span class="skolem">Π'</span> <span class="main">∈</span> <span class="skolem">b</span>›</span></span> <span class="keyword1"><span class="command">using</span></span> 0 <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹AOT_model_enc <span class="skolem">κ'</span> <span class="skolem">Π'</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> b_def<span class="main">[</span><span class="operator">symmetric</span><span class="main">]</span> AOT_model_enc_κ_def <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> Π'_den<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">κ</span> <span class="skolem">κ'</span> <span class="main">::</span> <span class="quoted">κ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">Π</span> <span class="skolem">Π'</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">&lt;</span>κ<span class="main">&gt;</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">w</span> <span class="main">::</span> <span class="quoted">w</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">κ</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">κ</span>›</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">a</span></span> <span class="keyword2"><span class="keyword">where</span></span> a_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹ακ <span class="skolem">a</span> <span class="main">=</span> <span class="skolem">κ</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_ω_concrete_in_some_world AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_κ_def κ.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> κ.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">κ'</span>›</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∄</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">κ'</span>›</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">b</span></span> <span class="keyword2"><span class="keyword">where</span></span> b_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹ακ <span class="skolem">b</span> <span class="main">=</span> <span class="skolem">κ'</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_ω_concrete_in_some_world AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> AOT_model_denotes_κ_def κ.discI<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> κ.exhaust_sel<span class="main">)</span>
  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π'</span> <span class="main">⟹</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="skolem">κ</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="skolem">κ'</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">Π'</span> <span class="skolem">w</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>κυ <span class="skolem">κ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="skolem">r</span> <span class="main">(</span>κυ <span class="skolem">κ'</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">r</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_rel_rep iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="keyword1">let</span> <span class="bound">r</span> <span class="main">=</span> <span class="main">(</span>Abs_urrel <span class="main">(</span><span class="main">λ</span> <span class="bound">u</span> <span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> <span class="bound">u</span> <span class="main">=</span> κυ <span class="skolem">κ</span><span class="main">)</span><span class="main">)</span> <span class="keyword1">in</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>κυ <span class="skolem">κ</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>Rep_urrel <span class="bound">r</span> <span class="main">(</span>κυ <span class="skolem">κ'</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
  <span class="keyword1"><span class="command">hence</span></span> ασ_eq<span class="main">:</span> <span class="quoted"><span class="quoted">‹ασ <span class="skolem">a</span> <span class="main">=</span> ασ <span class="skolem">b</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> Let_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> <span class="main"><span class="main">(</span></span><span class="quasi_keyword">asm</span><span class="main"><span class="main">)</span></span> <span class="main"><span class="main">(</span></span>1 2<span class="main"><span class="main">)</span></span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command">using</span></span> AOT_model_proposition_choice_simp a_def b_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">force</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword3"><span class="command">assume</span></span> Π_den<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π</span>›</span></span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">r</span> <span class="main">.</span> <span class="main">∀</span> <span class="bound">x</span> <span class="main">.</span> Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="bound">r</span> <span class="main">(</span>ωυ <span class="bound">x</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted">‹rel_to_urrel <span class="skolem"><span class="skolem">Π</span></span>›</span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
    <span class="keyword1"><span class="command">unfolding</span></span> rel_to_urrel_def
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">subst</span> Abs_urrel_inverse<span class="main">)</span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">auto</span>
     <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_κ_def AOT_model_denotes_rel.rep_eq κ.exhaust_disc κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> κυ.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> κυ.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π</span>›</span></span> υ.disc<span class="main"><span class="main">(</span></span>8<span class="main"><span class="main">)</span></span> υ.disc<span class="main"><span class="main">(</span></span>9<span class="main"><span class="main">)</span></span> υ.distinct<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> is_ακ_def is_ωκ_def verit_sko_ex'<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_rel.rep_eq AOT_model_term_equiv_κ_def κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> Π_den verit_sko_ex'<span class="main">)</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">r</span></span> <span class="keyword2"><span class="keyword">where</span></span> r_prop<span class="main">:</span> <span class="quoted"><span class="quoted">‹Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> Rep_urrel <span class="skolem">r</span> <span class="main">(</span>ωυ <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

  <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">Π'</span><span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">∧</span>
             AOT_model_enc <span class="skolem">κ</span> <span class="bound">Π'</span> <span class="main">∧</span>
             <span class="main">(</span><span class="main">∀</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Π'</span></span> <span class="keyword2"><span class="keyword">where</span></span>
      Π'_den<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      κ_enc_Π'<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_enc <span class="skolem">κ</span> <span class="skolem">Π'</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span>
      Π'_prop<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span> <span class="main">⟹</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π'</span> <span class="main">(</span>ωκ <span class="skolem">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="main">(</span>ωκ <span class="skolem">x</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">v</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_ω_concrete_in_some_world Π'_prop<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="main">(</span>rel_to_urrel <span class="skolem">Π'</span><span class="main">)</span> <span class="main">(</span>rel_to_urrel <span class="skolem">Π</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_urrel_ωequiv_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def Π'_den Π_den κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I urrel_quotient3 urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹rel_to_urrel <span class="skolem">Π'</span> <span class="main">∈</span> <span class="skolem">a</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹urrel_to_ωrel <span class="main">(</span>rel_to_urrel <span class="skolem">Π'</span><span class="main">)</span> <span class="main">=</span> urrel_to_ωrel <span class="main">(</span>rel_to_urrel <span class="skolem">Π</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_enc_κ_def κ.simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> κ_enc_Π' a_def<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> Quotient3_rel <span class="quoted"><span class="quoted">‹AOT_urrel_ωequiv <span class="main">(</span>rel_to_urrel <span class="skolem">Π'</span><span class="main">)</span> <span class="main">(</span>rel_to_urrel <span class="skolem">Π</span><span class="main">)</span>›</span></span> urrel_ωrel_quot<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">s</span><span class="main">.</span> <span class="bound">s</span> <span class="main">∈</span> <span class="skolem">b</span> <span class="main">∧</span> urrel_to_ωrel <span class="bound">s</span> <span class="main">=</span> urrel_to_ωrel <span class="main">(</span>rel_to_urrel <span class="skolem">Π</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">using</span></span> ασ_eq_ord_exts_ex<span class="main">[</span><span class="operator">OF</span> ασ_eq<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">s</span></span> <span class="keyword2"><span class="keyword">where</span></span> s_prop<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">s</span> <span class="main">∈</span> <span class="skolem">b</span> <span class="main">∧</span> urrel_to_ωrel <span class="skolem">s</span> <span class="main">=</span> urrel_to_ωrel <span class="main">(</span>rel_to_urrel <span class="skolem">Π</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">Π''</span></span> <span class="keyword2"><span class="keyword">where</span></span> Π''_prop<span class="main">:</span> <span class="quoted"><span class="quoted">‹rel_to_urrel <span class="skolem">Π''</span> <span class="main">=</span> <span class="skolem">s</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> Π''_den<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">Π''</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_rel_equiv_def Quotient3_def urrel_quotient3<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_enc <span class="skolem">κ'</span> <span class="skolem">Π''</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_enc_κ_def Π''_den Π''_prop κ.simps<span class="main"><span class="main">(</span></span>11<span class="main"><span class="main">)</span></span> b_def s_prop<span class="main">)</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="main">∃</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">⟹</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π''</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="skolem">x</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">v</span> <span class="skolem">x</span>
  <span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="skolem">x</span>›</span></span>
    <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">u</span></span> <span class="keyword2"><span class="keyword">where</span></span> x_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="skolem">x</span> <span class="main">=</span> ωκ <span class="skolem">u</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> AOT_model_concrete_κ.simps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> κ.exhaust<span class="main">)</span>
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π''</span> <span class="skolem">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="skolem">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="skolem">x</span><span class="main">)</span>›</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> x_def
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">smt</span> <span class="main"><span class="main">(</span></span>verit<span class="main"><span class="main">,</span></span> best<span class="main"><span class="main">)</span></span> AOT_rel_equiv_def Abs_rel_inverse Quotient3_def Π''_den Π''_prop Π_den κυ.simps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> iso_tuple_UNIV_I s_prop urrel_quotient3 urrel_to_ωrel_def urrel_to_rel_def<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">Π'</span><span class="main">.</span> AOT_model_denotes <span class="bound">Π'</span> <span class="main">∧</span>
             AOT_model_enc <span class="skolem">κ'</span> <span class="bound">Π'</span> <span class="main">∧</span>
             <span class="main">(</span><span class="main">∀</span><span class="bound">v</span> <span class="bound">x</span><span class="main">.</span> <span class="main">(</span><span class="main">∃</span><span class="bound">w</span><span class="main">.</span> AOT_model_concrete <span class="bound">w</span> <span class="bound">x</span><span class="main">)</span> <span class="main">⟶</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="bound">Π'</span> <span class="bound">x</span><span class="main">)</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="main">(</span>Rep_rel <span class="skolem">Π</span> <span class="bound">x</span><span class="main">)</span><span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="skolem">Π''</span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> prod <span class="main">::</span> <span class="main">(</span><span class="quoted">AOT_UnaryIndividualTerm</span><span class="main">,</span> <span class="quoted">AOT_IndividualTerm</span><span class="main">)</span> <span class="quoted">AOT_IndividualTerm</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_regular_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_regular_prod</span> <span class="main">≡</span> <span class="main">λ</span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span> <span class="main">.</span> <span class="main">(</span>AOT_model_regular <span class="bound">x</span> <span class="main">∧</span> AOT_model_regular <span class="bound">y</span> <span class="main">∧</span> <span class="main">(</span>AOT_model_denotes <span class="bound">x</span> <span class="main">∨</span> AOT_model_denotes <span class="bound">y</span><span class="main">)</span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_term_equiv_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_term_equiv_prod</span> <span class="main">≡</span>  <span class="main">λ</span> <span class="main">(</span><span class="bound">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="bound">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">(</span><span class="bound">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">,</span><span class="bound">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">.</span> <span class="main">(</span>AOT_model_term_equiv <span class="bound">x<span class="hidden">⇩</span><sub>1</sub></span> <span class="bound">x<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">∧</span> AOT_model_term_equiv <span class="bound">y<span class="hidden">⇩</span><sub>1</sub></span> <span class="bound">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span>
<span class="keyword1"><span class="command">function</span></span> <span class="entity"><span class="class_parameter">AOT_model_irregular_prod</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  AOT_model_irregular_proj2<span class="main">:</span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> <span class="main">¬</span>AOT_model_denotes <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟹</span>
    AOT_model_irregular <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="main">(</span><span class="main">λ</span><span class="bound">y</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">x'</span> <span class="main">.</span> AOT_model_term_equiv <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="bound">x'</span><span class="main">,</span> <span class="bound">y</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">y</span></span></span>"</span></span>
<span class="main">|</span> AOT_model_irregular_proj1<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>AOT_model_denotes <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">∧</span> AOT_model_denotes <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟹</span>
    AOT_model_irregular <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="main">(</span><span class="main">λ</span><span class="bound">x</span><span class="main">.</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="bound">x</span><span class="main">,</span> <span class="keyword1">SOME</span> <span class="bound">y'</span> <span class="main">.</span> AOT_model_term_equiv <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="bound">y'</span><span class="main">)</span><span class="main">)</span> <span class="free"><span class="bound"><span class="entity">x</span></span></span>"</span></span>
<span class="main">|</span> AOT_model_irregular_prod_generic<span class="main">:</span> <span class="quoted"><span class="quoted">"AOT_model_denotes <span class="free"><span class="bound"><span class="entity">x</span></span></span> <span class="main">=</span> AOT_model_denotes <span class="free"><span class="bound"><span class="entity">y</span></span></span> <span class="main">⟹</span>
    AOT_model_irregular <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">Φ</span> <span class="main">.</span> AOT_model_irregular_spec <span class="bound">Φ</span> AOT_model_regular AOT_model_term_equiv<span class="main">)</span> <span class="free"><span class="bound"><span class="entity">φ</span></span></span> <span class="main">(</span><span class="free"><span class="bound"><span class="entity">x</span></span></span><span class="main">,</span><span class="free"><span class="bound"><span class="entity">y</span></span></span><span class="main">)</span>"</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">termination</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"termination"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">obtain</span></span> <span class="skolem"><span class="skolem">x</span></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem"><span class="skolem">y</span></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_denotes <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_denotes <span class="skolem">y</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_nondenoting_ex AOT_model_denoting_ex<span class="main">)</span>
  <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span><span class="main">.</span> <span class="main">¬</span>AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_prod_def AOT_model_regular_prod_def<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹equivp <span class="main">(</span>AOT_model_term_equiv <span class="main">::</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> bool<span class="main">)</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> equivpI<span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span> reflpI sympI transpI<span class="main"><span class="keyword3">;</span></span>
        <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def AOT_model_term_equiv_part_equivp
                  equivp_reflp prod.case_eq_if case_prod_unfold equivp_symp<span class="main">)</span>
       <span class="main">(</span><span class="operator">metis</span> equivp_transp<span class="main"><span class="main">[</span></span><span class="operator">OF</span> AOT_model_term_equiv_part_equivp<span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_regular <span class="skolem">x</span> <span class="main">⟹</span> <span class="main">¬</span> AOT_model_denotes <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_prod_def AOT_model_irregular_nondenoting
                                   AOT_model_regular_prod_def case_prod_unfold<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">⟹</span> AOT_model_denotes <span class="skolem">x</span> <span class="main">=</span> AOT_model_denotes <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_denotes_prod_def AOT_model_term_equiv_denotes
                                   AOT_model_term_equiv_prod_def case_prod_beta<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">⟹</span> AOT_model_regular <span class="skolem">x</span> <span class="main">=</span> AOT_model_regular <span class="skolem">y</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">induct</span> <span class="quoted"><span class="skolem">y</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def AOT_model_regular_prod_def<span class="main">)</span>
       <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes AOT_model_term_equiv_regular<span class="main">)</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword1"><span class="command">interpret</span></span> sp<span class="main">:</span> AOT_model_irregular_spec <span class="quoted"><span class="quoted">‹<span class="main">λ</span><span class="bound">φ</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span><span class="main">)</span> <span class="main">.</span> <span class="keyword1">ε<span class="hidden">⇩</span><sub>𝗈</sub></span> <span class="bound">w</span> <span class="main">.</span> False›</span></span> <span class="quoted">AOT_model_regular</span> <span class="quoted">AOT_model_term_equiv</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_spec_def AOT_model_proposition_choice_simp<span class="main">)</span>
  <span class="keyword1"><span class="command">have</span></span> ex_spec<span class="main">:</span> <span class="quoted"><span class="quoted">"<span class="main">∃</span> <span class="bound">φ</span> <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈 <span class="main">.</span> AOT_model_irregular_spec <span class="bound">φ</span> AOT_model_regular AOT_model_term_equiv"</span></span>
    <span class="keyword1"><span class="command">using</span></span> sp.AOT_model_irregular_spec_axioms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">have</span></span> some_spec<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_irregular_spec
    <span class="main">(</span><span class="keyword1">SOME</span> <span class="bound">φ</span> <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈 <span class="main">.</span> AOT_model_irregular_spec <span class="bound">φ</span> AOT_model_regular AOT_model_term_equiv<span class="main">)</span>
    AOT_model_regular AOT_model_term_equiv›</span></span>
    <span class="keyword1"><span class="command">using</span></span> someI_ex<span class="main">[</span><span class="operator">OF</span> ex_spec<span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">argo</span>
  <span class="keyword1"><span class="command">interpret</span></span> sp_some<span class="main">:</span> AOT_model_irregular_spec
    <span class="quoted"><span class="quoted">‹<span class="keyword1">SOME</span> <span class="bound">φ</span> <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈 <span class="main">.</span> AOT_model_irregular_spec <span class="bound">φ</span> AOT_model_regular AOT_model_term_equiv›</span></span>
    <span class="quoted">AOT_model_regular</span> <span class="quoted">AOT_model_term_equiv</span>
    <span class="keyword1"><span class="command">using</span></span> some_spec <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular_spec <span class="main">(</span>AOT_model_irregular <span class="main">::</span> <span class="main">(</span><span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈<span class="main">)</span> AOT_model_regular AOT_model_term_equiv›</span></span>
  <span class="keyword1"><span class="command">proof</span></span>
    <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">a</span><span class="main">,</span> <span class="skolem">b</span><span class="main">)</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="skolem">φ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">a</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">b</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="skolem">φ</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_prod.induct<span class="main">)</span>
         <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_false sp_some.AOT_model_irregular_false<span class="main">)</span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">"<span class="main">¬</span>AOT_model_valid_in <span class="skolem">w</span> <span class="main">(</span>AOT_model_irregular <span class="skolem">φ</span> <span class="skolem">x</span><span class="main">)</span>"</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">w</span> <span class="skolem">φ</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword1"><span class="command">{</span></span>
      <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span> <span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span> <span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">φ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span><span class="main">⇒</span>𝗈›</span></span>
      <span class="keyword3"><span class="command">assume</span></span> x<span class="hidden">⇩</span><sub>1</sub>y<span class="hidden">⇩</span><sub>1</sub>_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span> <span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span>›</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">assume</span></span> x<span class="hidden">⇩</span><sub>2</sub>y<span class="hidden">⇩</span><sub>2</sub>_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span> <span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> xy_equiv<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="main">(</span><span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">(</span><span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def<span class="main">)</span>
      <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">⇩</span><sub>1</sub>y<span class="hidden">⇩</span><sub>1</sub>_equiv x<span class="hidden">⇩</span><sub>2</sub>y<span class="hidden">⇩</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sp_some.AOT_model_irregular_equiv xy_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹<span class="main">~</span>AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> <span class="main">~</span>AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
        <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command"><span class="improper">hence</span></span></span> <span class="quoted"><span class="quoted">‹<span class="main">~</span>AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> <span class="main">~</span>AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">⇩</span><sub>1</sub>y<span class="hidden">⇩</span><sub>1</sub>_equiv x<span class="hidden">⇩</span><sub>2</sub>y<span class="hidden">⇩</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> sp_some.AOT_model_irregular_equiv xy_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> denotes_x<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> <span class="main">¬</span>AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
        <span class="keyword1"><span class="command">hence</span></span> denotes_y<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> <span class="main">¬</span>AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">⇩</span><sub>1</sub>y<span class="hidden">⇩</span><sub>1</sub>_equiv x<span class="hidden">⇩</span><sub>2</sub>y<span class="hidden">⇩</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> eps_eq<span class="main">:</span> <span class="quoted"><span class="quoted">‹Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span> <span class="main">=</span> Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> x<span class="hidden">⇩</span><sub>1</sub>y<span class="hidden">⇩</span><sub>1</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> denotes_x denotes_y <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> x<span class="hidden">⇩</span><sub>2</sub>y<span class="hidden">⇩</span><sub>2</sub>_equiv eps_eq AOT_model_irregular_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">{</span></span>
        <span class="keyword3"><span class="command">assume</span></span> denotes_x<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> AOT_model_denotes <span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
        <span class="keyword1"><span class="command">hence</span></span> denotes_y<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span> <span class="main">∧</span> AOT_model_denotes <span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_term_equiv_denotes x<span class="hidden">⇩</span><sub>1</sub>y<span class="hidden">⇩</span><sub>1</sub>_equiv x<span class="hidden">⇩</span><sub>2</sub>y<span class="hidden">⇩</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> eps_eq<span class="main">:</span> <span class="quoted"><span class="quoted">‹Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> Eps <span class="main">(</span>AOT_model_term_equiv <span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>3<span class="main"><span class="main">)</span></span> x<span class="hidden">⇩</span><sub>2</sub>y<span class="hidden">⇩</span><sub>2</sub>_equiv<span class="main">)</span>
        <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span>
          <span class="keyword1"><span class="command">using</span></span> denotes_x denotes_y
          <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span> x<span class="hidden">⇩</span><sub>1</sub>y<span class="hidden">⇩</span><sub>1</sub>_equiv eps_eq AOT_model_irregular_equiv<span class="main">)</span>
      <span class="keyword1"><span class="command">}</span></span>
      <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">have</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">x<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">x<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">y<span class="hidden">⇩</span><sub>1</sub></span><span class="main">,</span><span class="skolem">y<span class="hidden">⇩</span><sub>2</sub></span><span class="main">)</span>›</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
    <span class="keyword1"><span class="command">}</span></span> <span class="keyword1"><span class="command">note</span></span> 0 <span class="main">=</span> this
    <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹AOT_model_term_equiv <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">⟹</span> AOT_model_irregular <span class="skolem">φ</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">φ</span> <span class="skolem">y</span>›</span></span>
      <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span>›</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">φ</span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quoted"><span class="skolem">x</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">induct</span> <span class="quoted"><span class="skolem">y</span></span><span class="main"><span class="keyword3">;</span></span> <span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_prod_def 0<span class="main">)</span>
  <span class="keyword1"><span class="command">next</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">φ</span> <span class="skolem">ψ</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span> <span class="main">⇒</span> 𝗈›</span></span>
    <span class="keyword3"><span class="command">assume</span></span> <span class="quoted"><span class="quoted">‹AOT_model_regular <span class="skolem">x</span> <span class="main">⟹</span> <span class="skolem">φ</span> <span class="skolem">x</span> <span class="main">=</span> <span class="skolem">ψ</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_regular <span class="skolem">x</span> <span class="main">∧</span> AOT_model_regular <span class="skolem">y</span> <span class="main">∧</span> <span class="main">(</span>AOT_model_denotes <span class="skolem">x</span> <span class="main">∨</span> AOT_model_denotes <span class="skolem">y</span><span class="main">)</span> <span class="main">⟹</span> <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> <span class="skolem">ψ</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span> <span class="skolem">y</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="skolem">y</span>
      <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_regular_prod_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
    <span class="keyword1"><span class="command">hence</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="skolem">φ</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">ψ</span> <span class="main">(</span><span class="skolem">x</span><span class="main">,</span><span class="skolem">y</span><span class="main">)</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem">x</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'a</span></span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="skolem">y</span> <span class="main">::</span> <span class="tfree"><span class="quoted"><span class="tfree">'b</span></span></span>
    <span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">induct</span> <span class="quasi_keyword">arbitrary</span><span class="main"><span class="main">:</span></span> <span class="quoted"><span class="skolem">ψ</span></span> <span class="quoted"><span class="skolem">φ</span></span> <span class="quasi_keyword">rule</span><span class="main"><span class="main">:</span></span> AOT_model_irregular_prod.induct<span class="main">)</span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>1 <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">φ</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_eqI AOT_model_irregular_nondenoting AOT_model_term_equiv_denotes AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>2 <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">φ</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_model_irregular_nondenoting AOT_model_no_special_nondenoting AOT_model_term_equiv_denotes AOT_model_term_equiv_eps<span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">)</span>
    <span class="keyword1"><span class="command">next</span></span>
      <span class="keyword3"><span class="command">case</span></span> <span class="main">(</span>3 <span class="skolem">x</span> <span class="skolem">y</span> <span class="skolem">φ</span><span class="main">)</span>
      <span class="keyword3"><span class="command">thus</span></span> <span class="var"><span class="quoted"><span class="var">?case</span></span></span>
        <span class="keyword1"><span class="command"><span class="improper"><span class="command">apply</span></span></span></span> <span class="operator">simp</span>
        <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="main"><span class="main">(</span></span>mono_tags<span class="main"><span class="main">,</span></span> lifting<span class="main"><span class="main">)</span></span> AOT_model_regular_prod_def case_prod_conv sp_some.AOT_model_irregular_eqI surj_pair<span class="main">)</span>
    <span class="keyword1"><span class="command">qed</span></span>
    <span class="keyword3"><span class="command">thus</span></span> <span class="quoted"><span class="quoted">‹AOT_model_irregular <span class="skolem">φ</span> <span class="skolem">x</span> <span class="main">=</span> AOT_model_irregular <span class="skolem">ψ</span> <span class="skolem">x</span>›</span></span> <span class="keyword2"><span class="keyword">for</span></span>  <span class="skolem">x</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">×</span><span class="tfree">'b</span>›</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> surjective_pairing<span class="main">)</span>
  <span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_meta_prod_equivI<span class="main">:</span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="main">(</span><span class="bound">a</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>AOT_UnaryIndividualTerm<span class="main">)</span> <span class="bound">x</span> <span class="main">(</span><span class="bound">y</span> <span class="main">::</span> <span class="tfree">'b</span><span class="main">::</span>AOT_IndividualTerm<span class="main">)</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟹</span> AOT_model_term_equiv <span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">x</span><span class="main">)</span> <span class="main">(</span><span class="bound">a</span><span class="main">,</span><span class="bound">y</span><span class="main">)</span>"</span></span>
    <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">"<span class="main">⋀</span> <span class="main">(</span><span class="bound">x</span><span class="main">::</span><span class="tfree">'a</span><span class="main">::</span>AOT_UnaryIndividualTerm<span class="main">)</span> <span class="bound">y</span> <span class="main">(</span><span class="bound">b</span> <span class="main">::</span> <span class="tfree">'b</span><span class="main">::</span>AOT_IndividualTerm<span class="main">)</span> <span class="main">.</span> AOT_model_term_equiv <span class="bound">x</span> <span class="bound">y</span> <span class="main">⟹</span> AOT_model_term_equiv <span class="main">(</span><span class="bound">x</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span> <span class="main">(</span><span class="bound">y</span><span class="main">,</span><span class="bound">b</span><span class="main">)</span>"</span></span>
    <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_term_equiv_prod_def
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_term_equiv_part_equivp equivp_reflp<span class="main">)</span><span class="main"><span class="keyword3">+</span></span>


<span class="keyword1"><span class="command">instantiation</span></span> unit <span class="main">::</span> <span class="quoted">AOT_Term</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_unit</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹unit <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_denotes_unit</span> <span class="main">≡</span> <span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span> True›</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span><span class="main">::</span>unit<span class="main">.</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_unit_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">instantiation</span></span> 𝗈 <span class="main">::</span> <span class="quoted">AOT_Term</span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity"><span class="class_parameter">AOT_model_denotes_𝗈</span></span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹𝗈 <span class="main">⇒</span> bool›</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_denotes_𝗈</span> <span class="main">≡</span> <span class="main">λ</span><span class="main"><span class="bound">_</span></span><span class="main">.</span> True›</span></span>
<span class="keyword1"><span class="command">instance</span></span> <span class="keyword1"><span class="command">proof</span></span>
  <span class="keyword3"><span class="command">show</span></span> <span class="quoted"><span class="quoted">‹<span class="main">∃</span><span class="bound">x</span><span class="main">::</span>𝗈<span class="main">.</span> AOT_model_denotes <span class="bound">x</span>›</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denotes_𝗈_def<span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">typedef</span></span> <span class="main">(</span><span class="keyword2"><span class="keyword">overloaded</span></span><span class="main">)</span> <span class="tfree">'a</span> AOT_var <span class="main">=</span> <span class="quoted"><span class="quoted">‹<span class="main">{</span> <span class="bound">x</span> <span class="main">::</span> <span class="tfree">'a</span><span class="main">::</span>AOT_Term <span class="main">.</span> AOT_model_denotes <span class="bound">x</span> <span class="main">}</span>›</span></span>
  <span class="keyword2"><span class="keyword">morphisms</span></span> AOT_term_of_var AOT_var_of_term
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> AOT_model_denoting_ex<span class="main">)</span>

<span class="keyword1"><span class="command">declare</span></span> AOT_var_of_term_induct<span class="main">[</span><span class="operator">induct</span> <span class="quasi_keyword">del</span><span class="main">]</span>
        AOT_var_of_term_cases<span class="main">[</span><span class="operator">cases</span> <span class="quasi_keyword">del</span><span class="main">]</span>
        AOT_term_of_var_induct<span class="main">[</span><span class="operator">induct</span> <span class="quasi_keyword">del</span><span class="main">]</span>
        AOT_term_of_var_cases<span class="main">[</span><span class="operator">cases</span> <span class="quasi_keyword">del</span><span class="main">]</span>

<span class="keyword1"><span class="command">lemmas</span></span> AOT_var_of_term_inverse <span class="main">=</span> AOT_var_of_term_inverse<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_var_of_term_inject <span class="main">=</span> AOT_var_of_term_inject<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_var_of_term_induct <span class="main">=</span> AOT_var_of_term_induct<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">induct</span> <span class="quasi_keyword">type</span><span class="main"><span class="main">:</span></span> AOT_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_var_of_term_cases <span class="main">=</span> AOT_var_of_term_cases<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">cases</span> <span class="quasi_keyword">type</span><span class="main"><span class="main">:</span></span> AOT_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var <span class="main">=</span> AOT_term_of_var<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_cases <span class="main">=</span> AOT_term_of_var_cases<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">induct</span> <span class="quasi_keyword">pred</span><span class="main"><span class="main">:</span></span> AOT_term_of_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_induct <span class="main">=</span> AOT_term_of_var_induct<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">induct</span> <span class="quasi_keyword">pred</span><span class="main"><span class="main">:</span></span> AOT_term_of_var<span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_inverse <span class="main">=</span> AOT_term_of_var_inverse<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>
   <span class="keyword2"><span class="keyword">and</span></span> AOT_term_of_var_inject <span class="main">=</span> AOT_term_of_var_inject<span class="main">[</span><span class="operator">simplified</span><span class="main">]</span>

<span class="keyword1"><span class="command">consts</span></span> AOT_model_equiv_def <span class="main">::</span> <span class="quoted"><span class="quoted">‹𝗈 <span class="main">⇒</span> 𝗈 <span class="main">⇒</span> bool›</span></span>
<span class="keyword1"><span class="command">specification</span></span><span class="main">(</span><span class="quoted">AOT_model_equiv_def</span><span class="main">)</span>
  AOT_model_equiv_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹AOT_model_equiv_def <span class="free">φ</span> <span class="free">ψ</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="free">φ</span> <span class="main">=</span> AOT_model_valid_in <span class="bound">v</span> <span class="free">ψ</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">‹<span class="main"><span class="main"><span class="main">λ</span></span></span> <span class="bound"><span class="bound"><span class="bound">φ</span></span></span> <span class="bound"><span class="bound"><span class="bound">ψ</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">∀</span></span></span> <span class="bound"><span class="bound"><span class="bound">v</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> AOT_model_valid_in <span class="bound"><span class="bound"><span class="bound">v</span></span></span> <span class="bound"><span class="bound"><span class="bound">φ</span></span></span> <span class="main"><span class="main"><span class="main">=</span></span></span> AOT_model_valid_in <span class="bound"><span class="bound"><span class="bound">v</span></span></span> <span class="bound"><span class="bound"><span class="bound">ψ</span></span></span>›</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span> <span class="operator">simp</span>

<span class="keyword1"><span class="command">consts</span></span> AOT_model_id_def <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span><span class="tfree">'b</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">::</span>AOT_Term<span class="main">)</span> <span class="main">⇒</span> <span class="main">(</span><span class="tfree">'b</span> <span class="main">⇒</span> <span class="tfree">'a</span><span class="main">)</span> <span class="main">⇒</span> bool›</span></span>
<span class="keyword1"><span class="command">specification</span></span><span class="main">(</span><span class="quoted">AOT_model_id_def</span><span class="main">)</span>
  AOT_model_id_def<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">(</span>AOT_model_id_def <span class="free">τ</span> <span class="free">σ</span><span class="main">)</span> <span class="main">=</span> <span class="main">(</span><span class="main">∀</span> <span class="bound">α</span> <span class="main">.</span> <span class="keyword1">if</span> AOT_model_denotes <span class="main">(</span><span class="free">σ</span> <span class="bound">α</span><span class="main">)</span> <span class="keyword1">then</span> <span class="free">τ</span> <span class="bound">α</span> <span class="main">=</span> <span class="free">σ</span> <span class="bound">α</span> <span class="keyword1">else</span> <span class="main">¬</span>AOT_model_denotes <span class="main">(</span><span class="free">τ</span> <span class="bound">α</span><span class="main">)</span><span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> exI<span class="main"><span class="main">[</span></span><span class="keyword2"><span class="keyword"><span class="operator">where</span></span></span> x<span class="main"><span class="main"><span class="main">=</span></span></span><span class="quoted"><span class="quoted"><span class="quoted"><span class="quoted">"<span class="main"><span class="main"><span class="main">λ</span></span></span> <span class="bound"><span class="bound"><span class="bound">τ</span></span></span> <span class="bound"><span class="bound"><span class="bound">σ</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="main"><span class="main"><span class="main">∀</span></span></span> <span class="bound"><span class="bound"><span class="bound">α</span></span></span> <span class="main"><span class="main"><span class="main">.</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">if</span></span></span> AOT_model_denotes <span class="main"><span class="main"><span class="main">(</span></span></span><span class="bound"><span class="bound"><span class="bound">σ</span></span></span> <span class="bound"><span class="bound"><span class="bound">α</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">then</span></span></span> <span class="bound"><span class="bound"><span class="bound">τ</span></span></span> <span class="bound"><span class="bound"><span class="bound">α</span></span></span> <span class="main"><span class="main"><span class="main">=</span></span></span> <span class="bound"><span class="bound"><span class="bound">σ</span></span></span> <span class="bound"><span class="bound"><span class="bound">α</span></span></span> <span class="keyword1"><span class="keyword1"><span class="keyword1">else</span></span></span> <span class="main"><span class="main"><span class="main">¬</span></span></span>AOT_model_denotes <span class="main"><span class="main"><span class="main">(</span></span></span><span class="bound"><span class="bound"><span class="bound">τ</span></span></span> <span class="bound"><span class="bound"><span class="bound">α</span></span></span><span class="main"><span class="main"><span class="main">)</span></span></span>"</span></span></span></span><span class="main"><span class="main">]</span></span><span class="main">)</span>
     <span class="operator">blast</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_nondenoting</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‹<span class="tfree">'a</span><span class="main">::</span>AOT_IncompleteTerm›</span></span> <span class="keyword2"><span class="keyword">where</span></span>
  <span class="quoted"><span class="quoted">‹<span class="free">AOT_model_nondenoting</span> <span class="main">≡</span> <span class="keyword1">SOME</span> <span class="bound">τ</span> <span class="main">.</span> <span class="main">¬</span>AOT_model_denotes <span class="bound">τ</span>›</span></span>
<span class="keyword1"><span class="command">lemma</span></span> AOT_model_nondenoing<span class="main">:</span> <span class="quoted"><span class="quoted">‹<span class="main">¬</span>AOT_model_denotes <span class="main">(</span>AOT_model_nondenoting<span class="main">)</span>›</span></span>
  <span class="keyword1"><span class="command">using</span></span> someI_ex<span class="main">[</span><span class="operator">OF</span> AOT_model_nondenoting_ex<span class="main">]</span> <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_nondenoting_def <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>

<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_axiom</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">AOT_model_axiom</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">φ</span> <span class="main">.</span> <span class="main">∀</span> <span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="bound">φ</span>"</span></span>
<span class="keyword1"><span class="command">definition</span></span> <span class="entity">AOT_model_act_axiom</span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">"<span class="free">AOT_model_act_axiom</span> <span class="main">≡</span> <span class="main">λ</span> <span class="bound">φ</span> <span class="main">.</span> AOT_model_valid_in w<span class="hidden">⇩</span><sub>0</sub> <span class="bound">φ</span>"</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_axiomI<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹<span class="main">⋀</span><span class="bound">v</span> <span class="main">.</span> AOT_model_valid_in <span class="bound">v</span> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹AOT_model_axiom <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_axiom_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">..</span></span>

<span class="keyword1"><span class="command">lemma</span></span> AOT_model_act_axiomI<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‹AOT_model_valid_in w<span class="hidden">⇩</span><sub>0</sub> <span class="free">φ</span>›</span></span> <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‹AOT_model_act_axiom <span class="free">φ</span>›</span></span>
  <span class="keyword1"><span class="command">unfolding</span></span> AOT_model_act_axiom_def <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">.</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span></pre>
</body>

</html>