<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory AOT_RestrictedVariables</title>
</head>


<body>
<div class="head">
<h1>Theory AOT_RestrictedVariables</h1>
</div>

<pre class="source"><span class="comment1">(*&lt;*)</span>
<span class="keyword1"><span class="command">theory</span></span> AOT_RestrictedVariables
  <span class="keyword2"><span class="keyword">imports</span></span> <a href="AOT_PLM.html">AOT_PLM</a>
  <span class="keyword2"><span class="keyword">keywords</span></span> <span class="quoted">"AOT_register_rigid_restricted_type"</span> <span class="main">::</span> thy_goal
       <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted">"AOT_register_restricted_type"</span> <span class="main">::</span> thy_goal
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="comment1">(*&gt;*)</span>

<span class="keyword1"><span class="command">section</span></span><span class="quoted"><span class="plain_text">‚ÄπRestricted Variables‚Ä∫</span></span>

<span class="keyword1"><span class="command">locale</span></span> AOT_restriction_condition <span class="main">=</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">œà</span> <span class="main">::</span> <span class="quoted"><span class="quoted">‚Äπ<span class="tfree">'a</span><span class="main">::</span>AOT_Term_id_2 <span class="main">‚áí</span> ùóà‚Ä∫</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted">"res-var:2"</span><span class="main">[</span><span class="operator">AOT</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">[</span><span class="free">v</span> <span class="main">‚ä®</span> <span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">]</span>‚Ä∫</span></span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted">"res-var:3"</span><span class="main">[</span><span class="operator">AOT</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">[</span><span class="free">v</span> <span class="main">‚ä®</span> <span class="free">œà</span><span class="main">{</span><span class="free">œÑ</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÑ</span><span class="main">‚Üì</span><span class="main">]</span>‚Ä∫</span></span>

<span class="keyword1"><span class="command">ML</span></span><span class="quoted">‚Äπ
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">register_restricted_type</span> <span class="main">(</span><span class="entity">name</span><span class="main">:</span>string<span class="main">,</span> <span class="entity">restriction</span><span class="main">:</span>string<span class="main">)</span> <span class="entity">thy</span> <span class="main">=</span>
<span class="keyword2"><span class="keyword">let</span></span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">ctxt</span> <span class="main">=</span> <span class="entity">thy</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">ctxt</span> <span class="main">=</span> <span class="entity">setupStrictWorld</span> <span class="entity">ctxt</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> Syntax.check_term <span class="entity">ctxt</span> <span class="main">(</span><span class="entity">AOT_read_term</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">nonterminal</span> œÜ'<span class="antiquote">}</span></span> <span class="entity">ctxt</span> <span class="entity">restriction</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">free</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">case</span></span> <span class="main">(</span>Term.add_frees <span class="entity">trm</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">of</span></span> <span class="main">[</span><span class="entity">f</span><span class="main">]</span> <span class="main">=&gt;</span> <span class="entity">f</span> <span class="main">|</span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="keyword3"><span class="keyword">raise</span></span> Term.TERM <span class="main">(</span><span class="inner_quoted">"Expected single free variable."</span><span class="main">,</span> <span class="main">[</span><span class="entity">trm</span><span class="main">]</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> Term.absfree <span class="entity">free</span> <span class="entity">trm</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">localeTerm</span> <span class="main">=</span> Const <span class="main">(</span><span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span>‚ÄπAOT_restriction_condition‚Ä∫</span><span class="main">,</span> dummyT<span class="main">)</span> $ <span class="entity">trm</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">localeTerm</span> <span class="main">=</span> Syntax.check_term <span class="entity">ctxt</span> <span class="entity">localeTerm</span>
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">after_qed</span> <span class="entity">thms</span> <span class="entity">thy</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">let</span></span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">st</span> <span class="main">=</span> <span class="entity">Interpretation.global_interpretation</span> <span class="main">(</span><span class="main">(</span><span class="main">[</span><span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> AOT_restriction_condition<span class="antiquote">}</span></span><span class="main">,</span> <span class="main">(</span><span class="main">(</span><span class="entity">name</span><span class="main">,</span> true<span class="main">)</span><span class="main">,</span>
           <span class="main">(</span><span class="entity">Expression.Named</span> <span class="main">[</span><span class="main">(</span><span class="inner_quoted">"œà"</span><span class="main">,</span> <span class="entity">trm</span><span class="main">)</span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span><span class="main">]</span> <span class="entity">thy</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">st</span> <span class="main">=</span> <span class="entity">Proof.refine_insert</span> <span class="main">(</span>flat <span class="entity">thms</span><span class="main">)</span> <span class="entity">st</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thy</span> <span class="main">=</span> <span class="entity">Proof.global_immediate_proof</span> <span class="entity">st</span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thy</span> <span class="main">=</span> Local_Theory.background_theory <span class="main">(</span>AOT_Constraints.map <span class="main">(</span>Symtab.update <span class="main">(</span><span class="entity">name</span><span class="main">,</span> <span class="main">(</span><span class="entity">term_of</span> <span class="main">(</span>snd <span class="entity">free</span><span class="main">)</span><span class="main">,</span> <span class="entity">term_of</span> <span class="main">(</span>snd <span class="entity">free</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="entity">thy</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thy</span> <span class="main">=</span> Local_Theory.background_theory <span class="main">(</span>AOT_Restriction.map <span class="main">(</span>Symtab.update <span class="main">(</span><span class="entity">name</span><span class="main">,</span> <span class="main">(</span><span class="entity">trm</span><span class="main">,</span> Const <span class="main">(</span><span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span>‚ÄπAOT_term_of_var‚Ä∫</span><span class="main">,</span> dummyT<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="entity">thy</span>

<span class="keyword2"><span class="keyword">in</span></span> <span class="entity">thy</span> <span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">in</span></span>
<span class="entity">Proof.theorem</span> NONE <span class="entity">after_qed</span> <span class="main">[</span><span class="main">[</span><span class="main">(</span><span class="entity">HOLogic.mk_Trueprop</span> <span class="entity">localeTerm</span><span class="main">,</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">]</span><span class="main">]</span> <span class="entity">ctxt</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="main">_</span> <span class="main">=</span>
  <span class="entity">Outer_Syntax.command</span> <span class="antiquoted"><span class="entity"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span>‚Äπ<span class="keyword1">AOT_register_restricted_type</span>‚Ä∫</span></span> <span class="inner_quoted">"Register a restricted type."</span>
    <span class="main">(</span><span class="main">(</span><span class="main">(</span>Parse.short_ident --| Parse.$$$ <span class="inner_quoted">":"</span><span class="main">)</span> -- Parse.term<span class="main">)</span> &gt;&gt; <span class="main">(</span><span class="entity">Toplevel.local_theory_to_proof</span> NONE NONE o <span class="entity">register_restricted_type</span><span class="main">)</span><span class="main">)</span><span class="main">;</span>

‚Ä∫</span>

<span class="keyword1"><span class="command">locale</span></span> AOT_rigid_restriction_condition <span class="main">=</span> AOT_restriction_condition <span class="main">+</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> rigid_condition<span class="main">[</span><span class="operator">AOT</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">[</span><span class="free">v</span> <span class="main">‚ä®</span> <span class="main">‚ñ°</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="free">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="free">œà</span><span class="main">{</span><span class="free">Œ±</span><span class="main">}</span><span class="main">)</span><span class="main">]</span>‚Ä∫</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>
<span class="keyword1"><span class="command">lemma</span></span> type_set_nonempty<span class="main">[</span><span class="operator">AOT_no_atp</span><span class="main">,</span> <span class="operator">no_atp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">x</span> <span class="main">.</span> <span class="bound">x</span> <span class="main">‚àà</span> <span class="main">{</span> <span class="bound">Œ±</span> <span class="main">.</span> <span class="main">[</span>w<span class="hidden">‚á©</span><sub>0</sub> <span class="main">‚ä®</span> <span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">]</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"instantiation"</span> mem_Collect_eq <span class="quoted">"res-var:2"</span><span class="main">)</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="command">locale</span></span> AOT_restricted_type <span class="main">=</span> AOT_rigid_restriction_condition <span class="main">+</span>
  <span class="keyword2"><span class="keyword">fixes</span></span> <span class="free">Rep</span> <span class="keyword2"><span class="keyword">and</span></span> <span class="free">Abs</span> <span class="keyword2"><span class="keyword">assumes</span></span> AOT_restricted_type_definition<span class="main">[</span><span class="operator">AOT_no_atp</span><span class="main">]</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπtype_definition <span class="free">Rep</span> <span class="free">Abs</span> <span class="main">{</span> <span class="bound">Œ±</span> <span class="main">.</span> <span class="main">[</span>w<span class="hidden">‚á©</span><sub>0</sub> <span class="main">‚ä®</span> <span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">]</span><span class="main">}</span>‚Ä∫</span></span>
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> restricted_var_condition<span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="free">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">interpret</span></span> type_definition <span class="quoted"><span class="free">Rep</span></span> <span class="quoted"><span class="free">Abs</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">Œ±</span> <span class="main">.</span> <span class="main">[</span>w<span class="hidden">‚á©</span><sub>0</sub> <span class="main">‚ä®</span> <span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">]</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> AOT_restricted_type_definition<span class="keyword1"><span class="command">.</span></span>
  <span class="keyword1"><span class="command">AOT_actually {</span></span>
    <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="free">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">‚Üì</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="free">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span>‚Ä∫</span></span>
      <span class="keyword1"><span class="command">using</span></span> AOT_sem_imp Rep <span class="quoted">"res-var:3"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">auto</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">AOT_actually {</span></span>
    <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">Œ±</span></span>
      <span class="keyword1"><span class="command">using</span></span> AOT_sem_box rigid_condition <span class="keyword1"><span class="command">by</span></span> <span class="operator">presburger</span>
    <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">œÑ</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="free">œà</span><span class="main">{</span><span class="skolem">œÑ</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">œÑ</span><span class="main">‚Üì</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">œÑ</span></span>
      <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model.AOT_term_of_var_cases AOT_sem_denotes that<span class="main">)</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">AOT_show</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="free">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">using</span></span> AOT_sem_box AOT_sem_imp <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">lemmas</span></span> <span class="quoted">"œà"</span> <span class="main">=</span> restricted_var_condition

<span class="keyword1"><span class="command">AOT_theorem</span></span> GEN<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1">for</span> <span class="keyword1">arbitrary</span> <span class="bound">Œ±</span><span class="main">:</span> <span class="free">œÜ</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="bound">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> GEN<span class="main"><span class="keyword3">;</span></span> <span class="operator">rule</span> <span class="quoted">"‚ÜíI"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">interpret</span></span> type_definition <span class="quoted"><span class="free">Rep</span></span> <span class="quoted"><span class="free">Abs</span></span> <span class="quoted"><span class="quoted">"<span class="main">{</span> <span class="bound">Œ±</span> <span class="main">.</span> <span class="main">[</span>w<span class="hidden">‚á©</span><sub>0</sub> <span class="main">‚ä®</span> <span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">]</span><span class="main">}</span>"</span></span>
    <span class="keyword1"><span class="command">using</span></span> AOT_restricted_type_definition<span class="keyword1"><span class="command">.</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Œ±</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_model_axiom_def AOT_sem_box AOT_sem_imp act_closure rigid_condition<span class="main">)</span>
  <span class="keyword1"><span class="command">hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">[</span>w<span class="hidden">‚á©</span><sub>0</sub> <span class="main">‚ä®</span> <span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">]</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> AOT_sem_act<span class="main">)</span>
  <span class="keyword1"><span class="command">{</span></span>
    <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">œÑ</span>
    <span class="keyword3"><span class="command">assume</span></span> Œ±_def<span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="skolem">Œ±</span> <span class="main">=</span> <span class="free">Rep</span> <span class="skolem">œÑ</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
      <span class="keyword1"><span class="command">unfolding</span></span> Œ±_def
      <span class="keyword1"><span class="command">using</span></span> assms <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">}</span></span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">using</span></span> Rep_cases<span class="main">[</span><span class="operator">simplified</span><span class="main">,</span> <span class="operator">OF</span> 0<span class="main">]</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">lemmas</span></span> <span class="quoted">"‚àÄI"</span> <span class="main">=</span> GEN

<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">lemma</span></span> AOT_restricted_type_intro<span class="main">[</span><span class="operator">AOT_no_atp</span><span class="main">,</span> <span class="operator">no_atp</span><span class="main">]</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‚Äπtype_definition <span class="free">Rep</span> <span class="free">Abs</span> <span class="main">{</span> <span class="bound">Œ±</span> <span class="main">.</span> <span class="main">[</span>w<span class="hidden">‚á©</span><sub>0</sub> <span class="main">‚ä®</span> <span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">]</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‚ÄπAOT_rigid_restriction_condition <span class="free">œà</span>‚Ä∫</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‚ÄπAOT_restricted_type <span class="free">œà</span> <span class="free">Rep</span> <span class="free">Abs</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> assms AOT_restricted_type_axioms.intro AOT_restricted_type.intro<span class="main">)</span>



<span class="keyword1"><span class="command">ML</span></span><span class="quoted">‚Äπ
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">register_rigid_restricted_type</span> <span class="main">(</span><span class="entity">name</span><span class="main">:</span>string<span class="main">,</span> <span class="entity">restriction</span><span class="main">:</span>string<span class="main">)</span> <span class="entity">thy</span> <span class="main">=</span>
<span class="keyword2"><span class="keyword">let</span></span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">ctxt</span> <span class="main">=</span> <span class="entity">thy</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">ctxt</span> <span class="main">=</span> <span class="entity">setupStrictWorld</span> <span class="entity">ctxt</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> Syntax.check_term <span class="entity">ctxt</span> <span class="main">(</span><span class="entity">AOT_read_term</span> <span class="antiquoted"><span class="antiquote">@{</span><span class="operator">nonterminal</span> œÜ'<span class="antiquote">}</span></span> <span class="entity">ctxt</span> <span class="entity">restriction</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">free</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">case</span></span> <span class="main">(</span>Term.add_frees <span class="entity">trm</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span> <span class="keyword2"><span class="keyword">of</span></span> <span class="main">[</span><span class="entity">f</span><span class="main">]</span> <span class="main">=&gt;</span> <span class="entity">f</span> <span class="main">|</span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="keyword3"><span class="keyword">raise</span></span> Term.TERM <span class="main">(</span><span class="inner_quoted">"Expected single free variable."</span><span class="main">,</span> <span class="main">[</span><span class="entity">trm</span><span class="main">]</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> Term.absfree <span class="entity">free</span> <span class="entity">trm</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">localeTerm</span> <span class="main">=</span> <span class="entity">HOLogic.mk_Trueprop</span> <span class="main">(</span>Const <span class="main">(</span><span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span>‚ÄπAOT_rigid_restriction_condition‚Ä∫</span><span class="main">,</span> dummyT<span class="main">)</span> $ <span class="entity">trm</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">localeTerm</span> <span class="main">=</span> Syntax.check_prop <span class="entity">ctxt</span> <span class="entity">localeTerm</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">int_bnd</span> <span class="main">=</span> Binding.concealed <span class="main">(</span>Binding.qualify true <span class="inner_quoted">"internal"</span> <span class="main">(</span>Binding.name <span class="entity">name</span><span class="main">)</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">bnds</span> <span class="main">=</span> <span class="main">{</span>Rep_name <span class="main">=</span> Binding.qualify true <span class="entity">name</span> <span class="main">(</span>Binding.name <span class="inner_quoted">"Rep"</span><span class="main">)</span><span class="main">,</span>
            Abs_name <span class="main">=</span> Binding.qualify true <span class="inner_quoted">"Abs"</span> <span class="entity">int_bnd</span><span class="main">,</span>
            type_definition_name <span class="main">=</span> Binding.qualify true <span class="inner_quoted">"type_definition"</span> <span class="entity">int_bnd</span><span class="main">}</span>

<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">after_qed</span> <span class="entity">witts</span> <span class="entity">thy</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">let</span></span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thms</span> <span class="main">=</span> <span class="main">(</span>map <span class="main">(</span><span class="entity">Element.conclude_witness</span> <span class="entity">ctxt</span><span class="main">)</span> <span class="main">(</span>flat <span class="entity">witts</span><span class="main">)</span><span class="main">)</span>
  
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">typeset</span> <span class="main">=</span> <span class="entity">HOLogic.mk_Collect</span> <span class="main">(</span><span class="inner_quoted">"Œ±"</span><span class="main">,</span> dummyT<span class="main">,</span> <span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span>‚ÄπAOT_model_valid_in‚Ä∫</span> $ <span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span>‚Äπw<span class="hidden">‚á©</span><sub>0</sub>‚Ä∫</span> $ <span class="main">(</span><span class="entity">trm</span> $ <span class="main">(</span>Const <span class="main">(</span><span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span>‚ÄπAOT_term_of_var‚Ä∫</span><span class="main">,</span> dummyT<span class="main">)</span> $ Bound <span class="inner_numeral">0</span><span class="main">)</span><span class="main">)</span><span class="main">)</span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">typeset</span> <span class="main">=</span> Syntax.check_term <span class="entity">thy</span> <span class="entity">typeset</span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">nonempty_thm</span> <span class="main">=</span> Drule.OF <span class="main">(</span><span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> AOT_rigid_restriction_condition.type_set_nonempty<span class="antiquote">}</span></span></span><span class="main">,</span> <span class="entity">thms</span><span class="main">)</span>

  <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="main">(</span><span class="main">_</span><span class="main">,</span><span class="entity">st</span><span class="main">)</span><span class="main">,</span><span class="entity">thy</span><span class="main">)</span> <span class="main">=</span> <span class="entity">Typedef.add_typedef</span> <span class="main">{</span>overloaded<span class="main">=</span>true<span class="main">}</span> <span class="main">(</span>Binding.name <span class="entity">name</span><span class="main">,</span> <span class="main">[</span><span class="main">]</span><span class="main">,</span> Mixfix.NoSyn<span class="main">)</span> <span class="entity">typeset</span> <span class="main">(</span>SOME <span class="entity">bnds</span><span class="main">)</span>
    <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">ctxt</span> <span class="main">=&gt;</span> <span class="main">(</span>Tactic.resolve_tac <span class="entity">ctxt</span> <span class="main">(</span><span class="main">[</span><span class="entity">nonempty_thm</span><span class="main">]</span><span class="main">)</span> <span class="inner_numeral">1</span><span class="main">)</span><span class="main">)</span> <span class="entity">thy</span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="main">(</span><span class="main">{</span>rep_type <span class="main">=</span> <span class="entity">rep_type</span><span class="main">,</span> abs_type <span class="main">=</span> <span class="entity">abs_type</span><span class="main">,</span> Rep_name <span class="main">=</span> <span class="entity">Rep_name</span><span class="main">,</span> Abs_name <span class="main">=</span> <span class="entity">Abs_name</span><span class="main">,</span> axiom_name <span class="main">=</span> <span class="entity">axiom_name</span><span class="main">}</span><span class="main">,</span>
     <span class="main">{</span>inhabited <span class="main">=</span> <span class="entity">inhabited</span><span class="main">,</span> type_definition <span class="main">=</span> <span class="entity">type_definition</span><span class="main">,</span> Rep <span class="main">=</span> <span class="entity">Rep</span><span class="main">,</span> Rep_inverse <span class="main">=</span> <span class="entity">Rep_inverse</span><span class="main">,</span> Abs_inverse <span class="main">=</span> <span class="entity">Abs_inverse</span><span class="main">,</span>
      Rep_inject <span class="main">=</span> <span class="entity">Rep_inject</span><span class="main">,</span> Abs_inject <span class="main">=</span> <span class="entity">Abs_inject</span><span class="main">,</span> Rep_cases <span class="main">=</span> <span class="entity">Rep_cases</span><span class="main">,</span> Abs_cases <span class="main">=</span> <span class="entity">Abs_cases</span><span class="main">,</span>
      Rep_induct <span class="main">=</span> <span class="entity">Rep_induct</span><span class="main">,</span> Abs_induct <span class="main">=</span> <span class="entity">Abs_induct</span><span class="main">}</span><span class="main">)</span> <span class="main">=</span> <span class="entity">st</span>

  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">locale_thm</span> <span class="main">=</span> Drule.OF <span class="main">(</span><span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> AOT_restricted_type_intro<span class="antiquote">}</span></span></span><span class="main">,</span> <span class="entity">type_definition</span>::<span class="entity">thms</span><span class="main">)</span>

  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">st</span> <span class="main">=</span> <span class="entity">Interpretation.global_interpretation</span> <span class="main">(</span><span class="main">(</span><span class="main">[</span><span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">locale</span> AOT_restricted_type<span class="antiquote">}</span></span><span class="main">,</span> <span class="main">(</span><span class="main">(</span><span class="entity">name</span><span class="main">,</span> true<span class="main">)</span><span class="main">,</span>
             <span class="main">(</span><span class="entity">Expression.Named</span> <span class="main">[</span><span class="main">(</span><span class="inner_quoted">"œà"</span><span class="main">,</span> <span class="entity">trm</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="inner_quoted">"Rep"</span><span class="main">,</span> Const <span class="main">(</span><span class="entity">Rep_name</span><span class="main">,</span> dummyT<span class="main">)</span><span class="main">)</span><span class="main">,</span> <span class="main">(</span><span class="inner_quoted">"Abs"</span><span class="main">,</span> Const <span class="main">(</span><span class="entity">Abs_name</span><span class="main">,</span> dummyT<span class="main">)</span><span class="main">)</span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">]</span><span class="main">,</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> <span class="main">[</span><span class="main">]</span> <span class="entity">thy</span>

  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">st</span> <span class="main">=</span> <span class="entity">Proof.refine_insert</span> <span class="main">[</span><span class="entity">locale_thm</span><span class="main">]</span> <span class="entity">st</span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thy</span> <span class="main">=</span> <span class="entity">Proof.global_immediate_proof</span> <span class="entity">st</span>

  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thy</span> <span class="main">=</span> Local_Theory.background_theory <span class="main">(</span>AOT_Constraints.map <span class="main">(</span>Symtab.update <span class="main">(</span><span class="entity">name</span><span class="main">,</span> <span class="main">(</span><span class="entity">term_of</span> <span class="main">(</span>snd <span class="entity">free</span><span class="main">)</span><span class="main">,</span> <span class="entity">term_of</span> <span class="main">(</span>snd <span class="entity">free</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="entity">thy</span>
  <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thy</span> <span class="main">=</span> Local_Theory.background_theory <span class="main">(</span>AOT_Restriction.map <span class="main">(</span>Symtab.update <span class="main">(</span><span class="entity">name</span><span class="main">,</span> <span class="main">(</span><span class="entity">trm</span><span class="main">,</span> Const <span class="main">(</span><span class="entity">Rep_name</span><span class="main">,</span> dummyT<span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span><span class="main">)</span> <span class="entity">thy</span>
  
  <span class="keyword2"><span class="keyword">in</span></span> <span class="entity">thy</span> <span class="keyword2"><span class="keyword">end</span></span>
<span class="keyword2"><span class="keyword">in</span></span>
<span class="entity">Element.witness_proof</span> <span class="entity">after_qed</span> <span class="main">[</span><span class="main">[</span><span class="entity">localeTerm</span><span class="main">]</span><span class="main">]</span> <span class="entity">thy</span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="keyword1"><span class="keyword">val</span></span> <span class="main">_</span> <span class="main">=</span>
  <span class="entity">Outer_Syntax.command</span> <span class="antiquoted"><span class="entity"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">command_keyword</span><span class="hidden">&gt;</span></span>‚Äπ<span class="keyword1">AOT_register_rigid_restricted_type</span>‚Ä∫</span></span> <span class="inner_quoted">"Register a restricted type."</span>
    <span class="main">(</span><span class="main">(</span><span class="main">(</span>Parse.short_ident --| Parse.$$$ <span class="inner_quoted">":"</span><span class="main">)</span> -- Parse.term<span class="main">)</span> &gt;&gt; <span class="main">(</span><span class="entity">Toplevel.local_theory_to_proof</span> NONE NONE o <span class="entity">register_rigid_restricted_type</span><span class="main">)</span><span class="main">)</span><span class="main">;</span> 
‚Ä∫</span>

<span class="comment1">(* Generalized mechanism for "AOT_restricted_type.‚àÄI" followed by ‚àÄE *)</span>
<span class="keyword1"><span class="command">ML</span></span><span class="quoted">‚Äπ
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">get_instantiated_allI</span> <span class="entity">ctxt</span> <span class="entity">varname</span> <span class="entity">thm</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">let</span></span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> Thm.concl_of <span class="entity">thm</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> <span class="keyword2"><span class="keyword">case</span></span> <span class="entity">trm</span> <span class="keyword2"><span class="keyword">of</span></span> <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const</span> Trueprop<span class="antiquote">}</span></span> $ <span class="main">(</span><span class="antiquoted"><span class="antiquote">@{</span><span class="operator">const</span> AOT_model_valid_in<span class="antiquote">}</span></span> $ <span class="main">_</span> $ <span class="entity">x</span><span class="main">)</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="entity">x</span>
                      <span class="main">|</span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="keyword3"><span class="keyword">raise</span></span> Term.TERM <span class="main">(</span><span class="inner_quoted">"Expected simple theorem."</span><span class="main">,</span> <span class="main">[</span><span class="entity">trm</span><span class="main">]</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">fun</span></span> <span class="entity">extractVars</span> <span class="main">(</span>Const <span class="main">(</span><span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span>‚ÄπAOT_term_of_var‚Ä∫</span><span class="main">,</span> <span class="entity">t</span><span class="main">)</span> $ <span class="main">(</span>Const <span class="entity">rep</span> $ Var <span class="entity">v</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span>
    <span class="main">(</span><span class="keyword2"><span class="keyword">if</span></span> fst <span class="main">(</span>fst <span class="entity">v</span><span class="main">)</span> <span class="main">=</span> fst <span class="entity">varname</span> <span class="keyword2"><span class="keyword">then</span></span> <span class="main">[</span>Const <span class="main">(</span><span class="antiquoted"><span class="operator"><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span>‚ÄπAOT_term_of_var‚Ä∫</span><span class="main">,</span> <span class="entity">t</span><span class="main">)</span> $ <span class="main">(</span>Const <span class="entity">rep</span> $ Var <span class="entity">v</span><span class="main">)</span><span class="main">]</span> <span class="keyword2"><span class="keyword">else</span></span> <span class="main">[</span><span class="main">]</span><span class="main">)</span> <span class="comment1">(* TODO: care about the index? *)</span>
  <span class="main">|</span> <span class="entity">extractVars</span> <span class="main">(</span><span class="entity">t1</span> $ <span class="entity">t2</span><span class="main">)</span> <span class="main">=</span> <span class="entity">extractVars</span> <span class="entity">t1</span> @ <span class="entity">extractVars</span> <span class="entity">t2</span>
  <span class="main">|</span> <span class="entity">extractVars</span> <span class="main">(</span>Abs <span class="main">(</span><span class="main">_</span><span class="main">,</span> <span class="main">_</span><span class="main">,</span> <span class="entity">t</span><span class="main">)</span><span class="main">)</span> <span class="main">=</span> <span class="entity">extractVars</span> <span class="entity">t</span>
  <span class="main">|</span> <span class="entity">extractVars</span> <span class="main">_</span> <span class="main">=</span> <span class="main">[</span><span class="main">]</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">vars</span> <span class="main">=</span> <span class="entity">extractVars</span> <span class="entity">trm</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">vartrm</span> <span class="main">=</span> hd <span class="entity">vars</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">vars</span> <span class="main">=</span> fold Term.add_vars <span class="entity">vars</span> <span class="main">[</span><span class="main">]</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">var</span> <span class="main">=</span> hd <span class="entity">vars</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trmty</span> <span class="main">=</span> <span class="main">(</span><span class="keyword2"><span class="keyword">case</span></span> <span class="entity">vartrm</span> <span class="keyword2"><span class="keyword">of</span></span> <span class="main">(</span>Const <span class="main">(</span><span class="main">_</span><span class="main">,</span> Type <span class="main">(</span><span class="inner_quoted">"fun"</span><span class="main">,</span> <span class="main">[</span><span class="main">_</span><span class="main">,</span> <span class="entity">ty</span><span class="main">]</span><span class="main">)</span><span class="main">)</span> $ <span class="main">_</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="entity">ty</span> <span class="main">|</span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="keyword3"><span class="keyword">raise</span></span> Match<span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">varty</span> <span class="main">=</span> snd <span class="entity">var</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">tyname</span> <span class="main">=</span> fst <span class="main">(</span>Term.dest_Type <span class="entity">varty</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">b</span> <span class="main">=</span> <span class="entity">tyname</span>^<span class="inner_quoted">".‚àÄI"</span> <span class="comment1">(* TODO: better way to find the theorem *)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thms</span> <span class="main">=</span> fst <span class="main">(</span>Context.map_proof_result <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">ctxt</span> <span class="main">=&gt;</span> <span class="main">(</span><span class="entity">Attrib.eval_thms</span> <span class="entity">ctxt</span> <span class="main">[</span><span class="main">(</span>Facts.Named <span class="main">(</span><span class="main">(</span><span class="entity">b</span><span class="main">,</span>Position.none<span class="main">)</span><span class="main">,</span>NONE<span class="main">)</span><span class="main">,</span><span class="main">[</span><span class="main">]</span><span class="main">)</span><span class="main">]</span><span class="main">,</span> <span class="entity">ctxt</span><span class="main">)</span><span class="main">)</span> <span class="entity">ctxt</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">allthm</span> <span class="main">=</span> <span class="main">(</span><span class="keyword2"><span class="keyword">case</span></span> <span class="entity">thms</span> <span class="keyword2"><span class="keyword">of</span></span> <span class="main">(</span><span class="entity">thm</span>::<span class="main">_</span><span class="main">)</span> <span class="main">=&gt;</span> <span class="entity">thm</span> <span class="main">|</span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="keyword3"><span class="keyword">raise</span></span> Fail <span class="inner_quoted">"Unknown restricted type."</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> Abs <span class="main">(</span>Term.string_of_vname <span class="main">(</span>fst <span class="entity">var</span><span class="main">)</span><span class="main">,</span> <span class="entity">trmty</span><span class="main">,</span> Term.abstract_over <span class="main">(</span><span class="entity">vartrm</span><span class="main">,</span> <span class="entity">trm</span><span class="main">)</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">trm</span> <span class="main">=</span> Thm.cterm_of <span class="main">(</span>Context.proof_of <span class="entity">ctxt</span><span class="main">)</span> <span class="entity">trm</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">phi</span> <span class="main">=</span> hd <span class="main">(</span>Term.add_vars <span class="main">(</span>Thm.prop_of <span class="entity">allthm</span><span class="main">)</span> <span class="main">[</span><span class="main">]</span><span class="main">)</span>
<span class="keyword1"><span class="keyword">val</span></span> <span class="entity">allthm</span> <span class="main">=</span> Drule.instantiate_normalize <span class="main">(</span><span class="main">[</span><span class="main">]</span><span class="main">,</span><span class="main">[</span><span class="main">(</span><span class="entity">phi</span><span class="main">,</span><span class="entity">trm</span><span class="main">)</span><span class="main">]</span><span class="main">)</span> <span class="entity">allthm</span>
<span class="keyword2"><span class="keyword">in</span></span>
<span class="entity">allthm</span>
<span class="keyword2"><span class="keyword">end</span></span>
‚Ä∫</span>

<span class="comment1">(* TODO: unconstraining multiple variables does not work yet *)</span>
<span class="keyword1"><span class="command">attribute_setup</span></span> <span class="quoted">"unconstrain"</span> <span class="main">=</span>
  <span class="quoted">‚ÄπScan.lift <span class="main">(</span>Scan.repeat1 Args.var<span class="main">)</span> &gt;&gt; <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">args</span> <span class="main">=&gt;</span> Thm.rule_attribute <span class="main">[</span><span class="main">]</span>
  <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">ctxt</span> <span class="main">=&gt;</span> <span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">thm</span> <span class="main">=&gt;</span>
    <span class="keyword2"><span class="keyword">let</span></span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thm</span> <span class="main">=</span> fold <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">arg</span> <span class="main">=&gt;</span> <span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">thm</span> <span class="main">=&gt;</span> <span class="entity">thm</span> RS <span class="entity">get_instantiated_allI</span> <span class="entity">ctxt</span> <span class="entity">arg</span> <span class="entity">thm</span><span class="main">)</span> <span class="entity">args</span> <span class="entity">thm</span>
    <span class="keyword1"><span class="keyword">val</span></span> <span class="entity">thm</span> <span class="main">=</span> fold <span class="main">(</span><span class="keyword1"><span class="keyword">fn</span></span> <span class="main">_</span> <span class="main">=&gt;</span> <span class="keyword1"><span class="keyword">fn</span></span> <span class="entity">thm</span> <span class="main">=&gt;</span> <span class="entity">thm</span> RS <span class="antiquoted"><span class="entity"><span class="antiquote">@{</span><span class="operator">thm</span> "‚àÄE"<span class="main">(</span>2<span class="main">)</span><span class="antiquote">}</span></span></span><span class="main">)</span> <span class="entity">args</span> <span class="entity">thm</span>
    <span class="keyword2"><span class="keyword">in</span></span>
     <span class="entity">thm</span>
    <span class="keyword2"><span class="keyword">end</span></span><span class="main">)</span><span class="main">)</span>‚Ä∫</span>
  <span class="quoted">"Generalize a statement about restricted variables to a statement about unrestricted variables with explicit restriction condition."</span>



<span class="keyword1"><span class="command">context</span></span> AOT_restricted_type
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"rule-ui"</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="free">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">if</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">[</span><span class="operator">THEN</span> <span class="quoted">"‚àÄE"</span><span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span><span class="main">,</span> <span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">]</span> that <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="free">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">auto</span> <span class="quasi_keyword">simp</span><span class="main"><span class="main">:</span></span>  œà<span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">show</span></span> <span class="var"><span class="quoted"><span class="var">?thesis</span></span></span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">lemmas</span></span> <span class="quoted">"‚àÄE"</span> <span class="main">=</span> <span class="quoted">"rule-ui"</span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"instantiation"</span><span class="main">:</span>
  <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1">for</span> <span class="keyword1">arbitrary</span> <span class="bound">Œ≤</span><span class="main">:</span> <span class="free">œÜ</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="bound">Œ≤</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span> <span class="main"><span class="hidden">‚ùô</span><b>‚ä¢</b></span> <span class="free">œá</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œá</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="operator">-</span>
  <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="skolem">Œ±</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œá</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">Œ±</span></span>
    <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>1<span class="main">)</span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">simp</span> <span class="quasi_keyword">add</span><span class="main"><span class="main">:</span></span> <span class="quoted">"deduction-theorem"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> 0<span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">(</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œá</span><span class="main">)</span><span class="main">)</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">using</span></span> GEN <span class="keyword1"><span class="command">by</span></span> <span class="operator">simp</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">AOT_obtain</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> assms<span class="main">(</span>2<span class="main">)</span> <span class="quoted">"‚àÉE"</span><span class="main">[</span><span class="operator">rotated</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">AOT_show</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œá</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"AOT_PLM.‚àÄE"</span><span class="main">(</span>2<span class="main">)</span><span class="main">[</span><span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">,</span> <span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">]</span> <span class="quoted">"&amp;E"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword1"><span class="command">lemmas</span></span> <span class="quoted">"‚àÉE"</span> <span class="main">=</span> <span class="quoted">"instantiation"</span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> existential<span class="main">:</span> <span class="keyword2"><span class="keyword">assumes</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="main">¬´</span>AOT_term_of_var <span class="main">(</span><span class="free">Rep</span> <span class="free">Œ≤</span><span class="main">)</span><span class="main">¬ª</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword2"><span class="keyword">shows</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span> <span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">meson</span> AOT_restricted_type.œà AOT_restricted_type_axioms assms <span class="quoted">"&amp;I"</span> <span class="quoted">"existential:2[const_var]"</span><span class="main">)</span>
<span class="keyword1"><span class="command">lemmas</span></span> <span class="quoted">"‚àÉI"</span> <span class="main">=</span> existential
<span class="keyword2"><span class="keyword">end</span></span>


<span class="keyword1"><span class="command">context</span></span> AOT_rigid_restriction_condition
<span class="keyword2"><span class="keyword">begin</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[1]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚àÄ</span><span class="bound">Œ≤</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">,</span> <span class="bound">Œ≤</span><span class="main">}</span><span class="main">)</span> <span class="main">‚â°</span> <span class="main">‚àÄ</span><span class="bound">Œ≤</span><span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">,</span> <span class="bound">Œ≤</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> <span class="quoted">"‚â°I"</span> <span class="quoted">"‚ÜíI"</span> GEN<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Œ≤</span> <span class="skolem">Œ±</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚àÄ</span><span class="bound">Œ≤</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">,</span> <span class="bound">Œ≤</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚àÄ</span><span class="bound">Œ≤</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">,</span> <span class="bound">Œ≤</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÄE"</span><span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ≤</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">,</span> <span class="bound">Œ≤</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚ÜíE"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">,</span> <span class="skolem">Œ≤</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÄE"</span><span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">next</span></span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Œ±</span> <span class="skolem">Œ≤</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ≤</span><span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">,</span> <span class="bound">Œ≤</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">,</span> <span class="skolem">Œ≤</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÄE"</span><span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">,</span> <span class="skolem">Œ≤</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÄE"</span><span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword3"><span class="command">AOT_show</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">,</span> <span class="skolem">Œ≤</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚ÜíE"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="comment1">(* TODO: PLM: easier proof with lemmas above *)</span>
<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[BF]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> <span class="quoted">"‚ÜíI"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÄE"</span><span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"sc-eq-box-box:6"</span> rigid_condition <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">‚ñ°</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> GEN<span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"BF"</span> <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[CBF]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span> <span class="main">‚Üí</span> <span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> <span class="quoted">"‚ÜíI"</span> GEN<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Œ±</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">‚ñ°</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"CBF"</span> <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÄE"</span><span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"B‚óá"</span> <span class="quoted">"T‚óá"</span> rigid_condition <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="quoted">"qml:1"</span><span class="main">[</span><span class="operator">axiom_inst</span><span class="main">,</span> <span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">,</span> <span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[2]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span> <span class="main">‚Üí</span> <span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> <span class="quoted">"‚ÜíI"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÄE"</span><span class="main">(</span>2<span class="main">)</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">for</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"sc-eq-box-box:7"</span> rigid_condition <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> GEN<span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">‚àÄ</span><span class="bound">Œ±</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"‚â°E"</span><span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> <span class="quoted">"logic-actual-nec:3"</span> <span class="quoted">"vdash-properties:1[2]"</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>


<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[3]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span> <span class="main">‚Üí</span> <span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">safe</span> <span class="quasi_keyword">intro</span><span class="main"><span class="main">!</span></span><span class="main"><span class="main">:</span></span> <span class="quoted">"‚ÜíI"</span> GEN<span class="main">)</span>
  <span class="keyword3"><span class="command">fix</span></span> <span class="skolem">Œ±</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÄ</span><span class="bound">Œ±</span> <span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"‚â°E"</span><span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> <span class="quoted">"logic-actual-nec:3"</span> <span class="quoted">"vdash-properties:1[2]"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> 1<span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">‚Üí</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"rule-ui:3"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"nec-imp-act"</span> <span class="quoted">"qml:2"</span> rigid_condition <span class="quoted">"vdash-properties:1[2]"</span> <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="keyword1"><span class="hidden">‚ùô</span><b>ùíú</b></span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> 1 <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"act-cond"</span> <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[Buridan]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span> <span class="main">‚Üí</span> <span class="main">‚ñ°</span><span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span> <span class="main">(</span><span class="operator">rule</span> <span class="quoted">"‚ÜíI"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">AOT_obtain</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚ñ°</span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÉE"</span><span class="main">[</span><span class="operator">rotated</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> 
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"KBasic:11"</span> <span class="quoted">"KBasic:3"</span> <span class="quoted">"T‚óá"</span> <span class="quoted">"&amp;I"</span> <span class="quoted">"&amp;E"</span><span class="main"><span class="main">(</span></span>1<span class="main"><span class="main">)</span></span> <span class="quoted">"&amp;E"</span><span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span>
              <span class="quoted">"‚â°E"</span><span class="main"><span class="main">(</span></span>2<span class="main"><span class="main">)</span></span> <span class="quoted">"reductio-aa:1"</span> rigid_condition <span class="quoted">"vdash-properties:6"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">‚ñ°</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> <span class="quoted">"‚àÉI"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> Buridan<span class="main"><span class="main">[</span></span><span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main"><span class="main">]</span></span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[BF‚óá]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span> <span class="main">‚Üí</span> <span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> <span class="quoted">"‚ÜíI"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">‚óá</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"BF‚óá"</span><span class="main">[</span><span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">AOT_obtain</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÉE"</span><span class="main">[</span><span class="operator">rotated</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"KBasic2:3"</span> <span class="quoted">"&amp;E"</span> <span class="quoted">"vdash-properties:10"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">moreover</span></span> <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> calculation rigid_condition <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"B‚óá"</span> <span class="quoted">"K‚óá"</span> <span class="quoted">"vdash-properties:10"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">ultimately</span></span> <span class="keyword1"><span class="command">AOT_have</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"&amp;I"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> <span class="quoted">"‚àÉI"</span><span class="main">)</span>
<span class="keyword1"><span class="command">qed</span></span>

<span class="keyword1"><span class="command">AOT_theorem</span></span> <span class="quoted">"res-var-bound-reas[CBF‚óá]"</span><span class="main">:</span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span> <span class="main">‚Üí</span> <span class="main">‚óá</span><span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
<span class="keyword1"><span class="command">proof</span></span><span class="main">(</span><span class="operator">rule</span> <span class="quoted">"‚ÜíI"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_assume</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
  <span class="keyword1"><span class="command">then</span></span> <span class="keyword3"><span class="command">AOT_obtain</span></span> <span class="skolem"><span class="skolem">Œ±</span></span> <span class="keyword2"><span class="keyword">where</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"‚àÉE"</span><span class="main">[</span><span class="operator">rotated</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚ñ°</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span> <span class="keyword2"><span class="keyword">and</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">using</span></span> rigid_condition<span class="main">[</span><span class="operator">THEN</span> <span class="quoted">"qml:2"</span><span class="main"><span class="main">[</span></span><span class="operator">axiom_inst</span><span class="main"><span class="main">,</span></span> <span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main"><span class="main">]</span></span><span class="main">,</span> <span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">]</span> <span class="quoted">"&amp;E"</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">blast</span><span class="main"><span class="keyword3">+</span></span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="skolem">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">metis</span> <span class="quoted">"KBasic:16"</span> <span class="quoted">"con-dis-taut:5"</span> <span class="quoted">"‚ÜíE"</span><span class="main">)</span>
  <span class="keyword1"><span class="command">AOT_hence</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">‚óá</span><span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span>
    <span class="keyword1"><span class="command">by</span></span> <span class="main">(</span><span class="operator">rule</span> <span class="quoted">"‚àÉI"</span><span class="main">)</span>
  <span class="keyword3"><span class="command">AOT_thus</span></span> <span class="quoted"><span class="quoted">‚Äπ<span class="main">‚óá</span><span class="main">‚àÉ</span><span class="bound">Œ±</span> <span class="main">(</span><span class="free">œà</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span> <span class="main">&amp;</span> <span class="free">œÜ</span><span class="main">{</span><span class="bound">Œ±</span><span class="main">}</span><span class="main">)</span>‚Ä∫</span></span> <span class="keyword1"><span class="command">using</span></span> <span class="quoted">"CBF‚óá"</span><span class="main">[</span><span class="operator">THEN</span> <span class="quoted">"‚ÜíE"</span><span class="main">]</span> <span class="keyword1"><span class="command">by</span></span> <span class="operator">fast</span>
<span class="keyword1"><span class="command">qed</span></span>
<span class="keyword2"><span class="keyword">end</span></span>

<span class="comment1">(*&lt;*)</span>
<span class="keyword2"><span class="keyword">end</span></span>
<span class="comment1">(*&gt;*)</span></pre>
</body>

</html>